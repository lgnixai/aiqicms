(self.webpackChunkAnQiCMS=self.webpackChunkAnQiCMS||[]).push([[8431],{85606:function(D,A,e){"use strict";var U=e(48305),f=e.n(U),s=e(75304),E=e(22683),_=e(96570),v=e(75271),C=e(52676),h=function(o){var c=(0,v.useState)(void 0),d=f()(c,2),m=d[0],B=d[1],O=(0,v.useState)(""),I=f()(O,2),x=I[0],g=I[1],Z=function(){(0,s.roP)({type:"multi"}).then(function(M){var r=(M.data||[]).map(function(p){return{key:p.id,tab:p.name,is_main:p.is_main}});B(r);var n=(0,E.KJ)("sub-site-id");!n&&r.length>0&&(n=r[0].key+"");var P=r.find(function(p){return p.key===Number(n)}),b=!1;P&&(b=!0,P.is_main&&(b=!1)),(0,E.Xq)("is-sub-site",b),g(n)})};(0,v.useEffect)(function(){Z()},[]);var F=function(M){var r;g(M),(0,E.Xq)("sub-site-id",M);var n=m.find(function(b){return b.key===Number(M)}),P=!0;n.is_main&&(P=!1),(0,E.Xq)("is-sub-site",P),(r=o.onTabChange)===null||r===void 0||r.call(o,M,P)};return(0,C.jsx)(_._z,{tabList:m,tabActiveKey:x,onTabChange:F,title:o.title,children:o.children})};A.Z=h},45855:function(D,A,e){"use strict";e.r(A);var U=e(90228),f=e.n(U),s=e(335),E=e.n(s),_=e(87999),v=e.n(_),C=e(48305),h=e.n(C),y=e(85606),o=e(25783),c=e(16621),d=e(18640),m=e(32064),B=e(54203),O=e(34206),I=e(53745),x=e(91827),g=e(47634),Z=e(18874),F=e(48782),N=e(16483),M=e.n(N),r=e(75271),n=e(52676),P=function(){var p=(0,r.useRef)(),V=(0,r.useState)([]),H=h()(V,2),le=H[0],Y=H[1],k=(0,r.useState)(!1),X=h()(k,2),q=X[0],S=X[1],ee=(0,r.useState)(""),G=h()(ee,2),ne=G[0],te=G[1],u=(0,m.useIntl)(),ae=function(a){te(a)},Q=function(){var i=v()(f()().mark(function a(l){return f()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:B.Z.confirm({title:u.formatMessage({id:"plugin.fileupload.delete.confirm"}),onOk:function(){var T=v()(f()().mark(function re(){var $,W,z,L,w,J;return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if($=O.ZP.loading(u.formatMessage({id:"content.delete.deletting"}),0),l){t.next=3;break}return t.abrupt("return",!0);case 3:t.prev=3,L=E()(l),t.prev=5,L.s();case 7:if((w=L.n()).done){t.next=13;break}return J=w.value,t.next=11,(0,o.B3)({hash:J});case 11:t.next=7;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(5),L.e(t.t0);case 18:return t.prev=18,L.f(),t.finish(18);case 21:$(),O.ZP.success(u.formatMessage({id:"content.delete.success"})),Y([]),(W=p.current)===null||W===void 0||(z=W.reloadAndRest)===null||z===void 0||z.call(W),t.next=31;break;case 27:t.prev=27,t.t1=t.catch(3),$(),O.ZP.error(u.formatMessage({id:"content.delete.failure"}));case 31:case"end":return t.stop()}},re,null,[[3,27],[5,15,18,21]])}));function j(){return T.apply(this,arguments)}return j}()});case 1:case"end":return R.stop()}},a)}));return function(l){return i.apply(this,arguments)}}(),se=function(a){var l=new FormData;l.append("file",a.file);var K=O.ZP.loading(u.formatMessage({id:"setting.system.submitting"}),0);(0,o.LR)(l).then(function(R){var T,j;O.ZP.success(R.msg),S(!1),(T=p.current)===null||T===void 0||(j=T.reloadAndRest)===null||j===void 0||j.call(T)}).finally(function(){K()})},_e=[{title:u.formatMessage({id:"design.detail.file-name"}),dataIndex:"file_name"},{title:u.formatMessage({id:"plugin.fileupload.create-time"}),width:200,dataIndex:"created_time",render:function(a,l){return M()(l.created_time*1e3).format("YYYY-MM-DD HH:mm")}},{title:u.formatMessage({id:"setting.action"}),dataIndex:"option",valueType:"option",width:180,render:function(a,l){return(0,n.jsxs)(I.Z,{size:20,children:[(0,n.jsx)("a",{target:"_blank",href:l.link,children:(0,n.jsx)(m.FormattedMessage,{id:"plugin.fileupload.view"})},"edit"),(0,n.jsx)("a",{className:"text-red",onClick:function(){Q([l.hash])},children:(0,n.jsx)(m.FormattedMessage,{id:"setting.system.delete"})},"delete")]})}}];return(0,n.jsx)(y.Z,{onTabChange:function(a){return ae(a)},children:(0,n.jsxs)(x.Z,{children:[(0,n.jsx)(d.Z,{headerTitle:u.formatMessage({id:"menu.plugin.fileupload"}),actionRef:p,rowKey:"hash",search:!1,toolBarRender:function(){return[(0,n.jsxs)(g.ZP,{onClick:function(){S(!0)},children:[(0,n.jsx)(c.Z,{})," ",(0,n.jsx)(m.FormattedMessage,{id:"plugin.fileupload.upload.name"})]},"upload")]},tableAlertOptionRender:function(a){var l=a.selectedRowKeys,K=a.onCleanSelected;return(0,n.jsxs)(I.Z,{children:[(0,n.jsx)(g.ZP,{size:"small",onClick:function(){Q(l)},children:(0,n.jsx)(m.FormattedMessage,{id:"content.option.batch-delete"})}),(0,n.jsx)(g.ZP,{type:"link",size:"small",onClick:K,children:(0,n.jsx)(m.FormattedMessage,{id:"content.option.cancel-select"})})]})},request:function(a){return(0,o.xz)(a)},columnsState:{persistenceKey:"fileupload-table",persistenceType:"localStorage"},columns:_e,rowSelection:{onChange:function(a){Y(a)}},pagination:!1}),(0,n.jsxs)(B.Z,{title:u.formatMessage({id:"plugin.fileupload.upload.name"}),open:q,width:800,okText:!1,onCancel:function(){S(!1)},onOk:function(){S(!1)},children:[(0,n.jsx)(Z.Z,{message:u.formatMessage({id:"plugin.fileupload.upload.support"})}),(0,n.jsx)("div",{className:"mt-normal",children:(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)(F.Z,{name:"file",className:"logo-uploader",showUploadList:!1,accept:".txt,.htm,.html,.xml",customRequest:se,children:(0,n.jsx)(g.ZP,{type:"primary",children:(0,n.jsx)(m.FormattedMessage,{id:"plugin.fileupload.upload.btn"})})})})})]})]},ne)})};A.default=P},335:function(D,A,e){var U=e(31479);function f(s,E){var _=typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(!_){if(Array.isArray(s)||(_=U(s))||E&&s&&typeof s.length=="number"){_&&(s=_);var v=0,C=function(){};return{s:C,n:function(){return v>=s.length?{done:!0}:{done:!1,value:s[v++]}},e:function(d){throw d},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,y=!1,o;return{s:function(){_=_.call(s)},n:function(){var d=_.next();return h=d.done,d},e:function(d){y=!0,o=d},f:function(){try{!h&&_.return!=null&&_.return()}finally{if(y)throw o}}}}D.exports=f,D.exports.__esModule=!0,D.exports.default=D.exports}}]);
