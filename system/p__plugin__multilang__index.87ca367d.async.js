"use strict";(self.webpackChunkAnQiCMS=self.webpackChunkAnQiCMS||[]).push([[2201],{20860:function(ge,V,n){n.d(V,{Z:function(){return y}});var W=n(13233),I=n(75271),G={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},Y=G,w=n(35244),d=function(o,Q){return I.createElement(w.Z,(0,W.Z)({},o,{ref:Q,icon:Y}))},b=I.forwardRef(d),y=b},17361:function(ge,V,n){var W=n(48305),I=n.n(W),G=n(54203),Y=n(75271),w=n(99944),d=n(76979),b=n(52676),y=function(o){var Q=(0,Y.useState)(!1),ee=I()(Q,2),f=ee[0],C=ee[1],se=(0,Y.useState)([]),ne=I()(se,2),re=ne[0],ue=ne[1],O=function(R){if(o.manual){var c;(c=o.onCancel)===null||c===void 0||c.call(o,R)}else C(R)},X=function(R){o.multiple?ue(R):(o.onSelect(R),O(!1))},J=function(){o.multiple&&o.onSelect(re),O(!1)};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{style:{display:"inline-block"},onClick:function(){O(!f)},children:o.children}),(0,b.jsx)(G.Z,{className:"material-modal",width:800,open:o.manual?o.open:f,onCancel:function(){O(!1)},onOk:function(){J()},children:(0,b.jsx)(w.Z,{multiple:o.multiple,onSelect:function(R){X(R)}})})]})};V.Z=y},72541:function(ge,V,n){n.r(V),n.d(V,{default:function(){return Je}});var W=n(26068),I=n.n(W),G=n(15558),Y=n.n(G),w=n(90228),d=n.n(w),b=n(87999),y=n.n(b),ie=n(48305),o=n.n(ie),Q=n(17361),ee=n(40916),f=n(75304),C=n(6217),se=n(86743),ne=n(16621),re=n(96570),ue=n(74133),O=n(76334),X=n(41265),J=n(18640),E=n(35937),R=n(96640),c=n(32064),D=n(34206),T=n(54203),me=n(53745),ze=n(21261),Ne=n(91827),Ke=n(9921),$=n(47634),Ve=n(43330),Ye=n(38221),Be=n(67852),He=n(16483),oe=n.n(He),g=n(75271),e=n(52676),Ue=function(L){var M=(0,g.useRef)(),h=(0,c.useIntl)(),B=function(m){T.Z.confirm({title:h.formatMessage({id:"plugin.multilang.html-cache.delete-confirm"}),onOk:function(){(0,f.z2h)({uris:m}).then(function(){var v,A;(v=M.current)===null||v===void 0||(A=v.reload)===null||A===void 0||A.call(v)})}})},F=function(){T.Z.confirm({title:h.formatMessage({id:"plugin.multilang.html-cache.crean-all-confirm"}),onOk:function(){(0,f.z2h)({all:!0}).then(function(){var x,v;(x=M.current)===null||x===void 0||(v=x.reload)===null||v===void 0||v.call(x)})}})},Z=[{title:h.formatMessage({id:"plugin.multilang.html-cache.create-time"}),dataIndex:"last_mod",render:function(m){return oe()(m*1e3).format("YYYY-MM-DD HH:mm")}},{title:h.formatMessage({id:"plugin.multilang.html-cache.uri"}),dataIndex:"uri"},{title:h.formatMessage({id:"plugin.multilang.html-cache.language"}),dataIndex:"lang",render:function(m,x){var v;return((v=C.vI.find(function(A){return A.value===x.lang}))===null||v===void 0?void 0:v.label)||m}},{title:h.formatMessage({id:"setting.action"}),dataIndex:"option",valueType:"option",render:function(m,x){return(0,e.jsx)(me.Z,{size:20,children:(0,e.jsx)("span",{className:x.status===0?"text-red link":"link",onClick:y()(d()().mark(function v(){return d()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:B([x.uri]);case 1:case"end":return H.stop()}},v)})),children:(0,e.jsx)(c.FormattedMessage,{id:"plugin.multilang.html-cache.delete"})},"push")})}}];return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(T.Z,{width:1e3,title:h.formatMessage({id:"plugin.multilang.translate-cache"}),open:L.open,onCancel:L.onCancel,footer:null,children:(0,e.jsx)(J.Z,{actionRef:M,rowKey:"id",search:!1,ghost:!0,toolBarRender:function(){return[(0,e.jsx)($.ZP,{type:"primary",onClick:function(){F()},children:(0,e.jsx)(c.FormattedMessage,{id:"plugin.multilang.translate-cache.clear-all"})},"page")]},request:function(m){return(0,f.iyX)(m)},columnsState:{persistenceKey:"translate-html-cache-table",persistenceType:"localStorage"},columns:Z,pagination:{showSizeChanger:!0}})})})},ke=Ue,We=n(20860),Ge=n(12964),we=function(L){var M=(0,g.useRef)(),h=(0,c.useIntl)(),B=[{title:h.formatMessage({id:"plugin.multilang.html-log.create-time"}),dataIndex:"created_time",render:function(Z){return oe()(Z*1e3).format("YYYY-MM-DD HH:mm")}},{title:h.formatMessage({id:"plugin.multilang.html-log.uri"}),dataIndex:"uri"},{title:h.formatMessage({id:"plugin.multilang.html-log.to-language"}),dataIndex:"to_language",render:function(Z,p){var m;return((m=C.vI.find(function(x){return x.value===p.to_language}))===null||m===void 0?void 0:m.label)||Z}},{title:h.formatMessage({id:"plugin.multilang.html-log.status"}),dataIndex:"status",render:function(Z,p){return p.status===1?(0,e.jsx)("span",{children:(0,e.jsx)(c.FormattedMessage,{id:"plugin.multilang.html-log.status.success"})}):(0,e.jsxs)(Ge.Z,{title:p.remark,children:[(0,e.jsx)("span",{className:"text-red",children:(0,e.jsx)(c.FormattedMessage,{id:"plugin.multilang.html-log.status.failure"})}),p.remark&&(0,e.jsx)(We.Z,{className:"error-icon"})]})}}];return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(T.Z,{width:1e3,title:h.formatMessage({id:"plugin.multilang.translate-log"}),open:L.open,onCancel:L.onCancel,footer:null,children:(0,e.jsx)(J.Z,{actionRef:M,rowKey:"id",search:!1,ghost:!0,toolBarRender:!1,request:function(Z){return(0,f.PtK)(Z)},columnsState:{persistenceKey:"translate-html-log-table",persistenceType:"localStorage"},columns:B,pagination:{showSizeChanger:!0}})})})},Qe=we,te=!1,ae=null,Xe=function(){var L=g.createRef(),M=(0,g.useRef)(),h=(0,g.useState)({}),B=o()(h,2),F=B[0],Z=B[1],p=(0,g.useState)(!1),m=o()(p,2),x=m[0],v=m[1],A=(0,g.useState)({}),H=o()(A,2),S=H[0],_=H[1],_e=(0,g.useState)(!1),ve=o()(_e,2),he=ve[0],U=ve[1],qe=(0,g.useState)(!1),pe=o()(qe,2),xe=pe[0],Se=pe[1],en=(0,g.useState)(!1),je=o()(en,2),ye=je[0],Me=je[1],nn=(0,g.useState)(!1),Ce=o()(nn,2),Re=Ce[0],ce=Ce[1],tn=(0,g.useState)({}),Ze=o()(tn,2),an=Ze[0],ln=Ze[1],sn=(0,g.useState)([]),Ie=o()(sn,2),z=Ie[0],be=Ie[1],rn=(0,g.useState)("multi"),Oe=o()(rn,2),q=Oe[0],Pe=Oe[1],un=(0,g.useState)(null),Ee=o()(un,2),Fe=Ee[0],on=Ee[1],cn=(0,g.useState)(!1),Ae=o()(cn,2),dn=Ae[0],le=Ae[1],gn=(0,g.useState)(null),De=o()(gn,2),k=De[0],Te=De[1],s=(0,c.useIntl)(),de=function(){var l=y()(d()().mark(function t(){return d()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:(0,f.z1F)().then(function(r){if(r.data)te=!0,Te(r.data);else{if(te){var u;te=!1,(u=M.current)===null||u===void 0||u.reload()}clearInterval(ae),Te(null)}});case 1:case"end":return i.stop()}},t)}));return function(){return l.apply(this,arguments)}}(),$e=function(){var l=y()(d()().mark(function t(){var a,i;return d()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,f.Vez)();case 2:a=u.sent,i=a.data||{},i.site_type=i.site_type||"multi",Pe(i.site_type),Z(i),v(!0);case 8:case"end":return u.stop()}},t)}));return function(){return l.apply(this,arguments)}}();(0,g.useEffect)(function(){return $e(),be(C.vI.map(function(l){return{label:l.label,value:l.value}})),de(),ae=setInterval(function(){de()},1e3),function(){te=!1,clearInterval(ae)}},[]);var mn=function(){var l=y()(d()().mark(function t(a){var i,r;return d()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:i=D.ZP.loading(s.formatMessage({id:"setting.system.submitting"}),0),r=a,(0,f.$As)(r).then(function(N){var P,K;D.ZP.success(N.msg),$e(),(P=M.current)===null||P===void 0||(K=P.reloadAndRest)===null||K===void 0||K.call(P)}).catch(function(N){console.log(N)}).finally(function(){i()});case 3:case"end":return j.stop()}},t)}));return function(a){return l.apply(this,arguments)}}(),fn=function(t){T.Z.confirm({title:s.formatMessage({id:"plugin.multilang.remove.confirm"}),onOk:function(){(0,f.Y4v)(t).then(function(i){var r,u;D.ZP.success(i.msg),(r=M.current)===null||r===void 0||(u=r.reloadAndRest)===null||u===void 0||u.call(r)}).catch(function(i){console.log(i)})}})},vn=function(){var l=y()(d()().mark(function t(a){var i,r;return d()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:i=D.ZP.loading(s.formatMessage({id:"setting.system.submitting"}),0),r=Object.assign(S,a),(0,f.SUR)(r).then(function(N){var P,K;D.ZP.success(N.msg),U(!1),(P=M.current)===null||P===void 0||(K=P.reloadAndRest)===null||K===void 0||K.call(P)}).catch(function(N){console.log(N)}).finally(function(){i()});case 3:case"end":return j.stop()}},t)}));return function(a){return l.apply(this,arguments)}}(),hn=function(t){on(t),le(!0)},Le=function(t){Fe.focus=t,(0,f.Lh6)(Fe).then(function(a){var i,r;D.ZP.success(a.msg),(i=M.current)===null||i===void 0||(r=i.reloadAndRest)===null||r===void 0||r.call(i),ae=setInterval(function(){de()},1e3)}).catch(function(a){console.log(a)}).finally(function(){le(!1)})},pn=function(t){z.length>C.vI.length&&z.splice(z.length-1,1),z.find(function(a){return a.value.indexOf(t)!==-1||a.label.indexOf(t)!==-1})||(z.push({label:t,value:t}),be(Y()(z)))},xn=function(t){S.language=t,_(I()({},S))},Sn=function(t){(0,f.Ejx)({site_id:t.id}).then(function(a){a.code!==0?D.ZP.error(a.msg):window.open(a.data)})},jn=function(){S.language_icon="",_(I()({},S))},yn=function(t){S.language_icon=t.logo,_(I()({},S))},Mn=function(t){t===0&&(U(!1),ce(!0))},Cn=function(){var l=y()(d()().mark(function t(){return d()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:ce(!1),U(!0);case 2:case"end":return i.stop()}},t)}));return function(){return l.apply(this,arguments)}}(),Rn=[{title:"ID",dataIndex:"id"},{title:s.formatMessage({id:"plugin.multilang.name"}),dataIndex:"name"},{title:s.formatMessage({id:"plugin.multilang.domain"}),dataIndex:"base_url"},{title:s.formatMessage({id:"plugin.multilang.language"}),dataIndex:"language",render:function(t){var a;return(0,e.jsx)("div",{children:((a=C.vI.find(function(i){return i.value===t}))===null||a===void 0?void 0:a.label)||t})}},{title:s.formatMessage({id:"plugin.multilang.icon"}),dataIndex:"language_icon",render:function(t,a){return(0,e.jsx)("div",{style:{fontSize:24},children:a.language_icon?(0,e.jsx)("img",{src:a.language_icon,style:{width:30,height:30}}):(0,C._F)(a.language)})}},{title:s.formatMessage({id:"plugin.multilang.sync-time"}),dataIndex:"sync_time",hidden:q==="single",render:function(t,a){return(0,e.jsx)("div",{children:(0,e.jsx)("div",{children:a.sync_time>0?oe()(a.sync_time*1e3).format("YYYY-MM-DD HH:mm"):"-"})})}},{title:s.formatMessage({id:"setting.action"}),dataIndex:"option",render:function(t,a){return(0,e.jsxs)(me.Z,{size:20,children:[(0,e.jsx)("a",{onClick:function(){_(a),U(!0)},children:(0,e.jsx)(c.FormattedMessage,{id:"setting.action.edit"})}),a.is_main?(0,e.jsx)(ze.Z,{children:(0,e.jsx)(c.FormattedMessage,{id:"plugin.multilang.is-main"})}):(0,e.jsxs)(e.Fragment,{children:[q==="multi"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("a",{onClick:function(){hn(a)},children:(0,e.jsx)(c.FormattedMessage,{id:"setting.multilang.sync"})}),(0,e.jsx)("a",{onClick:function(){Sn(a)},children:(0,e.jsx)(c.FormattedMessage,{id:"setting.multilang.login"})})]}),(0,e.jsx)("a",{className:"text-red",onClick:function(){fn(a)},children:(0,e.jsx)(c.FormattedMessage,{id:"setting.system.delete"})})]})]})}}];return(0,e.jsxs)(re._z,{children:[(0,e.jsx)(Ne.Z,{bordered:!1,children:x&&(0,e.jsxs)("div",{className:"mt-normal",children:[(0,e.jsxs)(ue.A,{onFinish:mn,initialValues:F,formRef:L,children:[(0,e.jsx)(O.Z.Group,{name:"open",label:s.formatMessage({id:"plugin.multilang.open.name"}),options:[{label:s.formatMessage({id:"plugin.multilang.open.false"}),value:!1},{label:s.formatMessage({id:"plugin.multilang.open.true"}),value:!0}],extra:s.formatMessage({id:"plugin.multilang.open.description"})}),(0,e.jsx)(O.Z.Group,{name:"site_type",label:s.formatMessage({id:"plugin.multilang.site-type"}),options:[{value:"multi",label:s.formatMessage({id:"plugin.multilang.site-type.domain"})},{value:"single",label:s.formatMessage({id:"plugin.multilang.site-type.direction"})}],fieldProps:{onChange:function(t){Pe(t.target.value)}},extra:s.formatMessage({id:"plugin.multilang.site-type.description"})}),(0,e.jsx)(O.Z.Group,{name:"type",label:s.formatMessage({id:"plugin.multilang.type"}),options:[{value:"domain",label:s.formatMessage({id:"plugin.multilang.type.domain"})},{value:"directory",label:s.formatMessage({id:"plugin.multilang.type.direction"})},{value:"same",label:s.formatMessage({id:"plugin.multilang.type.same-url"})}],extra:s.formatMessage({id:"plugin.multilang.type.description"})}),(0,e.jsx)(X.Z,{name:"default_language",label:s.formatMessage({id:"plugin.multilang.default_language"}),style:{width:"100%"},options:C.vI.map(function(l){return{label:l.label,value:l.value}})}),(0,e.jsx)(O.Z.Group,{name:"auto_translate",label:s.formatMessage({id:"plugin.multilang.auto_translate"}),options:[{value:!1,label:s.formatMessage({id:"plugin.multilang.auto_translate.false"})},{value:!0,label:s.formatMessage({id:"plugin.multilang.auto_translate.true"})}],extra:s.formatMessage({id:"plugin.multilang.auto_translate.description"})})]}),(0,e.jsx)(Ke.Z,{children:(0,e.jsx)(c.FormattedMessage,{id:"plugin.multilang.sites"})}),(0,e.jsx)(J.Z,{rowKey:"language",search:!1,actionRef:M,toolBarRender:function(){return[q==="single"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)($.ZP,{type:"primary",onClick:function(){Se(!0)},children:(0,e.jsx)(c.FormattedMessage,{id:"plugin.multilang.translate-log"})},"log"),(0,e.jsx)($.ZP,{type:"primary",onClick:function(){Me(!0)},children:(0,e.jsx)(c.FormattedMessage,{id:"plugin.multilang.translate-cache"})},"cache")]}),F.open&&(0,e.jsx)($.ZP,{type:"primary",onClick:function(){_({}),U(!0)},children:(0,e.jsx)(c.FormattedMessage,{id:"plugin.multilang.add"})},"add")]},tableAlertRender:!1,tableAlertOptionRender:!1,request:function(){var l=y()(d()().mark(function t(a){var i,r;return d()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,(0,f.roP)(a);case 2:return r=j.sent,ln(((i=r.data)===null||i===void 0?void 0:i[0])||{}),j.abrupt("return",r);case 5:case"end":return j.stop()}},t)}));return function(t){return l.apply(this,arguments)}}(),columns:Rn,pagination:!1})]})}),he&&(0,e.jsxs)(E.Y,{width:550,title:s.formatMessage({id:"plugin.multilang.edit"}),open:he,initialValues:S,layout:"horizontal",onOpenChange:function(t){U(t)},onFinish:vn,children:[q==="multi"&&(0,e.jsx)(X.Z,{label:s.formatMessage({id:"plugin.multilang.select"}),disabled:S.is_main,showSearch:!0,name:"id",request:y()(d()().mark(function l(){var t,a;return d()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,f.ioU)({});case 2:return t=r.sent,a=t.data.map(function(u){return console.log(u.parent_id,u.status,u.parent_id>0,u.status!==!0,u.parent_id>0||u.status!==!0),{label:u.name+"(ID:"+u.id+")",value:u.id,disabled:u.parent_id>0||u.status!==!0}}),a.push({label:s.formatMessage({id:"plugin.multilang.add"}),value:0}),r.abrupt("return",a);case 6:case"end":return r.stop()}},l)})),fieldProps:{onSelect:Mn},extra:s.formatMessage({id:"plugin.multilang.select.description"})}),q==="single"&&(0,e.jsx)(R.Z,{name:"base_url",label:s.formatMessage({id:"plugin.multilang.base_url.name"}),extra:s.formatMessage({id:"plugin.multilang.base_url.description"})}),(0,e.jsx)(X.Z,{name:"language",label:s.formatMessage({id:"plugin.multilang.language"}),disabled:S.is_main,style:{width:"100%"},showSearch:!0,fieldProps:{onSearch:pn,onChange:xn},options:z}),(0,e.jsxs)(R.Z,{label:s.formatMessage({id:"plugin.multilang.icon"}),children:[S.language_icon?(0,e.jsxs)("div",{className:"ant-upload-item",children:[(0,e.jsx)(Ve.Z,{preview:{src:S.language_icon},src:S.language_icon}),(0,e.jsx)("span",{className:"delete",onClick:jn,children:(0,e.jsx)(se.Z,{})})]}):(0,e.jsx)("div",{className:"ant-upload-item",children:(0,e.jsx)(Ye.Z,{size:100,style:{fontSize:48},children:(0,C._F)(S.language)})}),(0,e.jsx)(Q.Z,{onSelect:yn,open:!1,multiple:!1,children:(0,e.jsx)("div",{className:"ant-upload-item",children:(0,e.jsxs)("div",{className:"add",children:[(0,e.jsx)(ne.Z,{}),(0,e.jsx)("div",{style:{marginTop:8},children:(0,e.jsx)(c.FormattedMessage,{id:"setting.system.upload"})})]})})})]})]}),Re&&(0,e.jsx)(ee.Z,{onCancel:function(){return ce(!1)},onSubmit:Cn,open:Re,website:{status:1,mysql:{use_default:!0},initialed:!1},rootPath:an.root_path}),k!==null&&(0,e.jsxs)(T.Z,{title:s.formatMessage({id:"plugin.multilang.syncing"}),open:!0,footer:null,children:[(0,e.jsx)("div",{className:"task-progress",children:(0,e.jsxs)(Be.Z,{percent:k.finished?100:k.percent,children:[k.finish_count,"/",k.total_count]})}),(0,e.jsx)("div",{className:"task-message",children:k.message})]}),xe&&(0,e.jsx)(Qe,{open:xe,onCancel:function(){return Se(!1)}}),ye&&(0,e.jsx)(ke,{open:ye,onCancel:function(){return Me(!1)}}),(0,e.jsx)(T.Z,{open:dn,title:s.formatMessage({id:"plugin.multilang.sync.confirm"}),onCancel:function(){return le(!1)},footer:[(0,e.jsx)($.ZP,{onClick:function(){return le(!1)},children:(0,e.jsx)(c.FormattedMessage,{id:"plugin.multilang.sync.cancel"})},"cancel"),(0,e.jsx)($.ZP,{onClick:function(){return Le(!0)},children:(0,e.jsx)(c.FormattedMessage,{id:"plugin.multilang.sync.all"})},"full"),(0,e.jsx)($.ZP,{type:"primary",onClick:function(){return Le(!1)},children:(0,e.jsx)(c.FormattedMessage,{id:"plugin.multilang.sync.addon"})},"incremental")],children:(0,e.jsx)(c.FormattedMessage,{id:"plugin.multilang.sync.content"})})]})},Je=Xe}}]);
