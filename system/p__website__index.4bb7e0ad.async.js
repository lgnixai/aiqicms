"use strict";(self.webpackChunkAnQiCMS=self.webpackChunkAnQiCMS||[]).push([[4225],{97960:function(oe,O,n){n.r(O);var A=n(90228),l=n.n(A),K=n(87999),f=n.n(K),L=n(48305),E=n.n(L),v=n(75304),B=n(16621),W=n(96570),w=n(18640),o=n(32064),h=n(34206),Z=n(54203),$=n(37697),F=n(53745),I=n(21261),Y=n(47634),z=n(16483),N=n.n(z),c=n(75271),G=n(40916),t=n(52676),p=!1,H=function(){var Q=(0,o.useModel)("@@initialState"),m=Q.initialState,P=(0,c.useRef)(),V=(0,c.useState)(!1),S=E()(V,2),b=S[0],M=S[1],X=(0,c.useState)({}),C=E()(X,2),k=C[0],R=C[1],J=(0,c.useState)({}),j=E()(J,2),q=j[0],ee=j[1],te=(0,c.useState)({}),x=E()(te,2),ne=x[0],ae=x[1],U=(0,c.useRef)(),i=(0,o.useIntl)(),se=function(){var d=f()(l()().mark(function e(){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:(0,v.aYX)({}).then(function(s){ee((s==null?void 0:s.data)||{})});case 1:case"end":return r.stop()}},e)}));return function(){return d.apply(this,arguments)}}();(0,c.useEffect)(function(){se()},[]);var T=function(e){e.id>0?(0,v.UNy)({id:e.id}).then(function(a){R(a.data),M(!0)}):(R(e),M(!0))},ie=function(e){(0,v.Ejx)({site_id:e.id}).then(function(a){a.code!==0?h.ZP.error(a.msg):window.open(a.data)})},re=function(e){if(e.id===1){h.ZP.error(i.formatMessage({id:"website.cannot-delete"}));return}p||Z.Z.confirm({title:i.formatMessage({id:"setting.system.confirm-delete"}),content:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-normal",children:i.formatMessage({id:"website.delete.tips"})}),(0,t.jsx)("div",{style:{padding:"10px 0"},children:(0,t.jsx)("div",{children:(0,t.jsx)($.Z,{ref:U,value:!0,children:i.formatMessage({id:"website.delete.all"})})})})]}),onOk:function(){var a=f()(l()().mark(function s(){var u,_,y;return l()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:p=!0,_=h.ZP.loading(i.formatMessage({id:"website.delete.deleting"}),0),y=((u=U.current)===null||u===void 0||(u=u.input)===null||u===void 0?void 0:u.checked)||!1,(0,v.LfK)({id:e.id,remove_file:y}).then(function(le){var D;h.ZP.info(le.msg),(D=P.current)===null||D===void 0||D.reload()}).finally(function(){p=!1,_()});case 4:case"end":return g.stop()}},s)}));function r(){return a.apply(this,arguments)}return r}()})},_e=function(){var d=f()(l()().mark(function e(){var a;return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:M(!1),(a=P.current)===null||a===void 0||a.reload();case 2:case"end":return s.stop()}},e)}));return function(){return d.apply(this,arguments)}}(),de=[{title:"ID",hideInSearch:!0,dataIndex:"id"},{title:i.formatMessage({id:"setting.system.site-name"}),dataIndex:"name"},{title:i.formatMessage({id:"setting.system.base-url"}),dataIndex:"base_url",render:function(e){return(0,t.jsx)("a",{href:e,target:"_blank",rel:"noreferrer",children:e})}},{title:i.formatMessage({id:"website.root-path"}),hideInSearch:!0,dataIndex:"root_path"},{title:i.formatMessage({id:"website.create-time"}),hideInSearch:!0,dataIndex:"created_time",render:function(e,a){return N()(a.created_time*1e3).format("YYYY-MM-DD HH:mm")}},{title:i.formatMessage({id:"website.status"}),hideInSearch:!0,dataIndex:"status",valueEnum:{0:{text:i.formatMessage({id:"setting.content.notenable"}),status:"Default"},1:{text:i.formatMessage({id:"setting.content.enable"}),status:"Success"}}},{title:i.formatMessage({id:"setting.action"}),dataIndex:"option",valueType:"option",render:function(e,a){var r;return(0,t.jsxs)(F.Z,{size:20,children:[a.id===q.id?(0,t.jsx)(I.Z,{children:(0,t.jsx)(o.FormattedMessage,{id:"website.current"})}):(0,t.jsx)("a",{onClick:function(){ie(a)},children:(0,t.jsx)(o.FormattedMessage,{id:"website.visit-backend"})},"edit"),(m==null||(r=m.currentUser)===null||r===void 0?void 0:r.site_id)===1&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("a",{onClick:function(){T(a)},children:(0,t.jsx)(o.FormattedMessage,{id:"setting.action.edit"})},"edit"),a.id===1?(0,t.jsx)(I.Z,{children:(0,t.jsx)(o.FormattedMessage,{id:"website.default"})}):(0,t.jsx)("a",{className:"text-red",onClick:f()(l()().mark(function s(){return l()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,re(a);case 2:case"end":return _.stop()}},s)})),children:(0,t.jsx)(o.FormattedMessage,{id:"setting.system.delete"})},"delete")]})]})}}];return(0,t.jsxs)(W._z,{children:[(0,t.jsx)(w.Z,{headerTitle:i.formatMessage({id:"website.list"}),rowKey:"id",actionRef:P,request:function(){var d=f()(l()().mark(function e(a){var r,s;return l()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,v.qbg)(a);case 2:return s=_.sent,ae(((r=s.data)===null||r===void 0?void 0:r[0])||{}),_.abrupt("return",s);case 5:case"end":return _.stop()}},e)}));return function(e){return d.apply(this,arguments)}}(),columnsState:{persistenceKey:"website-table",persistenceType:"localStorage"},columns:de,toolBarRender:function(){var e;return[(m==null||(e=m.currentUser)===null||e===void 0?void 0:e.site_id)===1&&(0,t.jsxs)(Y.ZP,{type:"primary",onClick:function(){T({mysql:{use_default:!0},initialed:!1,status:1})},children:[(0,t.jsx)(B.Z,{})," ",(0,t.jsx)(o.FormattedMessage,{id:"website.add"})]},"add")]},pagination:{showSizeChanger:!0}}),b&&(0,t.jsx)(G.Z,{onCancel:function(){return M(!1)},onSubmit:_e,open:b,website:k,rootPath:ne.root_path})]})};O.default=H}}]);
