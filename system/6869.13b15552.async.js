!(function(){"use strict";var B=(ht,q,N)=>new Promise((h,M)=>{var z=Z=>{try{F(N.next(Z))}catch(Q){M(Q)}},tt=Z=>{try{F(N.throw(Z))}catch(Q){M(Q)}},F=Z=>Z.done?h(Z.value):Promise.resolve(Z.value).then(z,tt);F((N=N.apply(ht,q)).next())});(self.webpackChunkAnQiCMS=self.webpackChunkAnQiCMS||[]).push([[6869],{51371:function(ht,q,N){N.d(q,{a:function(){return I},c:function(){return yt}});var h=N(82725),M=N(17088),z=N(21826);function tt(d){const f=d.replace(/\n{2,}/g,`
`);return(0,z.Z)(f)}function F(d){const f=tt(d),{children:u}=(0,M.V)(f),g=[[]];let S=0;function L(w,W="normal"){w.type==="text"?w.value.split(`
`).forEach((E,j)=>{j!==0&&(S++,g.push([])),E.split(" ").forEach(v=>{v&&g[S].push({content:v,type:W})})}):(w.type==="strong"||w.type==="emphasis")&&w.children.forEach(D=>{L(D,w.type)})}return u.forEach(w=>{w.type==="paragraph"&&w.children.forEach(W=>{L(W)})}),g}function Z(d){const{children:f}=(0,M.V)(d);function u(g){return g.type==="text"?g.value.replace(/\n/g,"<br/>"):g.type==="strong"?`<strong>${g.children.map(u).join("")}</strong>`:g.type==="emphasis"?`<em>${g.children.map(u).join("")}</em>`:g.type==="paragraph"?`<p>${g.children.map(u).join("")}</p>`:`Unsupported markdown: ${g.type}`}return f.map(u).join("")}function Q(d){return Intl.Segmenter?[...new Intl.Segmenter().segment(d)].map(f=>f.segment):[...d]}function bt(d,f){const u=Q(f.content);return pt(d,[],u,f.type)}function pt(d,f,u,g){if(u.length===0)return[{content:f.join(""),type:g},{content:"",type:g}];const[S,...L]=u,w=[...f,S];return d([{content:w.join(""),type:g}])?pt(d,w,L,g):(f.length===0&&S&&(f.push(S),u.shift()),[{content:f.join(""),type:g},{content:u.join(""),type:g}])}function wt(d,f){if(d.some(({content:u})=>u.includes(`
`)))throw new Error("splitLineToFitWidth does not support newlines in the line");return st(d,f)}function st(d,f,u=[],g=[]){var W;if(d.length===0)return g.length>0&&u.push(g),u.length>0?u:[];let S="";d[0].content===" "&&(S=" ",d.shift());const L=(W=d.shift())!=null?W:{content:" ",type:"normal"},w=[...g];if(S!==""&&w.push({content:S,type:"normal"}),w.push(L),f(w))return st(d,f,u,w);if(g.length>0)u.push(g),d.unshift(L);else if(L.content){const[D,E]=bt(f,L);u.push([D]),E.content&&d.unshift(E)}return st(d,f,u)}function mt(d,f){f&&d.attr("style",f)}function kt(d,f,u,g,S=!1){const L=d.append("foreignObject"),w=L.append("xhtml:div"),W=f.label,D=f.isNode?"nodeLabel":"edgeLabel";w.html(`
    <span class="${D} ${g}" `+(f.labelStyle?'style="'+f.labelStyle+'"':"")+">"+W+"</span>"),mt(w,f.labelStyle),w.style("display","table-cell"),w.style("white-space","nowrap"),w.style("max-width",u+"px"),w.attr("xmlns","http://www.w3.org/1999/xhtml"),S&&w.attr("class","labelBkg");let E=w.node().getBoundingClientRect();return E.width===u&&(w.style("display","table"),w.style("white-space","break-spaces"),w.style("width",u+"px"),E=w.node().getBoundingClientRect()),L.style("width",E.width),L.style("height",E.height),L.node()}function rt(d,f,u){return d.append("tspan").attr("class","text-outer-tspan").attr("x",0).attr("y",f*u-.1+"em").attr("dy",u+"em")}function ft(d,f,u){const g=d.append("text"),S=rt(g,1,f);nt(S,u);const L=S.node().getComputedTextLength();return g.remove(),L}function yt(d,f,u){var g;const S=d.append("text"),L=rt(S,1,f);nt(L,[{content:u,type:"normal"}]);const w=(g=L.node())==null?void 0:g.getBoundingClientRect();return w&&S.remove(),w}function dt(d,f,u,g=!1){const L=f.append("g"),w=L.insert("rect").attr("class","background"),W=L.append("text").attr("y","-10.1");let D=0;for(const E of u){const j=V=>ft(L,1.1,V)<=d,v=j(E)?[E]:wt(E,j);for(const V of v){const ut=rt(W,D,1.1);nt(ut,V),D++}}if(g){const E=W.node().getBBox(),j=2;return w.attr("x",-j).attr("y",-j).attr("width",E.width+2*j).attr("height",E.height+2*j),L.node()}else return W.node()}function nt(d,f){d.text(""),f.forEach((u,g)=>{const S=d.append("tspan").attr("font-style",u.type==="emphasis"?"italic":"normal").attr("class","text-inner-tspan").attr("font-weight",u.type==="strong"?"bold":"normal");g===0?S.text(u.content):S.text(" "+u.content)})}const I=(d,f="",{style:u="",isTitle:g=!1,classes:S="",useHtmlLabels:L=!0,isNode:w=!0,width:W=200,addSvgBackground:D=!1}={})=>{if(h.l.info("createText",f,u,g,S,L,w,D),L){const E=Z(f),j={isNode:w,label:(0,h.M)(E).replace(/fa[blrs]?:fa-[\w-]+/g,V=>`<i class='${V.replace(":"," ")}'></i>`),labelStyle:u.replace("fill:","color:")};return kt(d,j,W,S,D)}else{const E=F(f);return dt(W,d,E,D)}}},36869:function(ht,q,N){N.d(q,{a:function(){return ft},b:function(){return tr},c:function(){return I},d:function(){return er},e:function(){return Jt},f:function(){return sr},g:function(){return Mt},h:function(){return cr},i:function(){return j},j:function(){return nr},k:function(){return Et},l:function(){return d},m:function(){return _t},p:function(){return rr},s:function(){return qt},u:function(){return f}});var h=N(82725),M=N(15525),z=N(51371);const tt=(e,t,a,n)=>{t.forEach(l=>{rt[l](e,a,n)})},rt={extension:(e,t,a)=>{h.l.trace("Making markers for ",a),e.append("defs").append("marker").attr("id",a+"_"+t+"-extensionStart").attr("class","marker extension "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),e.append("defs").append("marker").attr("id",a+"_"+t+"-extensionEnd").attr("class","marker extension "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},composition:(e,t,a)=>{e.append("defs").append("marker").attr("id",a+"_"+t+"-compositionStart").attr("class","marker composition "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",a+"_"+t+"-compositionEnd").attr("class","marker composition "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},aggregation:(e,t,a)=>{e.append("defs").append("marker").attr("id",a+"_"+t+"-aggregationStart").attr("class","marker aggregation "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",a+"_"+t+"-aggregationEnd").attr("class","marker aggregation "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},dependency:(e,t,a)=>{e.append("defs").append("marker").attr("id",a+"_"+t+"-dependencyStart").attr("class","marker dependency "+t).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",a+"_"+t+"-dependencyEnd").attr("class","marker dependency "+t).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},lollipop:(e,t,a)=>{e.append("defs").append("marker").attr("id",a+"_"+t+"-lollipopStart").attr("class","marker lollipop "+t).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),e.append("defs").append("marker").attr("id",a+"_"+t+"-lollipopEnd").attr("class","marker lollipop "+t).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},point:(e,t,a)=>{e.append("marker").attr("id",a+"_"+t+"-pointEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",6).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",12).attr("markerHeight",12).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",a+"_"+t+"-pointStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",12).attr("markerHeight",12).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},circle:(e,t,a)=>{e.append("marker").attr("id",a+"_"+t+"-circleEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",a+"_"+t+"-circleStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},cross:(e,t,a)=>{e.append("marker").attr("id",a+"_"+t+"-crossEnd").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),e.append("marker").attr("id",a+"_"+t+"-crossStart").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},barb:(e,t,a)=>{e.append("defs").append("marker").attr("id",a+"_"+t+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","strokeWidth").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")}},ft=tt;function yt(e,t){t&&e.attr("style",t)}function dt(e){const t=(0,M.Ys)(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),a=t.append("xhtml:div"),n=e.label,l=e.isNode?"nodeLabel":"edgeLabel";return a.html('<span class="'+l+'" '+(e.labelStyle?'style="'+e.labelStyle+'"':"")+">"+n+"</span>"),yt(a,e.labelStyle),a.style("display","inline-block"),a.style("white-space","nowrap"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()}const I=(e,t,a,n)=>{let l=e||"";if(typeof l=="object"&&(l=l[0]),(0,h.m)((0,h.c)().flowchart.htmlLabels)){l=l.replace(/\\n|\n/g,"<br />"),h.l.debug("vertexText"+l);const r={isNode:n,label:(0,h.M)(l).replace(/fa[blrs]?:fa-[\w-]+/g,i=>`<i class='${i.replace(":"," ")}'></i>`),labelStyle:t.replace("fill:","color:")};return dt(r)}else{const r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttribute("style",t.replace("color:","fill:"));let s=[];typeof l=="string"?s=l.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(l)?s=l:s=[];for(const i of s){const c=document.createElementNS("http://www.w3.org/2000/svg","tspan");c.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),c.setAttribute("dy","1em"),c.setAttribute("x","0"),a?c.setAttribute("class","title-row"):c.setAttribute("class","row"),c.textContent=i.trim(),r.appendChild(c)}return r}},d=(e,t,a,n)=>B(this,null,function*(){let l;const r=t.useHtmlLabels||(0,h.m)((0,h.c)().flowchart.htmlLabels);a?l=a:l="node default";const s=e.insert("g").attr("class",l).attr("id",t.domId||t.id),i=s.insert("g").attr("class","label").attr("style",t.labelStyle);let c;t.labelText===void 0?c="":c=typeof t.labelText=="string"?t.labelText:t.labelText[0];const p=i.node();let o;t.labelType==="markdown"?o=(0,z.a)(i,(0,h.d)((0,h.M)(c),(0,h.c)()),{useHtmlLabels:r,width:t.width||(0,h.c)().flowchart.wrappingWidth,classes:"markdown-node-label"}):o=p.appendChild(I((0,h.d)((0,h.M)(c),(0,h.c)()),t.labelStyle,!1,n));let y=o.getBBox();const b=t.padding/2;if((0,h.m)((0,h.c)().flowchart.htmlLabels)){const x=o.children[0],k=(0,M.Ys)(o),_=x.getElementsByTagName("img");if(_){const m=c.replace(/<img[^>]*>/g,"").trim()==="";yield Promise.all([..._].map(T=>new Promise(R=>{function Y(){if(T.style.display="flex",T.style.flexDirection="column",m){const H=(0,h.c)().fontSize?(0,h.c)().fontSize:window.getComputedStyle(document.body).fontSize,at=parseInt(H,10)*5+"px";T.style.minWidth=at,T.style.maxWidth=at}else T.style.width="100%";R(T)}setTimeout(()=>{T.complete&&Y()}),T.addEventListener("error",Y),T.addEventListener("load",Y)})))}y=x.getBoundingClientRect(),k.attr("width",y.width),k.attr("height",y.height)}return r?i.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"):i.attr("transform","translate(0, "+-y.height/2+")"),t.centerLabel&&i.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"),i.insert("rect",":first-child"),{shapeSvg:s,bbox:y,halfPadding:b,label:i}}),f=(e,t)=>{const a=t.node().getBBox();e.width=a.width,e.height=a.height};function u(e,t,a,n){return e.insert("polygon",":first-child").attr("points",n.map(function(l){return l.x+","+l.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+a/2+")")}function g(e,t){return e.intersect(t)}function S(e,t,a,n){var l=e.x,r=e.y,s=l-n.x,i=r-n.y,c=Math.sqrt(t*t*i*i+a*a*s*s),p=Math.abs(t*a*s/c);n.x<l&&(p=-p);var o=Math.abs(t*a*i/c);return n.y<r&&(o=-o),{x:l+p,y:r+o}}function L(e,t,a){return S(e,t,t,a)}function w(e,t,a,n){var l,r,s,i,c,p,o,y,b,x,k,_,m,T,R;if(l=t.y-e.y,s=e.x-t.x,c=t.x*e.y-e.x*t.y,b=l*a.x+s*a.y+c,x=l*n.x+s*n.y+c,!(b!==0&&x!==0&&W(b,x))&&(r=n.y-a.y,i=a.x-n.x,p=n.x*a.y-a.x*n.y,o=r*e.x+i*e.y+p,y=r*t.x+i*t.y+p,!(o!==0&&y!==0&&W(o,y))&&(k=l*i-r*s,k!==0)))return _=Math.abs(k/2),m=s*p-i*c,T=m<0?(m-_)/k:(m+_)/k,m=r*c-l*p,R=m<0?(m-_)/k:(m+_)/k,{x:T,y:R}}function W(e,t){return e*t>0}function D(e,t,a){var n=e.x,l=e.y,r=[],s=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(k){s=Math.min(s,k.x),i=Math.min(i,k.y)}):(s=Math.min(s,t.x),i=Math.min(i,t.y));for(var c=n-e.width/2-s,p=l-e.height/2-i,o=0;o<t.length;o++){var y=t[o],b=t[o<t.length-1?o+1:0],x=w(e,a,{x:c+y.x,y:p+y.y},{x:c+b.x,y:p+b.y});x&&r.push(x)}return r.length?(r.length>1&&r.sort(function(k,_){var m=k.x-a.x,T=k.y-a.y,R=Math.sqrt(m*m+T*T),Y=_.x-a.x,H=_.y-a.y,J=Math.sqrt(Y*Y+H*H);return R<J?-1:R===J?0:1}),r[0]):e}const j=(e,t)=>{var a=e.x,n=e.y,l=t.x-a,r=t.y-n,s=e.width/2,i=e.height/2,c,p;return Math.abs(r)*s>Math.abs(l)*i?(r<0&&(i=-i),c=r===0?0:i*l/r,p=i):(l<0&&(s=-s),c=s,p=l===0?0:s*r/l),{x:a+c,y:n+p}},v={node:g,circle:L,ellipse:S,polygon:D,rect:j},ut=(e,t)=>B(this,null,function*(){t.useHtmlLabels||(0,h.c)().flowchart.htmlLabels||(t.centerLabel=!0);const{shapeSvg:n,bbox:l,halfPadding:r}=yield d(e,t,"node "+t.classes,!0);h.l.info("Classes = ",t.classes);const s=n.insert("rect",":first-child");return s.attr("rx",t.rx).attr("ry",t.ry).attr("x",-l.width/2-r).attr("y",-l.height/2-r).attr("width",l.width+t.padding).attr("height",l.height+t.padding),f(t,s),t.intersect=function(i){return v.rect(t,i)},n}),$t=e=>{const t=new Set;for(const a of e)switch(a){case"x":t.add("right"),t.add("left");break;case"y":t.add("up"),t.add("down");break;default:t.add(a);break}return t},Wt=(e,t,a)=>{const n=$t(e),l=2,r=t.height+2*a.padding,s=r/l,i=t.width+2*s+a.padding,c=a.padding/2;return n.has("right")&&n.has("left")&&n.has("up")&&n.has("down")?[{x:0,y:0},{x:s,y:0},{x:i/2,y:2*c},{x:i-s,y:0},{x:i,y:0},{x:i,y:-r/3},{x:i+2*c,y:-r/2},{x:i,y:-2*r/3},{x:i,y:-r},{x:i-s,y:-r},{x:i/2,y:-r-2*c},{x:s,y:-r},{x:0,y:-r},{x:0,y:-2*r/3},{x:-2*c,y:-r/2},{x:0,y:-r/3}]:n.has("right")&&n.has("left")&&n.has("up")?[{x:s,y:0},{x:i-s,y:0},{x:i,y:-r/2},{x:i-s,y:-r},{x:s,y:-r},{x:0,y:-r/2}]:n.has("right")&&n.has("left")&&n.has("down")?[{x:0,y:0},{x:s,y:-r},{x:i-s,y:-r},{x:i,y:0}]:n.has("right")&&n.has("up")&&n.has("down")?[{x:0,y:0},{x:i,y:-s},{x:i,y:-r+s},{x:0,y:-r}]:n.has("left")&&n.has("up")&&n.has("down")?[{x:i,y:0},{x:0,y:-s},{x:0,y:-r+s},{x:i,y:-r}]:n.has("right")&&n.has("left")?[{x:s,y:0},{x:s,y:-c},{x:i-s,y:-c},{x:i-s,y:0},{x:i,y:-r/2},{x:i-s,y:-r},{x:i-s,y:-r+c},{x:s,y:-r+c},{x:s,y:-r},{x:0,y:-r/2}]:n.has("up")&&n.has("down")?[{x:i/2,y:0},{x:0,y:-c},{x:s,y:-c},{x:s,y:-r+c},{x:0,y:-r+c},{x:i/2,y:-r},{x:i,y:-r+c},{x:i-s,y:-r+c},{x:i-s,y:-c},{x:i,y:-c}]:n.has("right")&&n.has("up")?[{x:0,y:0},{x:i,y:-s},{x:0,y:-r}]:n.has("right")&&n.has("down")?[{x:0,y:0},{x:i,y:0},{x:0,y:-r}]:n.has("left")&&n.has("up")?[{x:i,y:0},{x:0,y:-s},{x:i,y:-r}]:n.has("left")&&n.has("down")?[{x:i,y:0},{x:0,y:0},{x:i,y:-r}]:n.has("right")?[{x:s,y:-c},{x:s,y:-c},{x:i-s,y:-c},{x:i-s,y:0},{x:i,y:-r/2},{x:i-s,y:-r},{x:i-s,y:-r+c},{x:s,y:-r+c},{x:s,y:-r+c}]:n.has("left")?[{x:s,y:0},{x:s,y:-c},{x:i-s,y:-c},{x:i-s,y:-r+c},{x:s,y:-r+c},{x:s,y:-r},{x:0,y:-r/2}]:n.has("up")?[{x:s,y:-c},{x:s,y:-r+c},{x:0,y:-r+c},{x:i/2,y:-r},{x:i,y:-r+c},{x:i-s,y:-r+c},{x:i-s,y:-c}]:n.has("down")?[{x:i/2,y:0},{x:0,y:-c},{x:s,y:-c},{x:s,y:-r+c},{x:i-s,y:-r+c},{x:i-s,y:-c},{x:i,y:-c}]:[{x:0,y:0}]},vt=e=>e?" "+e:"",A=(e,t)=>`${t||"node default"}${vt(e.classes)} ${vt(e.class)}`,Lt=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n}=yield d(e,t,A(t,void 0),!0),l=n.width+t.padding,r=n.height+t.padding,s=l+r,i=[{x:s/2,y:0},{x:s,y:-s/2},{x:s/2,y:-s},{x:0,y:-s/2}];h.l.info("Question main (Circle)");const c=u(a,s,s,i);return c.attr("style",t.style),f(t,c),t.intersect=function(p){return h.l.warn("Intersect called"),v.polygon(t,i,p)},a}),Rt=(e,t)=>{const a=e.insert("g").attr("class","node default").attr("id",t.domId||t.id),n=28,l=[{x:0,y:n/2},{x:n/2,y:0},{x:0,y:-n/2},{x:-n/2,y:0}];return a.insert("polygon",":first-child").attr("points",l.map(function(s){return s.x+","+s.y}).join(" ")).attr("class","state-start").attr("r",7).attr("width",28).attr("height",28),t.width=28,t.height=28,t.intersect=function(s){return v.circle(t,14,s)},a},Ot=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n}=yield d(e,t,A(t,void 0),!0),l=4,r=n.height+t.padding,s=r/l,i=n.width+2*s+t.padding,c=[{x:s,y:0},{x:i-s,y:0},{x:i,y:-r/2},{x:i-s,y:-r},{x:s,y:-r},{x:0,y:-r/2}],p=u(a,i,r,c);return p.attr("style",t.style),f(t,p),t.intersect=function(o){return v.polygon(t,c,o)},a}),Yt=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n}=yield d(e,t,void 0,!0),l=2,r=n.height+2*t.padding,s=r/l,i=n.width+2*s+t.padding,c=Wt(t.directions,n,t),p=u(a,i,r,c);return p.attr("style",t.style),f(t,p),t.intersect=function(o){return v.polygon(t,c,o)},a}),It=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n}=yield d(e,t,A(t,void 0),!0),l=n.width+t.padding,r=n.height+t.padding,s=[{x:-r/2,y:0},{x:l,y:0},{x:l,y:-r},{x:-r/2,y:-r},{x:0,y:-r/2}];return u(a,l,r,s).attr("style",t.style),t.width=l+r,t.height=r,t.intersect=function(c){return v.polygon(t,s,c)},a}),Dt=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n}=yield d(e,t,A(t),!0),l=n.width+t.padding,r=n.height+t.padding,s=[{x:-2*r/6,y:0},{x:l-r/6,y:0},{x:l+2*r/6,y:-r},{x:r/6,y:-r}],i=u(a,l,r,s);return i.attr("style",t.style),f(t,i),t.intersect=function(c){return v.polygon(t,s,c)},a}),jt=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n}=yield d(e,t,A(t,void 0),!0),l=n.width+t.padding,r=n.height+t.padding,s=[{x:2*r/6,y:0},{x:l+r/6,y:0},{x:l-2*r/6,y:-r},{x:-r/6,y:-r}],i=u(a,l,r,s);return i.attr("style",t.style),f(t,i),t.intersect=function(c){return v.polygon(t,s,c)},a}),Ht=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n}=yield d(e,t,A(t,void 0),!0),l=n.width+t.padding,r=n.height+t.padding,s=[{x:-2*r/6,y:0},{x:l+2*r/6,y:0},{x:l-r/6,y:-r},{x:r/6,y:-r}],i=u(a,l,r,s);return i.attr("style",t.style),f(t,i),t.intersect=function(c){return v.polygon(t,s,c)},a}),Nt=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n}=yield d(e,t,A(t,void 0),!0),l=n.width+t.padding,r=n.height+t.padding,s=[{x:r/6,y:0},{x:l-r/6,y:0},{x:l+2*r/6,y:-r},{x:-2*r/6,y:-r}],i=u(a,l,r,s);return i.attr("style",t.style),f(t,i),t.intersect=function(c){return v.polygon(t,s,c)},a}),At=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n}=yield d(e,t,A(t,void 0),!0),l=n.width+t.padding,r=n.height+t.padding,s=[{x:0,y:0},{x:l+r/2,y:0},{x:l,y:-r/2},{x:l+r/2,y:-r},{x:0,y:-r}],i=u(a,l,r,s);return i.attr("style",t.style),f(t,i),t.intersect=function(c){return v.polygon(t,s,c)},a}),Ut=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n}=yield d(e,t,A(t,void 0),!0),l=n.width+t.padding,r=l/2,s=r/(2.5+l/50),i=n.height+s+t.padding,c="M 0,"+s+" a "+r+","+s+" 0,0,0 "+l+" 0 a "+r+","+s+" 0,0,0 "+-l+" 0 l 0,"+i+" a "+r+","+s+" 0,0,0 "+l+" 0 l 0,"+-i,p=a.attr("label-offset-y",s).insert("path",":first-child").attr("style",t.style).attr("d",c).attr("transform","translate("+-l/2+","+-(i/2+s)+")");return f(t,p),t.intersect=function(o){const y=v.rect(t,o),b=y.x-t.x;if(r!=0&&(Math.abs(b)<t.width/2||Math.abs(b)==t.width/2&&Math.abs(y.y-t.y)>t.height/2-s)){let x=s*s*(1-b*b/(r*r));x!=0&&(x=Math.sqrt(x)),x=s-x,o.y-t.y>0&&(x=-x),y.y+=x}return y},a}),Xt=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n,halfPadding:l}=yield d(e,t,"node "+t.classes+" "+t.class,!0),r=a.insert("rect",":first-child"),s=t.positioned?t.width:n.width+t.padding,i=t.positioned?t.height:n.height+t.padding,c=t.positioned?-s/2:-n.width/2-l,p=t.positioned?-i/2:-n.height/2-l;if(r.attr("class","basic label-container").attr("style",t.style).attr("rx",t.rx).attr("ry",t.ry).attr("x",c).attr("y",p).attr("width",s).attr("height",i),t.props){const o=new Set(Object.keys(t.props));t.props.borders&&(xt(r,t.props.borders,s,i),o.delete("borders")),o.forEach(y=>{h.l.warn(`Unknown node property ${y}`)})}return f(t,r),t.intersect=function(o){return v.rect(t,o)},a}),Zt=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n,halfPadding:l}=yield d(e,t,"node "+t.classes,!0),r=a.insert("rect",":first-child"),s=t.positioned?t.width:n.width+t.padding,i=t.positioned?t.height:n.height+t.padding,c=t.positioned?-s/2:-n.width/2-l,p=t.positioned?-i/2:-n.height/2-l;if(r.attr("class","basic cluster composite label-container").attr("style",t.style).attr("rx",t.rx).attr("ry",t.ry).attr("x",c).attr("y",p).attr("width",s).attr("height",i),t.props){const o=new Set(Object.keys(t.props));t.props.borders&&(xt(r,t.props.borders,s,i),o.delete("borders")),o.forEach(y=>{h.l.warn(`Unknown node property ${y}`)})}return f(t,r),t.intersect=function(o){return v.rect(t,o)},a}),Gt=(e,t)=>B(this,null,function*(){const{shapeSvg:a}=yield d(e,t,"label",!0);h.l.trace("Classes = ",t.class);const n=a.insert("rect",":first-child"),l=0,r=0;if(n.attr("width",l).attr("height",r),a.attr("class","label edgeLabel"),t.props){const s=new Set(Object.keys(t.props));t.props.borders&&(xt(n,t.props.borders,l,r),s.delete("borders")),s.forEach(i=>{h.l.warn(`Unknown node property ${i}`)})}return f(t,n),t.intersect=function(s){return v.rect(t,s)},a});function xt(e,t,a,n){const l=[],r=i=>{l.push(i,0)},s=i=>{l.push(0,i)};t.includes("t")?(h.l.debug("add top border"),r(a)):s(a),t.includes("r")?(h.l.debug("add right border"),r(n)):s(n),t.includes("b")?(h.l.debug("add bottom border"),r(a)):s(a),t.includes("l")?(h.l.debug("add left border"),r(n)):s(n),e.attr("stroke-dasharray",l.join(" "))}const Kt=(e,t)=>{let a;t.classes?a="node "+t.classes:a="node default";const n=e.insert("g").attr("class",a).attr("id",t.domId||t.id),l=n.insert("rect",":first-child"),r=n.insert("line"),s=n.insert("g").attr("class","label"),i=t.labelText.flat?t.labelText.flat():t.labelText;let c="";typeof i=="object"?c=i[0]:c=i,h.l.info("Label text abc79",c,i,typeof i=="object");const p=s.node().appendChild(I(c,t.labelStyle,!0,!0));let o={width:0,height:0};if((0,h.m)((0,h.c)().flowchart.htmlLabels)){const _=p.children[0],m=(0,M.Ys)(p);o=_.getBoundingClientRect(),m.attr("width",o.width),m.attr("height",o.height)}h.l.info("Text 2",i);const y=i.slice(1,i.length);let b=p.getBBox();const x=s.node().appendChild(I(y.join?y.join("<br/>"):y,t.labelStyle,!0,!0));if((0,h.m)((0,h.c)().flowchart.htmlLabels)){const _=x.children[0],m=(0,M.Ys)(x);o=_.getBoundingClientRect(),m.attr("width",o.width),m.attr("height",o.height)}const k=t.padding/2;return(0,M.Ys)(x).attr("transform","translate( "+(o.width>b.width?0:(b.width-o.width)/2)+", "+(b.height+k+5)+")"),(0,M.Ys)(p).attr("transform","translate( "+(o.width<b.width?0:-(b.width-o.width)/2)+", 0)"),o=s.node().getBBox(),s.attr("transform","translate("+-o.width/2+", "+(-o.height/2-k+3)+")"),l.attr("class","outer title-state").attr("x",-o.width/2-k).attr("y",-o.height/2-k).attr("width",o.width+t.padding).attr("height",o.height+t.padding),r.attr("class","divider").attr("x1",-o.width/2-k).attr("x2",o.width/2+k).attr("y1",-o.height/2-k+b.height+k).attr("y2",-o.height/2-k+b.height+k),f(t,l),t.intersect=function(_){return v.rect(t,_)},n},zt=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n}=yield d(e,t,A(t,void 0),!0),l=n.height+t.padding,r=n.width+l/4+t.padding,s=a.insert("rect",":first-child").attr("style",t.style).attr("rx",l/2).attr("ry",l/2).attr("x",-r/2).attr("y",-l/2).attr("width",r).attr("height",l);return f(t,s),t.intersect=function(i){return v.rect(t,i)},a}),Ft=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n,halfPadding:l}=yield d(e,t,A(t,void 0),!0),r=a.insert("circle",":first-child");return r.attr("style",t.style).attr("rx",t.rx).attr("ry",t.ry).attr("r",n.width/2+l).attr("width",n.width+t.padding).attr("height",n.height+t.padding),h.l.info("Circle main"),f(t,r),t.intersect=function(s){return h.l.info("Circle intersect",t,n.width/2+l,s),v.circle(t,n.width/2+l,s)},a}),Qt=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n,halfPadding:l}=yield d(e,t,A(t,void 0),!0),r=5,s=a.insert("g",":first-child"),i=s.insert("circle"),c=s.insert("circle");return s.attr("class",t.class),i.attr("style",t.style).attr("rx",t.rx).attr("ry",t.ry).attr("r",n.width/2+l+r).attr("width",n.width+t.padding+r*2).attr("height",n.height+t.padding+r*2),c.attr("style",t.style).attr("rx",t.rx).attr("ry",t.ry).attr("r",n.width/2+l).attr("width",n.width+t.padding).attr("height",n.height+t.padding),h.l.info("DoubleCircle main"),f(t,i),t.intersect=function(p){return h.l.info("DoubleCircle intersect",t,n.width/2+l+r,p),v.circle(t,n.width/2+l+r,p)},a}),Vt=(e,t)=>B(this,null,function*(){const{shapeSvg:a,bbox:n}=yield d(e,t,A(t,void 0),!0),l=n.width+t.padding,r=n.height+t.padding,s=[{x:0,y:0},{x:l,y:0},{x:l,y:-r},{x:0,y:-r},{x:0,y:0},{x:-8,y:0},{x:l+8,y:0},{x:l+8,y:-r},{x:-8,y:-r},{x:-8,y:0}],i=u(a,l,r,s);return i.attr("style",t.style),f(t,i),t.intersect=function(c){return v.polygon(t,s,c)},a}),Pt=(e,t)=>{const a=e.insert("g").attr("class","node default").attr("id",t.domId||t.id),n=a.insert("circle",":first-child");return n.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14),f(t,n),t.intersect=function(l){return v.circle(t,7,l)},a},St=(e,t,a)=>{const n=e.insert("g").attr("class","node default").attr("id",t.domId||t.id);let l=70,r=10;a==="LR"&&(l=10,r=70);const s=n.append("rect").attr("x",-1*l/2).attr("y",-1*r/2).attr("width",l).attr("height",r).attr("class","fork-join");return f(t,s),t.height=t.height+t.padding/2,t.width=t.width+t.padding/2,t.intersect=function(i){return v.rect(t,i)},n},Tt={rhombus:Lt,composite:Zt,question:Lt,rect:Xt,labelRect:Gt,rectWithTitle:Kt,choice:Rt,circle:Ft,doublecircle:Qt,stadium:zt,hexagon:Ot,block_arrow:Yt,rect_left_inv_arrow:It,lean_right:Dt,lean_left:jt,trapezoid:Ht,inv_trapezoid:Nt,rect_right_inv_arrow:At,cylinder:Ut,start:Pt,end:(e,t)=>{const a=e.insert("g").attr("class","node default").attr("id",t.domId||t.id),n=a.insert("circle",":first-child"),l=a.insert("circle",":first-child");return l.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14),n.attr("class","state-end").attr("r",5).attr("width",10).attr("height",10),f(t,l),t.intersect=function(r){return v.circle(t,7,r)},a},note:ut,subroutine:Vt,fork:St,join:St,class_box:(e,t)=>{const a=t.padding/2,n=4,l=8;let r;t.classes?r="node "+t.classes:r="node default";const s=e.insert("g").attr("class",r).attr("id",t.domId||t.id),i=s.insert("rect",":first-child"),c=s.insert("line"),p=s.insert("line");let o=0,y=n;const b=s.insert("g").attr("class","label");let x=0;const k=t.classData.annotations&&t.classData.annotations[0],_=t.classData.annotations[0]?"\xAB"+t.classData.annotations[0]+"\xBB":"",m=b.node().appendChild(I(_,t.labelStyle,!0,!0));let T=m.getBBox();if((0,h.m)((0,h.c)().flowchart.htmlLabels)){const C=m.children[0],$=(0,M.Ys)(m);T=C.getBoundingClientRect(),$.attr("width",T.width),$.attr("height",T.height)}t.classData.annotations[0]&&(y+=T.height+n,o+=T.width);let R=t.classData.label;t.classData.type!==void 0&&t.classData.type!==""&&((0,h.c)().flowchart.htmlLabels?R+="&lt;"+t.classData.type+"&gt;":R+="<"+t.classData.type+">");const Y=b.node().appendChild(I(R,t.labelStyle,!0,!0));(0,M.Ys)(Y).attr("class","classTitle");let H=Y.getBBox();if((0,h.m)((0,h.c)().flowchart.htmlLabels)){const C=Y.children[0],$=(0,M.Ys)(Y);H=C.getBoundingClientRect(),$.attr("width",H.width),$.attr("height",H.height)}y+=H.height+n,H.width>o&&(o=H.width);const J=[];t.classData.members.forEach(C=>{const $=C.getDisplayDetails();let U=$.displayText;(0,h.c)().flowchart.htmlLabels&&(U=U.replace(/</g,"&lt;").replace(/>/g,"&gt;"));const G=b.node().appendChild(I(U,$.cssStyle?$.cssStyle:t.labelStyle,!0,!0));let X=G.getBBox();if((0,h.m)((0,h.c)().flowchart.htmlLabels)){const gt=G.children[0],et=(0,M.Ys)(G);X=gt.getBoundingClientRect(),et.attr("width",X.width),et.attr("height",X.height)}X.width>o&&(o=X.width),y+=X.height+n,J.push(G)}),y+=l;const at=[];if(t.classData.methods.forEach(C=>{const $=C.getDisplayDetails();let U=$.displayText;(0,h.c)().flowchart.htmlLabels&&(U=U.replace(/</g,"&lt;").replace(/>/g,"&gt;"));const G=b.node().appendChild(I(U,$.cssStyle?$.cssStyle:t.labelStyle,!0,!0));let X=G.getBBox();if((0,h.m)((0,h.c)().flowchart.htmlLabels)){const gt=G.children[0],et=(0,M.Ys)(G);X=gt.getBoundingClientRect(),et.attr("width",X.width),et.attr("height",X.height)}X.width>o&&(o=X.width),y+=X.height+n,at.push(G)}),y+=l,k){let C=(o-T.width)/2;(0,M.Ys)(m).attr("transform","translate( "+(-1*o/2+C)+", "+-1*y/2+")"),x=T.height+n}let or=(o-H.width)/2;return(0,M.Ys)(Y).attr("transform","translate( "+(-1*o/2+or)+", "+(-1*y/2+x)+")"),x+=H.height+n,c.attr("class","divider").attr("x1",-o/2-a).attr("x2",o/2+a).attr("y1",-y/2-a+l+x).attr("y2",-y/2-a+l+x),x+=l,J.forEach(C=>{var U;(0,M.Ys)(C).attr("transform","translate( "+-o/2+", "+(-1*y/2+x+l/2)+")");const $=C==null?void 0:C.getBBox();x+=((U=$==null?void 0:$.height)!=null?U:0)+n}),x+=l,p.attr("class","divider").attr("x1",-o/2-a).attr("x2",o/2+a).attr("y1",-y/2-a+l+x).attr("y2",-y/2-a+l+x),x+=l,at.forEach(C=>{var U;(0,M.Ys)(C).attr("transform","translate( "+-o/2+", "+(-1*y/2+x)+")");const $=C==null?void 0:C.getBBox();x+=((U=$==null?void 0:$.height)!=null?U:0)+n}),i.attr("style",t.style).attr("class","outer title-state").attr("x",-o/2-a).attr("y",-(y/2)-a).attr("width",o+t.padding).attr("height",y+t.padding),f(t,i),t.intersect=function(C){return v.rect(t,C)},s}};let P={};const Jt=(e,t,a)=>B(this,null,function*(){let n,l;if(t.link){let r;(0,h.c)().securityLevel==="sandbox"?r="_top":t.linkTarget&&(r=t.linkTarget||"_blank"),n=e.insert("svg:a").attr("xlink:href",t.link).attr("target",r),l=yield Tt[t.shape](n,t,a)}else l=yield Tt[t.shape](e,t,a),n=l;return t.tooltip&&l.attr("title",t.tooltip),t.class&&l.attr("class","node default "+t.class),n.attr("data-node","true"),n.attr("data-id",t.id),P[t.id]=n,t.haveCallback&&P[t.id].attr("class",P[t.id].attr("class")+" clickable"),n}),qt=(e,t)=>{P[t.id]=e},tr=()=>{P={}},rr=e=>{const t=P[e.id];h.l.trace("Transforming node",e.diff,e,"translate("+(e.x-e.width/2-5)+", "+e.width/2+")");const a=8,n=e.diff||0;return e.clusterNode?t.attr("transform","translate("+(e.x+n-e.width/2)+", "+(e.y-e.height/2-a)+")"):t.attr("transform","translate("+e.x+", "+e.y+")"),n},Mt=({flowchart:e})=>{var s,i;var t,a;const n=(s=(t=e==null?void 0:e.subGraphTitleMargin)==null?void 0:t.top)!=null?s:0,l=(i=(a=e==null?void 0:e.subGraphTitleMargin)==null?void 0:a.bottom)!=null?i:0,r=n+l;return{subGraphTitleTopMargin:n,subGraphTitleBottomMargin:l,subGraphTitleTotalMargin:r}},K={aggregation:18,extension:18,composition:18,dependency:6,lollipop:13.5,arrow_point:5.3};function it(e,t){if(e===void 0||t===void 0)return{angle:0,deltaX:0,deltaY:0};e=lt(e),t=lt(t);const[a,n]=[e.x,e.y],[l,r]=[t.x,t.y],s=l-a,i=r-n;return{angle:Math.atan(i/s),deltaX:s,deltaY:i}}const lt=e=>Array.isArray(e)?{x:e[0],y:e[1]}:e,Et=e=>({x:function(t,a,n){let l=0;if(a===0&&Object.hasOwn(K,e.arrowTypeStart)){const{angle:r,deltaX:s}=it(n[0],n[1]);l=K[e.arrowTypeStart]*Math.cos(r)*(s>=0?1:-1)}else if(a===n.length-1&&Object.hasOwn(K,e.arrowTypeEnd)){const{angle:r,deltaX:s}=it(n[n.length-1],n[n.length-2]);l=K[e.arrowTypeEnd]*Math.cos(r)*(s>=0?1:-1)}return lt(t).x+l},y:function(t,a,n){let l=0;if(a===0&&Object.hasOwn(K,e.arrowTypeStart)){const{angle:r,deltaY:s}=it(n[0],n[1]);l=K[e.arrowTypeStart]*Math.abs(Math.sin(r))*(s>=0?1:-1)}else if(a===n.length-1&&Object.hasOwn(K,e.arrowTypeEnd)){const{angle:r,deltaY:s}=it(n[n.length-1],n[n.length-2]);l=K[e.arrowTypeEnd]*Math.abs(Math.sin(r))*(s>=0?1:-1)}return lt(t).y+l}}),_t=(e,t,a,n,l)=>{t.arrowTypeStart&&Bt(e,"start",t.arrowTypeStart,a,n,l),t.arrowTypeEnd&&Bt(e,"end",t.arrowTypeEnd,a,n,l)},ar={arrow_cross:"cross",arrow_point:"point",arrow_barb:"barb",arrow_circle:"circle",aggregation:"aggregation",extension:"extension",composition:"composition",dependency:"dependency",lollipop:"lollipop"},Bt=(e,t,a,n,l,r)=>{const s=ar[a];if(!s){h.l.warn(`Unknown arrow type: ${a}`);return}const i=t==="start"?"Start":"End";e.attr(`marker-${t}`,`url(${n}#${l}_${r}-${s}${i})`)};let ct={},O={};const er=()=>{ct={},O={}},sr=(e,t)=>{const a=(0,h.m)((0,h.c)().flowchart.htmlLabels),n=t.labelType==="markdown"?(0,z.a)(e,t.label,{style:t.labelStyle,useHtmlLabels:a,addSvgBackground:!0}):I(t.label,t.labelStyle),l=e.insert("g").attr("class","edgeLabel"),r=l.insert("g").attr("class","label");r.node().appendChild(n);let s=n.getBBox();if(a){const c=n.children[0],p=(0,M.Ys)(n);s=c.getBoundingClientRect(),p.attr("width",s.width),p.attr("height",s.height)}r.attr("transform","translate("+-s.width/2+", "+-s.height/2+")"),ct[t.id]=l,t.width=s.width,t.height=s.height;let i;if(t.startLabelLeft){const c=I(t.startLabelLeft,t.labelStyle),p=e.insert("g").attr("class","edgeTerminals"),o=p.insert("g").attr("class","inner");i=o.node().appendChild(c);const y=c.getBBox();o.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"),O[t.id]||(O[t.id]={}),O[t.id].startLeft=p,ot(i,t.startLabelLeft)}if(t.startLabelRight){const c=I(t.startLabelRight,t.labelStyle),p=e.insert("g").attr("class","edgeTerminals"),o=p.insert("g").attr("class","inner");i=p.node().appendChild(c),o.node().appendChild(c);const y=c.getBBox();o.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"),O[t.id]||(O[t.id]={}),O[t.id].startRight=p,ot(i,t.startLabelRight)}if(t.endLabelLeft){const c=I(t.endLabelLeft,t.labelStyle),p=e.insert("g").attr("class","edgeTerminals"),o=p.insert("g").attr("class","inner");i=o.node().appendChild(c);const y=c.getBBox();o.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"),p.node().appendChild(c),O[t.id]||(O[t.id]={}),O[t.id].endLeft=p,ot(i,t.endLabelLeft)}if(t.endLabelRight){const c=I(t.endLabelRight,t.labelStyle),p=e.insert("g").attr("class","edgeTerminals"),o=p.insert("g").attr("class","inner");i=o.node().appendChild(c);const y=c.getBBox();o.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"),p.node().appendChild(c),O[t.id]||(O[t.id]={}),O[t.id].endRight=p,ot(i,t.endLabelRight)}return n};function ot(e,t){(0,h.c)().flowchart.htmlLabels&&e&&(e.style.width=t.length*9+"px",e.style.height="12px")}const nr=(e,t)=>{h.l.debug("Moving label abc88 ",e.id,e.label,ct[e.id],t);let a=t.updatedPath?t.updatedPath:t.originalPath;const n=(0,h.c)(),{subGraphTitleTotalMargin:l}=Mt(n);if(e.label){const r=ct[e.id];let s=e.x,i=e.y;if(a){const c=h.u.calcLabelPosition(a);h.l.debug("Moving label "+e.label+" from (",s,",",i,") to (",c.x,",",c.y,") abc88"),t.updatedPath&&(s=c.x,i=c.y)}r.attr("transform",`translate(${s}, ${i+l/2})`)}if(e.startLabelLeft){const r=O[e.id].startLeft;let s=e.x,i=e.y;if(a){const c=h.u.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_left",a);s=c.x,i=c.y}r.attr("transform",`translate(${s}, ${i})`)}if(e.startLabelRight){const r=O[e.id].startRight;let s=e.x,i=e.y;if(a){const c=h.u.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_right",a);s=c.x,i=c.y}r.attr("transform",`translate(${s}, ${i})`)}if(e.endLabelLeft){const r=O[e.id].endLeft;let s=e.x,i=e.y;if(a){const c=h.u.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_left",a);s=c.x,i=c.y}r.attr("transform",`translate(${s}, ${i})`)}if(e.endLabelRight){const r=O[e.id].endRight;let s=e.x,i=e.y;if(a){const c=h.u.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_right",a);s=c.x,i=c.y}r.attr("transform",`translate(${s}, ${i})`)}},ir=(e,t)=>{const a=e.x,n=e.y,l=Math.abs(t.x-a),r=Math.abs(t.y-n),s=e.width/2,i=e.height/2;return l>=s||r>=i},lr=(e,t,a)=>{h.l.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(a)}
  node        : x:${e.x} y:${e.y} w:${e.width} h:${e.height}`);const n=e.x,l=e.y,r=Math.abs(n-a.x),s=e.width/2;let i=a.x<t.x?s-r:s+r;const c=e.height/2,p=Math.abs(t.y-a.y),o=Math.abs(t.x-a.x);if(Math.abs(l-t.y)*s>Math.abs(n-t.x)*c){let y=a.y<t.y?t.y-c-l:l-c-t.y;i=o*y/p;const b={x:a.x<t.x?a.x+i:a.x-o+i,y:a.y<t.y?a.y+p-y:a.y-p+y};return i===0&&(b.x=t.x,b.y=t.y),o===0&&(b.x=t.x),p===0&&(b.y=t.y),h.l.debug(`abc89 topp/bott calc, Q ${p}, q ${y}, R ${o}, r ${i}`,b),b}else{a.x<t.x?i=t.x-s-n:i=n-s-t.x;let y=p*i/o,b=a.x<t.x?a.x+o-i:a.x-o+i,x=a.y<t.y?a.y+y:a.y-y;return h.l.debug(`sides calc abc89, Q ${p}, q ${y}, R ${o}, r ${i}`,{_x:b,_y:x}),i===0&&(b=t.x,x=t.y),o===0&&(b=t.x),p===0&&(x=t.y),{x:b,y:x}}},Ct=(e,t)=>{h.l.debug("abc88 cutPathAtIntersect",e,t);let a=[],n=e[0],l=!1;return e.forEach(r=>{if(!ir(t,r)&&!l){const s=lr(t,n,r);let i=!1;a.forEach(c=>{i=i||c.x===s.x&&c.y===s.y}),a.some(c=>c.x===s.x&&c.y===s.y)||a.push(s),l=!0}else n=r,l||a.push(r)}),a},cr=function(e,t,a,n,l,r,s){let i=a.points;h.l.debug("abc88 InsertEdge: edge=",a,"e=",t);let c=!1;const p=r.node(t.v);var o=r.node(t.w);o!=null&&o.intersect&&(p!=null&&p.intersect)&&(i=i.slice(1,a.points.length-1),i.unshift(p.intersect(i[0])),i.push(o.intersect(i[i.length-1]))),a.toCluster&&(h.l.debug("to cluster abc88",n[a.toCluster]),i=Ct(a.points,n[a.toCluster].node),c=!0),a.fromCluster&&(h.l.debug("from cluster abc88",n[a.fromCluster]),i=Ct(i.reverse(),n[a.fromCluster].node).reverse(),c=!0);const y=i.filter(H=>!Number.isNaN(H.y));let b=M.$0Z;a.curve&&(l==="graph"||l==="flowchart")&&(b=a.curve);const{x,y:k}=Et(a),_=(0,M.jvg)().x(x).y(k).curve(b);let m;switch(a.thickness){case"normal":m="edge-thickness-normal";break;case"thick":m="edge-thickness-thick";break;case"invisible":m="edge-thickness-thick";break;default:m=""}switch(a.pattern){case"solid":m+=" edge-pattern-solid";break;case"dotted":m+=" edge-pattern-dotted";break;case"dashed":m+=" edge-pattern-dashed";break}const T=e.append("path").attr("d",_(y)).attr("id",a.id).attr("class"," "+m+(a.classes?" "+a.classes:"")).attr("style",a.style);let R="";((0,h.c)().flowchart.arrowMarkerAbsolute||(0,h.c)().state.arrowMarkerAbsolute)&&(R=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,R=R.replace(/\(/g,"\\("),R=R.replace(/\)/g,"\\)")),_t(T,a,R,s,l);let Y={};return c&&(Y.updatedPath=i),Y.originalPath=a.points,Y}}}]);
}());