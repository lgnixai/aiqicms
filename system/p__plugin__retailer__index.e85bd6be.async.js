"use strict";(self.webpackChunkAnQiCMS=self.webpackChunkAnQiCMS||[]).push([[150],{12113:function(ee,A,t){t.r(A),t.d(A,{default:function(){return q}});var N=t(90228),o=t.n(N),z=t(87999),y=t.n(z),Q=t(48305),g=t.n(Q),h=t(70505),D=t(96570),E=t(18640),F=t(35937),O=t(96640),m=t(32064),T=t(34206),H=t(54203),K=t(53745),G=t(47634),J=t(16483),L=t.n(J),u=t(75271),U=t(76334),n=t(52676),W=function(p){var P=(0,u.useState)(null),v=g()(P,2),b=v[0],S=v[1],w=(0,u.useState)(!1),M=g()(w,2),x=M[0],j=M[1],B=(0,u.useState)(!1),C=g()(B,2),I=C[0],Z=C[1],a=(0,m.useIntl)(),V=function(){var d=y()(o()().mark(function s(){var l;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.GR)();case 2:l=e.sent,S(l.data||{}),Z(!0);case 5:case"end":return e.stop()}},s)}));return function(){return d.apply(this,arguments)}}();(0,u.useEffect)(function(){V()},[]);var Y=function(){var d=y()(o()().mark(function s(l){var i;return o()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:l.goods_price=Number(l.goods_price),l.share_reward=Number(l.share_reward),l.parent_reward=Number(l.parent_reward),i=T.ZP.loading(a.formatMessage({id:"setting.system.submitting"}),0),(0,h.Qu)(l).then(function(c){T.ZP.success(c.msg),j(!1)}).catch(function(c){console.log(c)}).finally(function(){i()});case 5:case"end":return r.stop()}},s)}));return function(l){return d.apply(this,arguments)}}();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{onClick:function(){j(!x)},children:p.children}),I&&(0,n.jsxs)(F.Y,{title:a.formatMessage({id:"plugin.retailer.setting"}),open:x,initialValues:b,onOpenChange:function(s){j(s)},onFinish:Y,children:[(0,n.jsx)(U.Z.Group,{name:"allow_self",label:a.formatMessage({id:"plugin.retailer.allow-self"}),options:[{value:0,label:a.formatMessage({id:"plugin.retailer.allow-self.no"})},{value:1,label:a.formatMessage({id:"plugin.retailer.allow-self.yes"})}],extra:a.formatMessage({id:"plugin.retailer.allow-self.description"})}),(0,n.jsx)(U.Z.Group,{name:"become_retailer",label:a.formatMessage({id:"plugin.retailer.become-retailer"}),options:[{value:0,label:a.formatMessage({id:"plugin.retailer.become-retailer.manual"})},{value:1,label:a.formatMessage({id:"plugin.retailer.become-retailer.auto"})}],extra:a.formatMessage({id:"plugin.retailer.become-retailer.description"})})]})]})},X=W,k=function(){var p=(0,u.useRef)(),P=(0,u.useState)(!1),v=g()(P,2),b=v[0],S=v[1],w=(0,u.useState)({}),M=g()(w,2),x=M[0],j=M[1],B=(0,u.useState)(!1),C=g()(B,2),I=C[0],Z=C[1],a=(0,m.useIntl)(),V=function(e){j(e),Z(!0)},Y=function(){var i=y()(o()().mark(function e(r){return o()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:r.id=x.id,(0,h.BB)(r).then(function(){var R;(R=p.current)===null||R===void 0||R.reload()});case 2:case"end":return f.stop()}},e)}));return function(r){return i.apply(this,arguments)}}(),d=function(){var i=y()(o()().mark(function e(r){return o()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:r.cancel||(r.is_retailer=1),r.id=Number(r.id),(0,h.BB)(r).then(function(R){var $;S(!1),T.ZP.info(R.msg),($=p.current)===null||$===void 0||$.reload()});case 3:case"end":return f.stop()}},e)}));return function(r){return i.apply(this,arguments)}}(),s=function(e){H.Z.confirm({title:a.formatMessage({id:"plugin.retailer.cancel.confirm"}),content:a.formatMessage({id:"plugin.retailer.cancel.content"}),onOk:function(){d({id:e.id,is_retailer:0,cancel:!0})}})},l=[{title:a.formatMessage({id:"plugin.retailer.user-id"}),dataIndex:"id"},{title:a.formatMessage({id:"plugin.retailer.user-name"}),dataIndex:"user_name"},{title:a.formatMessage({id:"plugin.retailer.real-name"}),dataIndex:"real_name",hideInSearch:!0},{title:a.formatMessage({id:"plugin.retailer.balance"}),dataIndex:"balance",hideInSearch:!0,render:function(e){return e/100}},{title:a.formatMessage({id:"plugin.retailer.total-reward"}),dataIndex:"total_reward",hideInSearch:!0,render:function(e){return e/100}},{title:a.formatMessage({id:"plugin.retailer.create-time"}),dataIndex:"created_time",hideInSearch:!0,render:function(e,r){return L()(r.created_time*1e3).format("YYYY-MM-DD HH:mm")}},{title:a.formatMessage({id:"setting.action"}),dataIndex:"option",valueType:"option",render:function(e,r){return(0,n.jsxs)(K.Z,{size:20,children:[(0,n.jsx)("a",{onClick:function(){V(r)},children:(0,n.jsx)(m.FormattedMessage,{id:"plugin.retailer.change-name"})},"edit"),(0,n.jsx)("a",{onClick:function(){s(r)},children:(0,n.jsx)(m.FormattedMessage,{id:"plugin.retailer.cancel"})},"edit")]})}}];return(0,n.jsxs)(D._z,{children:[(0,n.jsx)(E.Z,{headerTitle:a.formatMessage({id:"menu.plugin.retailer"}),actionRef:p,rowKey:"id",toolBarRender:function(){return[(0,n.jsx)(G.ZP,{type:"primary",onClick:function(){S(!0)},children:(0,n.jsx)(m.FormattedMessage,{id:"plugin.retailer.add"})},"add"),(0,n.jsx)(X,{onCancel:function(){},children:(0,n.jsx)(G.ZP,{type:"primary",children:(0,n.jsx)(m.FormattedMessage,{id:"plugin.retailer.setting"})})},"group")]},tableAlertOptionRender:!1,request:function(e){return(0,h.UB)(e)},columnsState:{persistenceKey:"retailer-table",persistenceType:"localStorage"},columns:l,rowSelection:!1,pagination:{showSizeChanger:!0}}),b&&(0,n.jsx)(F.Y,{title:a.formatMessage({id:"plugin.retailer.add.name"}),open:b,onOpenChange:function(e){S(e)},onFinish:d,children:(0,n.jsx)(O.Z,{name:"id",label:a.formatMessage({id:"plugin.retailer.user-id"})})}),I&&(0,n.jsxs)(F.Y,{title:a.formatMessage({id:"plugin.retailer.change-name"}),open:I,onOpenChange:function(e){Z(e)},onFinish:Y,children:[(0,n.jsx)(O.Z,{name:"user_name",initialValue:x.user_name,label:a.formatMessage({id:"plugin.retailer.user-name"}),readonly:!0}),(0,n.jsx)(O.Z,{name:"real_name",label:a.formatMessage({id:"plugin.retailer.change-name.new"})})]})]})},q=k}}]);
