"use strict";(self.webpackChunkAnQiCMS=self.webpackChunkAnQiCMS||[]).push([[5677],{67881:function(de,P,e){e.r(P);var x=e(90228),m=e.n(x),K=e(87999),O=e.n(K),L=e(15558),B=e.n(L),W=e(48305),c=e.n(W),E=e(75304),S=e(16621),y=e(96570),Z=e(18640),G=e(35937),M=e(96640),F=e(76334),u=e(32064),D=e(25405),f=e(34206),N=e(54203),z=e(53745),V=e(47634),Q=e(18874),$=e(37697),l=e(75271),t=e(52676),Y=D.Z.Panel,H=function(){var J=(0,u.useModel)("@@initialState"),X=J.initialState,v=(0,l.useRef)(),k=(0,l.useState)(!1),C=c()(k,2),U=C[0],p=C[1],w=(0,l.useState)({}),A=c()(w,2),I=A[0],q=A[1],ee=(0,l.useState)([]),R=c()(ee,2),ne=R[0],te=R[1],se=(0,l.useState)([]),T=c()(se,2),d=T[0],j=T[1],_=(0,u.useIntl)(),ae=X.currentUser,_e=function(){(0,E.Cad)().then(function(n){te(n.data||[])})};(0,l.useEffect)(function(){_e()},[]);var ie=function(n,s){var a,r=s.target.checked;if(r)d.push(n.path);else{var o=d.indexOf(n.path);d.splice(o,1)}j((a=[]).concat.apply(a,B()(d)))},b=function(n){var s;q(n),j(((s=n.setting)===null||s===void 0?void 0:s.permissions)||[]),p(!0)},oe=function(){var i=O()(m()().mark(function n(s){var a;return m()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:a=Object.assign(I,s),typeof a.setting=="undefined"&&(a.setting={}),a.status=Number(a.status),a.setting.permissions=d,(0,E.L4_)(a).then(function(g){if(g.code!==0)f.ZP.error(g.msg);else{var h;f.ZP.info(g.msg),(h=v.current)===null||h===void 0||h.reload(),p(!1)}});case 5:case"end":return o.stop()}},n)}));return function(s){return i.apply(this,arguments)}}(),re=function(n){if(ae.group_id===n.id||n.id===1){f.ZP.error(_.formatMessage({id:"account.group.cannot-delete"}));return}N.Z.confirm({title:_.formatMessage({id:"account.group.confirm-delete"}),onOk:function(){(0,E.sbN)({id:n.id}).then(function(a){var r;f.ZP.info(a.msg),(r=v.current)===null||r===void 0||r.reload()})}})},le=[{title:"ID",dataIndex:"id"},{title:_.formatMessage({id:"account.group.title"}),dataIndex:"title"},{title:_.formatMessage({id:"website.status"}),dataIndex:"status",valueEnum:{0:{text:_.formatMessage({id:"setting.content.notenable"}),status:"Default"},1:{text:_.formatMessage({id:"setting.content.enable"}),status:"Success"}}},{title:_.formatMessage({id:"setting.action"}),dataIndex:"option",valueType:"option",render:function(n,s){return(0,t.jsxs)(z.Z,{size:20,children:[(0,t.jsx)("a",{onClick:function(){b(s)},children:(0,t.jsx)(u.FormattedMessage,{id:"setting.action.edit"})},"edit"),s.id===1&&(0,t.jsx)("a",{className:"text-red",onClick:O()(m()().mark(function a(){return m()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,re(s);case 2:case"end":return o.stop()}},a)})),children:(0,t.jsx)(u.FormattedMessage,{id:"setting.system.delete"})},"delete")]})}}];return(0,t.jsxs)(y._z,{children:[(0,t.jsx)(Z.Z,{headerTitle:_.formatMessage({id:"account.group.list"}),rowKey:"id",actionRef:v,search:!1,request:function(n){return(0,E.Wig)(n)},columnsState:{persistenceKey:"account-group-table",persistenceType:"localStorage"},columns:le,toolBarRender:function(){return[(0,t.jsxs)(V.ZP,{type:"primary",onClick:function(){b({})},children:[(0,t.jsx)(S.Z,{})," ",(0,t.jsx)(u.FormattedMessage,{id:"account.group.add"})]},"add")]}}),U&&(0,t.jsxs)(G.Y,{width:1e3,title:_.formatMessage({id:"account.group.edit"}),open:U,initialValues:I,layout:"horizontal",onFinish:oe,onOpenChange:function(n){return p(n)},children:[(0,t.jsx)("div",{className:"mb-normal",children:(0,t.jsx)(Q.Z,{message:_.formatMessage({id:"account.group.tips"})})}),(0,t.jsx)(M.Z,{name:"title",label:_.formatMessage({id:"account.group.title"}),width:"lg"}),(0,t.jsx)(M.Z,{name:"description",label:_.formatMessage({id:"account.group.remark"}),width:"lg"}),(0,t.jsx)(F.Z.Group,{label:_.formatMessage({id:"website.status"}),name:"status",valueEnum:{0:_.formatMessage({id:"setting.content.notenable"}),1:_.formatMessage({id:"setting.content.enable"})}}),(0,t.jsx)(M.Z,{label:_.formatMessage({id:"account.group.permission"}),children:(0,t.jsx)(D.Z,{defaultActiveKey:"0",children:ne.map(function(i,n){return(0,t.jsx)(Y,{header:i.name,children:i.menus.map(function(s,a){return(0,t.jsx)($.Z,{onChange:function(o){ie(s,o)},checked:d.indexOf(s.path)!==-1,children:s.name},a)})},n)})})})]})]})};P.default=H}}]);
