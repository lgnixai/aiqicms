(self.webpackChunkAnQiCMS=self.webpackChunkAnQiCMS||[]).push([[7459],{41265:function(N,z,e){"use strict";var C=e(18201),j=e(66342),o=e(59831),n=e(75271),f=e(38465),E=e(31945),K=e(52676),m=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],H=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],p=function(l,h){var W=l.fieldProps,R=l.children,U=l.params,A=l.proFieldProps,u=l.mode,S=l.valueEnum,M=l.request,t=l.showSearch,I=l.options,T=(0,j.Z)(l,m),re=(0,n.useContext)(f.Z);return(0,K.jsx)(E.Z,(0,C.Z)((0,C.Z)({valueEnum:(0,o.h)(S),request:M,params:U,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,C.Z)({options:I,mode:u,showSearch:t,getPopupContainer:re.getPopupContainer},W),ref:h,proFieldProps:A},T),{},{children:R}))},y=n.forwardRef(function(v,l){var h=v.fieldProps,W=v.children,R=v.params,U=v.proFieldProps,A=v.mode,u=v.valueEnum,S=v.request,M=v.options,t=(0,j.Z)(v,H),I=(0,C.Z)({options:M,mode:A||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},h),T=(0,n.useContext)(f.Z);return(0,K.jsx)(E.Z,(0,C.Z)((0,C.Z)({valueEnum:(0,o.h)(u),request:S,params:R,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,C.Z)({getPopupContainer:T.getPopupContainer},I),ref:l,proFieldProps:U},t),{},{children:W}))}),P=n.forwardRef(p),w=y,k=P;k.SearchSelect=w,k.displayName="ProFormComponent",z.Z=k},85606:function(N,z,e){"use strict";var C=e(48305),j=e.n(C),o=e(75304),n=e(22683),f=e(96570),E=e(75271),K=e(52676),m=function(p){var y=(0,E.useState)(void 0),P=j()(y,2),w=P[0],k=P[1],v=(0,E.useState)(""),l=j()(v,2),h=l[0],W=l[1],R=function(){(0,o.roP)({type:"multi"}).then(function(u){var S=(u.data||[]).map(function(T){return{key:T.id,tab:T.name,is_main:T.is_main}});k(S);var M=(0,n.KJ)("sub-site-id");!M&&S.length>0&&(M=S[0].key+"");var t=S.find(function(T){return T.key===Number(M)}),I=!1;t&&(I=!0,t.is_main&&(I=!1)),(0,n.Xq)("is-sub-site",I),W(M)})};(0,E.useEffect)(function(){R()},[]);var U=function(u){var S;W(u),(0,n.Xq)("sub-site-id",u);var M=w.find(function(I){return I.key===Number(u)}),t=!0;M.is_main&&(t=!1),(0,n.Xq)("is-sub-site",t),(S=p.onTabChange)===null||S===void 0||S.call(p,u,t)};return(0,K.jsx)(f._z,{tabList:w,tabActiveKey:h,onTabChange:U,title:p.title,children:p.children})};z.Z=m},9954:function(N,z,e){"use strict";e.r(z),e.d(z,{default:function(){return fe}});var C=e(26068),j=e.n(C),o=e(90228),n=e.n(o),f=e(335),E=e.n(f),K=e(87999),m=e.n(K),H=e(48305),p=e.n(H),y=e(85606),P=e(75304),w=e(1545),k=e(16621),v=e(41265),l=e(18640),h=e(32064),W=e(54203),R=e(34206),U=e(53745),A=e(47634),u=e(75271),S=e(35937),M=e(66857),t=e(52676),I=function($){var ee=(0,u.useState)(!1),J=p()(ee,2),te=J[0],Q=J[1],L=(0,h.useIntl)(),_=function(){var F=m()(n()().mark(function i(Z){var V,d,D;return n()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!te){c.next=2;break}return c.abrupt("return");case 2:Q(!0),V=R.ZP.loading(L.formatMessage({id:"setting.system.submitting"}),0),d=Z.tags.split(`
`),c.t0=n()().keys(d);case 6:if((c.t1=c.t0()).done){c.next=14;break}if(D=c.t1.value,d[D].length!==0){c.next=10;break}return c.abrupt("continue",6);case 10:return c.next=12,(0,w.LG)({title:d[D],category_id:Number(Z.category_id)});case 12:c.next=6;break;case 14:Q(!1),V(),$.onSubmit();case 17:case"end":return c.stop()}},i)}));return function(Z){return F.apply(this,arguments)}}();return(0,t.jsxs)(S.Y,{width:600,title:L.formatMessage({id:"content.tag.batch-add"}),open:$.open,layout:"horizontal",modalProps:{okButtonProps:{loading:te}},onOpenChange:function(i){i||$.onCancel(i)},onFinish:function(){var F=m()(n()().mark(function i(Z){return n()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:_(Z);case 1:case"end":return d.stop()}},i)}));return function(i){return F.apply(this,arguments)}}(),children:[(0,t.jsx)(v.Z,{label:L.formatMessage({id:"content.category.name"}),showSearch:!0,name:"category_id",request:m()(n()().mark(function F(){var i,Z;return n()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,P.CPB)({type:1});case 2:return i=d.sent,Z=(i.data||[]).map(function(D){return{spacer:D.spacer,label:D.title+(D.status===1?"":L.formatMessage({id:"setting.nav.hide"})),value:D.id}}),d.abrupt("return",[{spacer:"",label:L.formatMessage({id:"content.category.top"}),value:0}].concat(Z));case 5:case"end":return d.stop()}},F)})),fieldProps:{optionItemRender:function(i){return(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:i.spacer+i.label}})}}}),(0,t.jsx)(M.Z,{name:"tags",label:L.formatMessage({id:"content.tags.name"}),placeholder:L.formatMessage({id:"content.tags.placeholder"}),fieldProps:{rows:15}})]})},T=I,re=e(96608),ce=function(){var $=(0,u.useRef)(),ee=(0,u.useState)([]),J=p()(ee,2),te=J[0],Q=J[1],L=(0,u.useState)(!1),_=p()(L,2),F=_[0],i=_[1],Z=(0,u.useState)(""),V=p()(Z,2),d=V[0],D=V[1],ae=(0,u.useState)(!1),c=p()(ae,2),se=c[0],pe=c[1],b=(0,h.useIntl)(),ve=function(r,s){D(r),pe(s)},ie=function(){var g=m()(n()().mark(function r(s){return n()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:W.Z.confirm({title:b.formatMessage({id:"content.tags.delete.confirm"}),onOk:function(){var X=m()(n()().mark(function le(){var x,B,ne,Y,ue,de;return n()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(x=R.ZP.loading(b.formatMessage({id:"content.delete.deletting"}),0),s){a.next=3;break}return a.abrupt("return",!0);case 3:a.prev=3,Y=E()(s),a.prev=5,Y.s();case 7:if((ue=Y.n()).done){a.next=13;break}return de=ue.value,a.next=11,(0,w.Pn)({id:de});case 11:a.next=7;break;case 13:a.next=18;break;case 15:a.prev=15,a.t0=a.catch(5),Y.e(a.t0);case 18:return a.prev=18,Y.f(),a.finish(18);case 21:return x(),R.ZP.success(b.formatMessage({id:"content.delete.success"})),Q([]),(B=$.current)===null||B===void 0||(ne=B.reloadAndRest)===null||ne===void 0||ne.call(B),a.abrupt("return",!0);case 28:return a.prev=28,a.t1=a.catch(3),x(),R.ZP.error(b.formatMessage({id:"content.delete.failure"})),a.abrupt("return",!0);case 33:case"end":return a.stop()}},le,null,[[3,28],[5,15,18,21]])}));function q(){return X.apply(this,arguments)}return q}()});case 1:case"end":return O.stop()}},r)}));return function(s){return g.apply(this,arguments)}}(),oe=function(){var g=m()(n()().mark(function r(s){return n()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:h.history.push("/archive/tag/detail?id="+(s.id||"new"));case 1:case"end":return O.stop()}},r)}));return function(s){return g.apply(this,arguments)}}(),he=function(){i(!0)},ge=[{title:"ID",dataIndex:"id",hideInSearch:!0},{title:b.formatMessage({id:"content.tags.name"}),dataIndex:"title",render:function(r,s){return(0,t.jsx)("a",{href:s.link,target:"_blank",rel:"noreferrer",children:r})}},{title:b.formatMessage({id:"content.category.name"}),dataIndex:"category_title",renderFormItem:function(r,s){var G=s.fieldProps;return(0,t.jsx)(v.Z,{name:"category_id",request:m()(n()().mark(function O(){var X,q;return n()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,P.CPB)({type:1});case 2:return X=x.sent,q=[{spacer:"",title:b.formatMessage({id:"content.category.all"}),id:0,status:1}].concat(X.data||[]).map(function(B){return{spacer:B.spacer,label:B.title+(B.status===1?"":b.formatMessage({id:"setting.nav.hide"})),value:B.id}}),x.abrupt("return",q);case 5:case"end":return x.stop()}},O)})),fieldProps:j()(j()({},G),{},{optionItemRender:function(X){return(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:X.spacer+X.label}})}})})}},{title:b.formatMessage({id:"content.tags.first-letter.name"}),dataIndex:"first_letter",hideInSearch:!0},{title:b.formatMessage({id:"content.description.name"}),dataIndex:"description",hideInSearch:!0},{title:b.formatMessage({id:"setting.action"}),dataIndex:"option",valueType:"option",render:function(r,s){return(0,t.jsxs)(U.Z,{size:20,children:[(0,t.jsx)("a",{onClick:function(){oe(s)},children:(0,t.jsx)(h.FormattedMessage,{id:"setting.action.edit"})},"edit"),(0,t.jsx)("a",{className:"text-red",onClick:function(){ie([s.id])},children:(0,t.jsx)(h.FormattedMessage,{id:"setting.system.delete"})},"delete")]})}}];return(0,t.jsxs)(y.Z,{onTabChange:ve,children:[(0,t.jsx)(l.Z,{headerTitle:b.formatMessage({id:"menu.archive.tag"}),actionRef:$,rowKey:"id",toolBarRender:function(){return[!se&&(0,t.jsx)(A.ZP,{type:"default",onClick:function(){he()},children:(0,t.jsx)(h.FormattedMessage,{id:"content.tags.batch-add"})},"add2"),!se&&(0,t.jsxs)(A.ZP,{type:"primary",onClick:function(){oe({})},children:[(0,t.jsx)(k.Z,{})," ",(0,t.jsx)(h.FormattedMessage,{id:"content.tags.add"})]},"add")]},tableAlertOptionRender:function(r){var s=r.selectedRowKeys,G=r.onCleanSelected;return(0,t.jsxs)(U.Z,{children:[(0,t.jsx)(A.ZP,{size:"small",onClick:function(){ie(s)},children:(0,t.jsx)(h.FormattedMessage,{id:"content.option.batch-delete"})}),(0,t.jsx)(A.ZP,{type:"link",size:"small",onClick:G,children:(0,t.jsx)(h.FormattedMessage,{id:"content.option.cancel-select"})})]})},request:function(r){return r.type=1,(0,w.NJ)(r)},columnsState:{persistenceKey:"archive-tag-table",persistenceType:"localStorage"},columns:ge,rowSelection:{onChange:function(r){Q(r)}},pagination:{showSizeChanger:!0}},d),F&&(0,t.jsx)(T,{open:F,onCancel:function(){i(!1)},onSubmit:m()(n()().mark(function g(){return n()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:i(!1),$.current&&$.current.reload();case 2:case"end":return s.stop()}},g)}))})]})},fe=ce},96608:function(){"use strict"},335:function(N,z,e){var C=e(31479);function j(o,n){var f=typeof Symbol!="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!f){if(Array.isArray(o)||(f=C(o))||n&&o&&typeof o.length=="number"){f&&(o=f);var E=0,K=function(){};return{s:K,n:function(){return E>=o.length?{done:!0}:{done:!1,value:o[E++]}},e:function(P){throw P},f:K}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,H=!1,p;return{s:function(){f=f.call(o)},n:function(){var P=f.next();return m=P.done,P},e:function(P){H=!0,p=P},f:function(){try{!m&&f.return!=null&&f.return()}finally{if(H)throw p}}}}N.exports=j,N.exports.__esModule=!0,N.exports.default=N.exports}}]);
