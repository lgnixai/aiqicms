"use strict";(self.webpackChunkAnQiCMS=self.webpackChunkAnQiCMS||[]).push([[4053],{71384:function(B,b,t){var C=t(18201),o=t(66342),_=t(75271),g=t(31945),F=t(52676),f=["fieldProps","min","proFieldProps","max"],w=function(d,N){var m=d.fieldProps,y=d.min,R=d.proFieldProps,v=d.max,j=(0,o.Z)(d,f);return(0,F.jsx)(g.Z,(0,C.Z)({valueType:"digit",fieldProps:(0,C.Z)({min:y,max:v},m),ref:N,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:R},j))},O=_.forwardRef(w);b.Z=O},60409:function(B,b,t){t.d(b,{UW:function(){return o}});var C=t(74133),o=C.A.Group},85606:function(B,b,t){var C=t(48305),o=t.n(C),_=t(75304),g=t(22683),F=t(96570),f=t(75271),w=t(52676),O=function(d){var N=(0,f.useState)(void 0),m=o()(N,2),y=m[0],R=m[1],v=(0,f.useState)(""),j=o()(v,2),A=j[0],I=j[1],K=function(){(0,_.roP)({type:"multi"}).then(function(E){var p=(E.data||[]).map(function(Z){return{key:Z.id,tab:Z.name,is_main:Z.is_main}});R(p);var M=(0,g.KJ)("sub-site-id");!M&&p.length>0&&(M=p[0].key+"");var P=p.find(function(Z){return Z.key===Number(M)}),c=!1;P&&(c=!0,P.is_main&&(c=!1)),(0,g.Xq)("is-sub-site",c),I(M)})};(0,f.useEffect)(function(){K()},[]);var D=function(E){var p;I(E),(0,g.Xq)("sub-site-id",E);var M=y.find(function(c){return c.key===Number(E)}),P=!0;M.is_main&&(P=!1),(0,g.Xq)("is-sub-site",P),(p=d.onTabChange)===null||p===void 0||p.call(d,E,P)};return(0,w.jsx)(F._z,{tabList:y,tabActiveKey:A,onTabChange:D,title:d.title,children:d.children})};b.Z=O},42467:function(B,b,t){t.r(b),t.d(b,{default:function(){return ne}});var C=t(90228),o=t.n(C),_=t(87999),g=t.n(_),F=t(48305),f=t.n(F),w=t(85606),O=t(75304),L=t(74133),d=t(76334),N=t(60409),m=t(96640),y=t(71384),R=t(35937),v=t(32064),j=t(34206),A=t(54203),I=t(91827),K=t(59124),D=t(48806),U=t(77965),E=t(53745),p=t(43330),M=t(48782),P=t(47634),c=t(75271),Z=t(16621),e=t(52676),ae=function(){var W,X=(0,v.useModel)("@@initialState"),$=X.initialState,Ee=X.setInitialState,ie=(0,c.useState)(null),H=f()(ie,2),s=H[0],S=H[1],se=(0,c.useState)(!1),J=f()(se,2),le=J[0],re=J[1],oe=(0,c.useState)(!1),Q=f()(oe,2),V=Q[0],G=Q[1],ue=(0,c.useState)(""),Y=f()(ue,2),ge=Y[0],de=Y[1],me=(0,c.useState)(""),k=f()(me,2),ce=k[0],fe=k[1],q="",n=(0,v.useIntl)(),ee=function(){var l=g()(o()().mark(function a(){var r;return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,O.K1g)();case 2:r=i.sent,S(r.data||{}),re(!0);case 5:case"end":return i.stop()}},a)}));return function(){return l.apply(this,arguments)}}(),x=function(){(0,O._K3)({text:q}).then(function(a){de(a.data)})},ve=function(a){ee().then(function(){x(),fe(a)})};(0,c.useEffect)(function(){ee(),x()},[]);var he=function(a){s.open=a.target.value,S(Object.assign({},s))},pe=function(){var l=g()(o()().mark(function a(r){var u,i;return o()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:u=j.ZP.loading(n.formatMessage({id:"setting.system.submitting"}),0),i=Object.assign(s,r),i.width=Number(i.width),i.height=Number(i.height),(0,O.RfJ)(i).then(function(z){j.ZP.success(z.msg),x()}).catch(function(z){console.log(z)}).finally(function(){u()});case 5:case"end":return h.stop()}},a)}));return function(r){return l.apply(this,arguments)}}(),te=function(a,r){var u=new FormData;u.append("file",r.file),u.append("name",a);var i=j.ZP.loading(n.formatMessage({id:"setting.system.submitting"}),0);(0,O.evT)(u).then(function(T){j.ZP.success(T.msg),a==="bg_image"?(s.bg_images||(s.bg_images=[]),s.bg_images.push(T.data)):s[a]=T.data,S(Object.assign({},s)),x()}).finally(function(){i()})},xe=function(a){A.Z.confirm({title:n.formatMessage({id:"setting.system.confirm-delete"}),onOk:function(){var r=g()(o()().mark(function i(){return o()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:s.bg_images.splice(a,1),S(Object.assign({},s)),x();case 3:case"end":return h.stop()}},i)}));function u(){return r.apply(this,arguments)}return u}()})},je=function(a){a.stopPropagation(),A.Z.confirm({title:n.formatMessage({id:"setting.system.confirm-delete"}),onOk:function(){var r=g()(o()().mark(function i(){return o()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:s.font_path="",S(Object.assign({},s)),x();case 3:case"end":return h.stop()}},i)}));function u(){return r.apply(this,arguments)}return u}()})},Me=function(a){s.font_color=a,S(Object.assign({},s)),x()},Pe=function(a){s.font_bg_color=a,S(Object.assign({},s)),x()},be=function(){s.font_bg_color="",S(Object.assign({},s)),x()},Ce=function(){var l=g()(o()().mark(function a(r){return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:q=r.text,G(!1),x();case 3:case"end":return i.stop()}},a)}));return function(r){return l.apply(this,arguments)}}();return(0,e.jsxs)(w.Z,{onTabChange:function(a){return ve(a)},children:[(0,e.jsx)(I.Z,{children:(0,e.jsxs)(K.Z,{gutter:16,children:[(0,e.jsx)(D.Z,{span:12,children:le&&(0,e.jsxs)(L.A,{title:n.formatMessage({id:"menu.plugin.titleimage"}),layout:"vertical",initialValues:s,onFinish:pe,children:[(0,e.jsx)(d.Z.Group,{name:"open",label:n.formatMessage({id:"plugin.titleimage.open"}),options:[{value:!1,label:n.formatMessage({id:"plugin.titleimage.open.no"})},{value:!0,label:n.formatMessage({id:"plugin.titleimage.open.yes"})}],fieldProps:{onChange:he},extra:n.formatMessage({id:"plugin.titleimage.open.description"})}),(0,e.jsxs)("div",{style:{display:s.open?"block":"none"},children:[(0,e.jsx)(d.Z.Group,{name:"draw_sub",label:n.formatMessage({id:"plugin.titleimage.draw-sub"}),options:[{value:!1,label:n.formatMessage({id:"plugin.titleimage.open.no"})},{value:!0,label:n.formatMessage({id:"plugin.titleimage.open.yes"})}],extra:n.formatMessage({id:"plugin.titleimage.draw-sub.description"})}),(0,e.jsxs)(N.UW,{title:n.formatMessage({id:"plugin.titleimage.size"}),children:[(0,e.jsx)(m.Z,{name:"width",width:"sm",fieldProps:{suffix:n.formatMessage({id:"plugin.titleimage.width"})},placeholder:n.formatMessage({id:"plugin.titleimage.width.placeholder"})}),"\xD7",(0,e.jsx)(m.Z,{name:"height",width:"sm",fieldProps:{suffix:n.formatMessage({id:"plugin.titleimage.height"})},placeholder:n.formatMessage({id:"plugin.titleimage.height.placeholder"})})]}),(0,e.jsx)(m.Z,{width:"sm",label:n.formatMessage({id:"plugin.titleimage.color"}),extra:n.formatMessage({id:"plugin.titleimage.color.default"}),children:(0,e.jsx)(U.Z,{showText:!0,value:s.font_color,onChange:function(a){Me(a.toHex())}},"1")}),(0,e.jsx)(m.Z,{width:"sm",label:n.formatMessage({id:"plugin.titleimage.color_bg"}),extra:n.formatMessage({id:"plugin.titleimage.color_bg.default"}),children:(0,e.jsx)(E.Z,{align:"center",size:16,children:(0,e.jsx)(U.Z,{showText:!0,value:s.font_bg_color,onChange:function(a){Pe(a.toHex())},allowClear:!0,onClear:function(){return be()}},"2")})}),(0,e.jsx)(y.Z,{name:"font_size",label:n.formatMessage({id:"plugin.titleimage.font-size"}),width:"lg",placeholder:n.formatMessage({id:"plugin.titleimage.font-size.placeholder"})}),!s.bg_images&&(0,e.jsx)(d.Z.Group,{name:"noise",label:n.formatMessage({id:"plugin.titleimage.noise"}),options:[{value:!1,label:n.formatMessage({id:"plugin.titleimage.noise.no"})},{value:!0,label:n.formatMessage({id:"plugin.titleimage.noise.yes"})}],extra:n.formatMessage({id:"plugin.titleimage.noise.description"})}),(0,e.jsx)(m.Z,{label:n.formatMessage({id:"plugin.titleimage.bg-image"}),extra:n.formatMessage({id:"plugin.titleimage.bg-image.description"}),children:(0,e.jsx)("div",{className:"insert-image",children:(0,e.jsxs)(K.Z,{gutter:[16,16],className:"image-list",children:[(W=s.bg_images)===null||W===void 0?void 0:W.map(function(l,a){var r;return(0,e.jsx)(D.Z,{span:4,children:(0,e.jsx)("div",{className:"image-item",children:(0,e.jsx)("div",{className:"inner",children:(0,e.jsxs)("div",{className:"link",children:[(0,e.jsx)(p.Z,{className:"img",preview:!0,src:(($==null||(r=$.system)===null||r===void 0?void 0:r.base_url)||"")+"/"+l}),(0,e.jsx)("span",{className:"close",onClick:function(){return xe(a)},children:(0,e.jsx)(v.FormattedMessage,{id:"setting.system.delete"})})]})})})},a)}),(0,e.jsx)(D.Z,{span:4,children:(0,e.jsx)("div",{className:"image-item",children:(0,e.jsx)("div",{className:"inner",children:(0,e.jsx)("div",{className:"link",children:(0,e.jsx)(M.Z,{name:"file",className:"logo-uploader",showUploadList:!1,accept:".jpg,.jpeg,.png,.gif,.webp,.bmp",customRequest:function(){var l=g()(o()().mark(function a(r){return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",te("bg_image",r));case 1:case"end":return i.stop()}},a)}));return function(a){return l.apply(this,arguments)}}(),children:(0,e.jsx)("div",{className:"ant-upload-item",children:(0,e.jsxs)("div",{className:"add",children:[(0,e.jsx)(Z.Z,{}),(0,e.jsx)("div",{style:{marginTop:8},children:(0,e.jsx)(v.FormattedMessage,{id:"plugin.titleimage.bg-image.upload"})})]})})})})})})})]})})}),(0,e.jsxs)(m.Z,{label:n.formatMessage({id:"plugin.titleimage.font"}),children:[(0,e.jsx)(M.Z,{name:"file",className:"logo-uploader",showUploadList:!1,accept:".ttf",customRequest:function(){var l=g()(o()().mark(function a(r){return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",te("font_path",r));case 1:case"end":return i.stop()}},a)}));return function(a){return l.apply(this,arguments)}}(),children:(0,e.jsx)(P.ZP,{children:(0,e.jsx)(v.FormattedMessage,{id:"plugin.titleimage.font.upload"})})}),s.font_path&&(0,e.jsxs)("div",{className:"upload-file",children:[(0,e.jsx)("span",{children:s.font_path}),(0,e.jsx)("a",{className:"delete",onClick:je,children:(0,e.jsx)(v.FormattedMessage,{id:"setting.system.delete"})})]})]})]}),(0,e.jsx)("p",{children:(0,e.jsx)("br",{})})]})}),(0,e.jsxs)(D.Z,{span:12,children:[(0,e.jsx)("div",{className:"preview-text",children:(0,e.jsx)(P.ZP,{onClick:function(){G(!0)},children:(0,e.jsx)(v.FormattedMessage,{id:"plugin.titleimage.preview.text.edit"})})}),(0,e.jsx)("img",{className:"preview",src:ge})]})]})},ce),V&&(0,e.jsx)(R.Y,{title:n.formatMessage({id:"plugin.titleimage.preview.text"}),open:V,modalProps:{onCancel:function(){return G(!1)}},onFinish:Ce,children:(0,e.jsx)(m.Z,{name:"text"})})]})},ne=ae}}]);
