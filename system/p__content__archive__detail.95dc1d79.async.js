"use strict";(self.webpackChunkAnQiCMS=self.webpackChunkAnQiCMS||[]).push([[3640],{56534:function(pe,ee,r){var R=r(18201),O=r(66342),Q=r(59831),k=r(37697),X=r(75271),f=r(73428),B=r(31945),y=r(52676),J=["options","fieldProps","proFieldProps","valueEnum"],M=X.forwardRef(function(u,W){var $=u.options,ne=u.fieldProps,ie=u.proFieldProps,re=u.valueEnum,p=(0,O.Z)(u,J);return(0,y.jsx)(B.Z,(0,R.Z)({ref:W,valueType:"checkbox",valueEnum:(0,Q.h)(re,void 0),fieldProps:(0,R.Z)({options:$},ne),lightProps:(0,R.Z)({labelFormatter:function(){return(0,y.jsx)(B.Z,(0,R.Z)({ref:W,valueType:"checkbox",mode:"read",valueEnum:(0,Q.h)(re,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,R.Z)({options:$},ne),proFieldProps:ie},p))}},p.lightProps),proFieldProps:ie},p))}),se=X.forwardRef(function(u,W){var $=u.fieldProps,ne=u.children;return(0,y.jsx)(k.Z,(0,R.Z)((0,R.Z)({ref:W},$),{},{children:ne}))}),te=(0,f.G)(se,{valuePropName:"checked"}),D=te;D.Group=M,ee.Z=D},6289:function(pe,ee,r){var R=r(18201),O=r(66342),Q=r(75271),k=r(38465),X=r(31945),f=r(52676),B=["fieldProps","proFieldProps"],y="dateTime",J=Q.forwardRef(function(M,se){var te=M.fieldProps,D=M.proFieldProps,u=(0,O.Z)(M,B),W=(0,Q.useContext)(k.Z);return(0,f.jsx)(X.Z,(0,R.Z)({ref:se,fieldProps:(0,R.Z)({getPopupContainer:W.getPopupContainer},te),valueType:y,proFieldProps:D,filedConfig:{valueType:y,customLightMode:!0}},u))});ee.Z=J},71384:function(pe,ee,r){var R=r(18201),O=r(66342),Q=r(75271),k=r(31945),X=r(52676),f=["fieldProps","min","proFieldProps","max"],B=function(M,se){var te=M.fieldProps,D=M.min,u=M.proFieldProps,W=M.max,$=(0,O.Z)(M,f);return(0,X.jsx)(k.Z,(0,R.Z)({valueType:"digit",fieldProps:(0,R.Z)({min:D,max:W},te),ref:se,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:u},$))},y=Q.forwardRef(B);ee.Z=y},85606:function(pe,ee,r){var R=r(48305),O=r.n(R),Q=r(75304),k=r(22683),X=r(96570),f=r(75271),B=r(52676),y=function(M){var se=(0,f.useState)(void 0),te=O()(se,2),D=te[0],u=te[1],W=(0,f.useState)(""),$=O()(W,2),ne=$[0],ie=$[1],re=function(){(0,Q.roP)({type:"multi"}).then(function(z){var A=(z.data||[]).map(function(j){return{key:j.id,tab:j.name,is_main:j.is_main}});u(A);var C=(0,k.KJ)("sub-site-id");!C&&A.length>0&&(C=A[0].key+"");var G=A.find(function(j){return j.key===Number(C)}),m=!1;G&&(m=!0,G.is_main&&(m=!1)),(0,k.Xq)("is-sub-site",m),ie(C)})};(0,f.useEffect)(function(){re()},[]);var p=function(z){var A;ie(z),(0,k.Xq)("sub-site-id",z);var C=D.find(function(m){return m.key===Number(z)}),G=!0;C.is_main&&(G=!1),(0,k.Xq)("is-sub-site",G),(A=M.onTabChange)===null||A===void 0||A.call(M,z,G)};return(0,B.jsx)(X._z,{tabList:D,tabActiveKey:ne,onTabChange:p,title:M.title,children:M.children})};ee.Z=y},17361:function(pe,ee,r){var R=r(48305),O=r.n(R),Q=r(54203),k=r(75271),X=r(99944),f=r(76979),B=r(52676),y=function(M){var se=(0,k.useState)(!1),te=O()(se,2),D=te[0],u=te[1],W=(0,k.useState)([]),$=O()(W,2),ne=$[0],ie=$[1],re=function(A){if(M.manual){var C;(C=M.onCancel)===null||C===void 0||C.call(M,A)}else u(A)},p=function(A){M.multiple?ie(A):(M.onSelect(A),re(!1))},ue=function(){M.multiple&&M.onSelect(ne),re(!1)};return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("div",{style:{display:"inline-block"},onClick:function(){re(!D)},children:M.children}),(0,B.jsx)(Q.Z,{className:"material-modal",width:800,open:M.manual?M.open:D,onCancel:function(){re(!1)},onOk:function(){ue()},children:(0,B.jsx)(X.Z,{multiple:M.multiple,onSelect:function(A){p(A)}})})]})};ee.Z=y},19830:function(pe,ee,r){r.d(ee,{Z:function(){return se}});var R=r(82092),O=r.n(R),Q=r(48305),k=r.n(Q),X=r(75271),f=r(82187),B=r.n(f),y=r(27806),J=r(52676),M=function(D){var u=(0,X.useState)(!1),W=k()(u,2),$=W[0],ne=W[1];(0,X.useEffect)(function(){ne(D.open||!1)},[]);var ie=function(){ne(!$)},re=B()(O()(O()({},"collaspe-item",!0),"collaspe-item-active",$),D.className);return(0,J.jsxs)("div",{className:re,style:D.style,children:[(0,J.jsxs)("div",{className:"collaspe-header",onClick:ie,children:[D.showArrow&&(0,J.jsx)(y.Z,{className:"collaspe-icon"}),(0,J.jsx)("div",{className:"collaspe-header-text",children:D.header}),D.extra&&(0,J.jsx)("div",{className:"collaspe-extra",children:D.extra})]}),(0,J.jsx)("div",{className:"collaspe-content",children:D.children})]})},se=M},60983:function(pe,ee,r){r.d(ee,{Z:function(){return re}});var R=r(90228),O=r.n(R),Q=r(87999),k=r.n(Q),X=r(75304),f=r(92204),B=r(75308),y=r(14076),J=r(37912),M=r(34206),se=r(5729),te=r(52577),D=r(75271),u=r(39651),W=r(52676);function $(){return{actions:[{title:"\u5A92\u4F53\u5E93",icon:'<svg t="1695784255158" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4033" width="16" height="16"><path d="M416 266.538667m-96 0a96 96 0 1 0 192 0 96 96 0 1 0-192 0Z" p-id="4034" fill="#010000"></path><path d="M721.749333 371.626667A43.818667 43.818667 0 0 0 682.666667 348.074667a42.965333 42.965333 0 0 0-38.058667 25.002666l-66.474667 146.517334a10.624 10.624 0 0 1-18.005333 2.261333l-34.986667-43.690667a42.666667 42.666667 0 0 0-34.688-16.042666 42.965333 42.965333 0 0 0-33.578666 18.176L323.84 670.293333a21.333333 21.333333 0 0 0 17.493333 33.706667h512a21.333333 21.333333 0 0 0 18.133334-10.112 21.333333 21.333333 0 0 0 0.938666-20.736z" p-id="4035" fill="#010000"></path><path d="M938.666667 0H234.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v704a85.333333 85.333333 0 0 0 85.333334 85.333334H938.666667a85.333333 85.333333 0 0 0 85.333333-85.333334V85.333333a85.333333 85.333333 0 0 0-85.333333-85.333333z m-6.186667 783.104a21.333333 21.333333 0 0 1-15.104 6.229333H256a21.333333 21.333333 0 0 1-21.333333-21.333333V106.666667A21.333333 21.333333 0 0 1 256 85.333333h661.333333a21.333333 21.333333 0 0 1 21.333334 21.333334V768a21.333333 21.333333 0 0 1-6.186667 14.976z" p-id="4036" fill="#010000"></path><path d="M832 938.666667h-725.333333a21.333333 21.333333 0 0 1-21.333334-21.333334v-725.333333a42.666667 42.666667 0 0 0-85.333333 0V938.666667a85.333333 85.333333 0 0 0 85.333333 85.333333h746.666667a42.666667 42.666667 0 0 0 0-85.333333z" p-id="4037" fill="#010000"></path></svg>',handler:{type:"action",click:function(ue){var z=ue.appendBlock,A=ue.editor,C=function(m){return m.is_image||m.file_location.indexOf(".webp")!==-1||m.file_location.indexOf(".bmp")!==-1||m.file_location.indexOf(".png")!==-1||m.file_location.indexOf(".gif")!==-1||m.file_location.indexOf(".jpg")!==-1||m.file_location.indexOf(".jpeg")!==-1||m.file_location.indexOf(".svg")!==-1?"![".concat(m.file_name,"](").concat(m.logo,")"):m.file_location.indexOf(".mp4")!==-1||m.file_location.indexOf(".ogg")!==-1||m.file_location.indexOf(".webm")!==-1?'<video controls="controls" controlslist="nodownload" poster=""><source src="'.concat(m.logo,'" type="video/').concat(m.file_location.substr(m.file_location.lastIndexOf(".")+1),'">\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301 video \u6807\u7B7E\u3002</video>'):m.file_location.indexOf(".mp3")!==-1||m.file_location.indexOf(".wav")!==-1?'<audio src="'.concat(m.logo,'" controls="controls"><source src="').concat(m.logo,'" type="audio/').concat(m.file_location.substr(m.file_location.lastIndexOf(".")+1),'">\u4F60\u7684\u7F16\u8F91\u5668\u4E0D\u652F\u6301 audio \u6807\u7B7E</audio>'):"[".concat(m.file_name,"](").concat(m.logo,")")};u.Z.show(!0).then(function(G){var m=[];for(var j in G)G.hasOwnProperty(j)&&m.push(C(G[j]));z(m.join(`
`)),A.focus()}),A.focus()}}}]}}var ne=[(0,f.Z)(),(0,B.Z)(),(0,y.Z)(),$()],ie=(0,D.forwardRef)(function(p,ue){function z(){}(0,D.useImperativeHandle)(ue,function(){return{setInnerContent:z}});var A=function(){var C=k()(O()().mark(function G(m){var j,ce,V,ge,le;return O()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:j=[],ce=M.ZP.loading("\u63D2\u5165\u4E2D...",0),F.t0=O()().keys(m);case 3:if((F.t1=F.t0()).done){F.next=14;break}if(V=F.t1.value,!m.hasOwnProperty(V)){F.next=12;break}return ge=new FormData,ge.append("file",m[V]),F.next=10,(0,X.pD2)(ge);case 10:le=F.sent,le.code!==0?M.ZP.info(le.msg):j.push({url:le.data.logo});case 12:F.next=3;break;case 14:return ce(),F.abrupt("return",j);case 16:case"end":return F.stop()}},G)}));return function(m){return C.apply(this,arguments)}}();return(0,W.jsx)("div",{className:"editor-container "+p.className,style:{border:"1px solid #ccc",marginTop:"10px"},children:(0,W.jsx)(J.M,{value:p.content,plugins:ne,locale:te,onChange:function(G){p.setContent(G)},uploadImages:A})})}),re=ie},51124:function(pe,ee,r){r.r(ee),r.d(ee,{default:function(){return rt}});var R=r(335),O=r.n(R),Q=r(31759),k=r.n(Q),X=r(90228),f=r.n(X),B=r(87999),y=r.n(B),J=r(25298),M=r.n(J),se=r(17069),te=r.n(se),D=r(62657),u=r.n(D),W=r(21742),$=r.n(W),ne=r(83136),ie=r.n(ne),re=r(82092),p=r.n(re),ue=r(85606),z=r(48305),A=r.n(z),C=r(75304),G=r(74133),m=r(96640),j=r(32064),ce=r(54203),V=r(34206),ge=r(53745),le=r(47634),Re=r(9921),F=r(75271),e=r(52676),be=null,Ve=function(H){var fe=(0,F.useState)({}),t=A()(fe,2),h=t[0],Y=t[1],w=(0,F.useState)(""),i=A()(w,2),a=i[0],n=i[1],o=(0,F.useState)(""),l=A()(o,2),c=l[0],g=l[1],v=(0,F.useState)(""),d=A()(v,2),S=d[0],b=d[1],P=(0,F.useState)(!1),_=A()(P,2),he=_[0],K=_[1],De=(0,F.useState)(!1),s=A()(De,2),x=s[0],Z=s[1],E=(0,j.useIntl)(),N="";(0,F.useEffect)(function(){return(0,C.Tn6)().then(function(T){Y(T.data||{})}),n(H.title||""),function(){clearInterval(be)}},[]);var L=function(I){n(I.target.value)},Ce=function(I){g(I.target.value)},Pe=function(){ce.Z.confirm({title:E.formatMessage({id:"component.aigenerate.submit.title"}),content:E.formatMessage({id:"component.aigenerate.submit.content"}),onOk:function(){H.onSubmit({title:a,content:S})}})},me=function(){if(!x){if(a.length<2){V.ZP.error(E.formatMessage({id:"component.aigenerate.title.required"}));return}Z(!0),(0,C.rGC)({title:a,demand:c}).then(function(I){if(!I||I.code!==0){V.ZP.error((I==null?void 0:I.msg)||E.formatMessage({id:"component.aigenerate.error"}));return}n(I.data.title),b(I.data.content),K(!0)}).catch(function(){}).finally(function(){Z(!1)})}},oe=function(I){(0,C.pvK)({stream_id:I}).then(function(U){if(U.code!==0){Z(!1),clearInterval(be),ce.Z.error({title:U.msg});return}K(!0),U.data&&(!N&&H.editor!=="markdown"&&(N+="<p>"),H.editor==="markdown"?N+=U.data:N+=U.data.replace(/\n+/g,`</p>
<p>`),b(N)),U.msg==="finished"&&(N&&H.editor!=="markdown"&&(N+="</p>",b(N)),Z(!1),clearInterval(be))})},de=function(){if(!x){if(a.length<2){V.ZP.error(E.formatMessage({id:"component.aigenerate.title.required"}));return}Z(!0),(0,C._ZU)({title:a,demand:c}).then(function(){var I=y()(f()().mark(function U(ye){var q;return f()().wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:if(ye.code===0){Se.next=4;break}return Z(!1),V.ZP.error(ye.msg),Se.abrupt("return");case 4:N="",q=ye.data,be=setInterval(function(){oe(q)},1e3);case 7:case"end":return Se.stop()}},U)}));return function(U){return I.apply(this,arguments)}}()).catch(function(){}).finally(function(){})}};return(0,e.jsx)(ce.Z,{width:800,title:(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{children:(0,e.jsx)(j.FormattedMessage,{id:"component.aigenerate.name"})}),(0,e.jsxs)("div",{className:"extra-text",children:[(0,e.jsx)(j.FormattedMessage,{id:"component.aigenerate.remain"})," ",(0,e.jsx)("span",{className:"text-primary",children:h.ai_remain})," ",(0,e.jsx)(j.FormattedMessage,{id:"component.aigenerate.remain.suffix"})]})]}),open:H.open,onCancel:function(){H.onCancel()},footer:null,children:(0,e.jsxs)(G.A,{layout:"horizontal",submitter:!1,children:[(0,e.jsx)(m.Z,{label:E.formatMessage({id:"component.aigenerate.title"}),name:"title",placeholder:E.formatMessage({id:"component.aigenerate.title.placeholder"}),fieldProps:{value:a,onChange:L}}),(0,e.jsx)(m.Z,{label:E.formatMessage({id:"component.aigenerate.demand"}),name:"demand",placeholder:E.formatMessage({id:"component.aigenerate.demand.placeholder"}),fieldProps:{maxLength:150,value:c,onChange:Ce}}),(0,e.jsx)("div",{className:"generate-btn mb-normal",children:(0,e.jsxs)(ge.Z,{size:20,children:[(0,e.jsx)(le.ZP,{onClick:de,loading:x,disabled:he,children:(0,e.jsx)(j.FormattedMessage,{id:"component.aigenerate.btn.start-generate"})}),(0,e.jsx)(le.ZP,{onClick:me,loading:x,disabled:he,children:(0,e.jsx)(j.FormattedMessage,{id:"component.aigenerate.btn.start-combine"})}),he&&(0,e.jsx)(le.ZP,{onClick:Pe,loading:x,children:(0,e.jsx)(j.FormattedMessage,{id:"component.aigenerate.btn.finish"})})]})}),(0,e.jsx)(Re.Z,{}),(0,e.jsx)("div",{className:"article-detail",dangerouslySetInnerHTML:{__html:S?H.editor==="markdown"?S.replace(/\n+/g,`</p>
<p>`):S:E.formatMessage({id:"component.aigenerate.content.default"})}})]})})},$e=Ve,ze=r(26068),we=r.n(ze),xe=r(41265),ke=r(18640),Ge=function(H){var fe=(0,F.useState)([]),t=A()(fe,2),h=t[0],Y=t[1],w=(0,j.useIntl)(),i=[{title:"ID",dataIndex:"id",hideInSearch:!0,sorter:!0},{title:w.formatMessage({id:"content.title.name"}),dataIndex:"title",render:function(n,o){return(0,e.jsx)("div",{style:{maxWidth:400},children:(0,e.jsx)("a",{href:o.link,target:"_blank",rel:"noopener noreferrer",children:n})})}},{title:w.formatMessage({id:"content.category.name"}),dataIndex:"category_titles",render:function(n,o){var l;return(0,e.jsx)("div",{children:(l=o.category_titles)===null||l===void 0?void 0:l.map(function(c){return(0,e.jsx)("div",{children:c},c)})})},renderFormItem:function(n,o){var l=o.fieldProps;return(0,e.jsx)(xe.Z,{name:"category_id",request:y()(f()().mark(function c(){var g,v;return f()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,(0,C.CPB)({type:1});case 2:return g=S.sent,v=[{spacer:"",title:w.formatMessage({id:"content.category.all"}),id:0,status:1}].concat(g.data||[]).map(function(b){return{spacer:b.spacer,label:b.title+(b.status===1?"":w.formatMessage({id:"setting.nav.hide"})),value:b.id}}),S.abrupt("return",v);case 5:case"end":return S.stop()}},c)})),fieldProps:we()(we()({},l),{},{optionItemRender:function(g){return(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:g.spacer+g.label}})}})})}}];return(0,e.jsx)(ce.Z,{width:1e3,title:w.formatMessage({id:"component.archive.select"}),open:H.open,onCancel:function(){H.onCancel()},onOk:function(){H.onSubmit(h)},children:(0,e.jsx)(ke.Z,{rowKey:"id",search:{span:{xs:24,sm:8,md:8,lg:8,xl:8,xxl:8},defaultCollapsed:!1},toolBarRender:!1,tableAlertRender:!1,tableAlertOptionRender:!1,request:function(n){return n.status="ok",(0,C.Lig)(n)},columnsState:{persistenceKey:"archive-search-table",persistenceType:"localStorage"},columns:i,rowSelection:{onChange:function(n,o){Y(o)}},pagination:{defaultPageSize:10,showSizeChanger:!0}})})},He=Ge,Ze=r(17361),Ke=r(19830),Ne=r(30141),Qe=r(45151),Xe=function(H){var fe=(0,F.useState)([]),t=A()(fe,2),h=t[0],Y=t[1],w=(0,j.useIntl)(),i=[{title:w.formatMessage({id:"component.keywords.title"}),dataIndex:"title"}];return(0,e.jsx)(ce.Z,{width:600,title:w.formatMessage({id:"component.keywords.select"}),open:H.open,onCancel:function(){H.onCancel()},onOk:function(){H.onSubmit(h)},children:(0,e.jsx)(ke.Z,{rowKey:"title",search:{span:12,labelWidth:120},toolBarRender:!1,tableAlertRender:!1,tableAlertOptionRender:!1,request:function(n){return(0,Qe.eG)(n)},columnsState:{persistenceKey:"keywords-table",persistenceType:"localStorage"},columns:i,rowSelection:{onChange:function(n){Y(n)}},pagination:{defaultPageSize:10,showSizeChanger:!0}})})},Je=Xe,Le=r(60983),Ye=r(1545),je=r(22683),Ee=r(86743),Fe=r(16621),_e=r(14258),Ue=r(56534),Be=r(66857),Te=r(71384),qe=r(76334),et=r(6289),ve=r(91827),Ae=r(59124),ae=r(48806),Ie=r(43330),tt=r(21261),at=r(16483),We=r.n(at),st=r(38308),nt=function(Oe){$()(fe,Oe);var H=ie()(fe);function fe(){var t;M()(this,fe);for(var h=arguments.length,Y=new Array(h),w=0;w<h;w++)Y[w]=arguments[w];return t=H.call.apply(H,[this].concat(Y)),p()(u()(t),"state",{fetched:!1,archive:{extra:{},content:"",flag:[]},relations:[],extraContent:{},content:"",modules:[],module:{fields:[]},contentSetting:{},archiveSearchVisible:!1,keywordsVisible:!1,searchedTags:[],searchArchives:[{id:0,title:t.props.intl.formatMessage({id:"content.parent_id.empty"})}],parentArchive:{},aiVisible:!1,aiTitle:"",newKey:""}),p()(u()(t),"submitted",!1),p()(u()(t),"defaultContent",""),p()(u()(t),"formRef",F.createRef()),p()(u()(t),"editorRef",F.createRef()),p()(u()(t),"initArchive",y()(f()().mark(function i(){var a,n;return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,(0,C.Zyq)();case 3:a=l.sent,t.setState({contentSetting:a.data||{}}),l.next=11;break;case 7:return l.prev=7,l.t0=l.catch(0),V.ZP.error(t.props.intl.formatMessage({id:"content.networt.error"})),l.abrupt("return");case 11:return l.next=13,(0,C.hUj)();case 13:n=l.sent,t.setState({modules:n.data||[]},function(){var c=new URLSearchParams(window.location.search),g=c.get("module_id")||1,v=Number(c.get("category_id")||0),d=Number(c.get("copyid")||0),S=(0,je.bh)("last_category_id")||0;v===0&&S>0&&(v=S);var b=c.get("id")||0;if(b==="new"&&(b=0),b>0)t.getArchive(Number(b));else if(d>0)t.getArchive(Number(d),!0);else{var P=(0,je.bh)("unsaveArchive");if(P){var _;console.log("load store"),v=P.category_id,((_=P.category_ids)===null||_===void 0?void 0:_.length)>0&&(v=P.category_ids[0]),t.getParentArchive(P.parent_id||0),t.setState({archive:P})}else t.setState({archive:{extra:{},content:"",flag:[],category_ids:[v]}});t.defaultContent=(P==null?void 0:P.content)||"",t.setState({fetched:!0,content:(P==null?void 0:P.content)||""})}v>0?t.getArchiveCategory(Number(v)):t.getModule(Number(g))});case 15:case"end":return l.stop()}},i,null,[[0,7]])}))),p()(u()(t),"componentDidMount",y()(f()().mark(function i(){return f()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.initArchive(),window.addEventListener("beforeunload",t.beforeunload);case 2:case"end":return n.stop()}},i)}))),p()(u()(t),"onTabChange",function(i){t.setState({fetched:!1}),t.initArchive().then(function(){t.setState({newKey:i})})}),p()(u()(t),"beforeunload",function(i){var a=t.state.archive;if(!a.id&&!t.submitted){var n,o;console.log("save-store");var l=(n=t.formRef.current)===null||n===void 0||(o=n.getFieldsFormatValue)===null||o===void 0?void 0:o.call(n);a.content=t.state.content,a=Object.assign(a,l),k()(a.flag)==="object"&&(a.flag=a.flag.join(",")),(0,je.PQ)("unsaveArchive",a)}if(t.state.content!==""&&t.state.content!==t.defaultContent){var c=t.props.intl.formatMessage({id:"content.confirm-giveup"});return(i||window.event).returnValue=c,c}return null}),p()(u()(t),"getArchive",function(){var i=y()(f()().mark(function a(n,o){var l,c,g,v,d,S,b,P,_;return f()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.next=2,(0,C.CY9)({id:n});case 2:return g=K.sent,v=g.data||{extra:{},flag:null},o&&(v.id=0,v.parent_id=0,v.url_token="",v.created_time=0,v.updated_time=0),d=((l=v.data)===null||l===void 0?void 0:l.content)||"",v.flag=((c=v.flag)===null||c===void 0?void 0:c.split(","))||[],v.created_moment=We()(v.created_time*1e3),t.defaultContent=d,K.next=11,t.getModule(v.module_id);case 11:S=K.sent,b={};for(P in S.fields)S.fields[P].type==="editor"&&(b[S.fields[P].field_name]=((_=v.extra[S.fields[P].field_name])===null||_===void 0?void 0:_.value)||"");t.getParentArchive(v.parent_id||0),t.getArchiveCategory(v.category_id),t.setState({fetched:!0,archive:v,content:d,extraContent:b,relations:v.relations||[]});case 17:case"end":return K.stop()}},a)}));return function(a,n){return i.apply(this,arguments)}}()),p()(u()(t),"getParentArchive",function(i){i>0&&(0,C.CY9)({id:i}).then(function(a){var n;t.setState({parentArchive:a.data||{}}),(n=a.data)!==null&&n!==void 0&&n.id&&t.setState({searchArchives:[a.data]})})}),p()(u()(t),"getArchiveCategory",function(){var i=y()(f()().mark(function a(n){var o,l;return f()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,C.nNt)({id:n});case 2:o=g.sent,l=o.data||{},l.module_id&&t.getModule(l.module_id);case 5:case"end":return g.stop()}},a)}));return function(a){return i.apply(this,arguments)}}()),p()(u()(t),"onChangeSelectCategory",function(i){var a=0;if(typeof i=="number")a=Number(i);else for(var n in i)if(i[n]>0){a=i[n];break}(0,je.PQ)("last_category_id",a),t.getArchiveCategory(a)}),p()(u()(t),"getModule",function(){var i=y()(f()().mark(function a(n){var o,l,c,g;return f()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(t.state.module.id!==n){d.next=2;break}return d.abrupt("return",t.state.module);case 2:o={fields:[]},l=O()(t.state.modules),d.prev=4,l.s();case 6:if((c=l.n()).done){d.next=13;break}if(g=c.value,g.id!==n){d.next=11;break}return o=g,d.abrupt("break",13);case 11:d.next=6;break;case 13:d.next=18;break;case 15:d.prev=15,d.t0=d.catch(4),l.e(d.t0);case 18:return d.prev=18,l.f(),d.finish(18);case 21:return t.setState({module:o}),d.abrupt("return",o);case 23:case"end":return d.stop()}},a,null,[[4,15,18,21]])}));return function(a){return i.apply(this,arguments)}}()),p()(u()(t),"setContent",function(){var i=y()(f()().mark(function a(n){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:t.setState({content:n});case 1:case"end":return l.stop()}},a)}));return function(a){return i.apply(this,arguments)}}()),p()(u()(t),"setExtraContent",function(){var i=y()(f()().mark(function a(n,o){var l;return f()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:l=t.state.extraContent,l[n]=o,t.setState({extraContent:l});case 3:case"end":return g.stop()}},a)}));return function(a,n){return i.apply(this,arguments)}}()),p()(u()(t),"handleSelectImages",function(i){var a=t.state.archive;a.images||(a.images=[]);var n=O()(i),o;try{for(n.s();!(o=n.n()).done;){var l=o.value,c=!1;for(var g in a.images)if(a.images[g]===l.logo){c=!0;break}c||a.images.push(l.logo)}}catch(v){n.e(v)}finally{n.f()}t.setState({archive:a}),V.ZP.success(t.props.intl.formatMessage({id:"setting.system.upload-success"}))}),p()(u()(t),"handleCleanLogo",function(i,a){a.stopPropagation();var n=t.state.archive;(0,C.m$U)({id:n.id,image_index:i}).then(function(){n.logo="",n.images.splice(i,1),t.setState({archive:n})}).catch(function(){})}),p()(u()(t),"handleExtractDescription",function(){if(t.state.content.length<100)return V.ZP.error(t.props.intl.formatMessage({id:"content.archive.content.length.error"})),!1;ce.Z.confirm({title:t.props.intl.formatMessage({id:"content.archive.extract.description"}),content:t.props.intl.formatMessage({id:"content.archive.extract.description.content"}),onOk:function(){(0,C.f2F)({text:t.state.content}).then(function(a){if(a.code===0){var n;(n=t.formRef)===null||n===void 0||(n=n.current)===null||n===void 0||n.setFieldsValue({description:a.data})}else V.ZP.info(a.msg)}).catch(function(a){V.ZP.error(a.msg||t.props.intl.formatMessage({id:"content.submit.failure"}))})}})}),p()(u()(t),"handleExtractKeywords",function(){if(t.state.content.length<100)return V.ZP.error(t.props.intl.formatMessage({id:"content.archive.content.length.error"})),!1;ce.Z.confirm({title:t.props.intl.formatMessage({id:"content.archive.extract.keywords"}),content:t.props.intl.formatMessage({id:"content.archive.extract.keywords.content"}),onOk:function(){(0,C.q6z)({text:t.state.content}).then(function(a){if(a.code===0){var n,o;(n=t.formRef)===null||n===void 0||(n=n.current)===null||n===void 0||n.setFieldsValue({keywords:(o=a.data)===null||o===void 0?void 0:o.join(",")})}else V.ZP.info(a.msg)}).catch(function(a){V.ZP.error(a.msg||t.props.intl.formatMessage({id:"content.submit.failure"}))})}})}),p()(u()(t),"handleChooseKeywords",function(){t.setState({keywordsVisible:!0})}),p()(u()(t),"handleHideKeywords",function(){t.setState({keywordsVisible:!1})}),p()(u()(t),"handleShowArchiveSearchs",function(){t.setState({archiveSearchVisible:!0})}),p()(u()(t),"handleHideArchiveSearchs",function(){t.setState({archiveSearchVisible:!1})}),p()(u()(t),"handleSelectedArchives",function(){var i=y()(f()().mark(function a(n){var o,l,c,g;return f()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:o=t.state.relations,d.t0=f()().keys(n);case 2:if((d.t1=d.t0()).done){d.next=16;break}l=d.t1.value,c=!1,d.t2=f()().keys(o);case 6:if((d.t3=d.t2()).done){d.next=13;break}if(g=d.t3.value,o[g].id!==n[l].id){d.next=11;break}return c=!0,d.abrupt("break",13);case 11:d.next=6;break;case 13:c||o.push(n[l]),d.next=2;break;case 16:t.setState({relations:o}),t.handleHideArchiveSearchs();case 18:case"end":return d.stop()}},a)}));return function(a){return i.apply(this,arguments)}}()),p()(u()(t),"handleRemoveRelation",function(i){var a=t.state.relations;a.splice(i,1),t.setState({relations:a})}),p()(u()(t),"handleSelectedKeywords",function(){var i=y()(f()().mark(function a(n){var o,l,c,g,v,d;return f()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:c=(((o=t.formRef)===null||o===void 0||(o=o.current)===null||o===void 0?void 0:o.getFieldValue("keywords"))||"").split(","),g=O()(n);try{for(g.s();!(v=g.n()).done;)d=v.value,c.indexOf(d)===-1&&c.push(d)}catch(P){g.e(P)}finally{g.f()}(l=t.formRef)===null||l===void 0||(l=l.current)===null||l===void 0||l.setFieldsValue({keywords:c.join(",").replace(/^,+/,"").replace(/,+$/,"")}),t.handleHideKeywords();case 5:case"end":return b.stop()}},a)}));return function(a){return i.apply(this,arguments)}}()),p()(u()(t),"onChangeTagInput",function(i){var a,n=((a=i.target)===null||a===void 0?void 0:a.value)||"";(0,Ye.NJ)({type:1,title:n,pageSize:10}).then(function(o){var l=o.data||[],c={},g=O()(l),v;try{for(g.s();!(v=g.n()).done;){var d=v.value;c[d.title]=d.title}}catch(S){g.e(S)}finally{g.f()}t.setState({searchedTags:c})})}),p()(u()(t),"onSubmit",function(){var i=y()(f()().mark(function a(n){var o,l,c,g,v,d,S,b,P,_,he,K;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:o=t.state,l=o.archive,c=o.content,g=o.extraContent,v=o.relations,d=Object.assign(l,n),d.relation_ids=v.map(function(x){return x.id}),delete d.relations,d.price=Number(n.price),d.stock=Number(n.stock);for(S in g)d.extra[S]||(d.extra[S]={}),d.extra[S].value=g[S];if(b=[],P=0,typeof n.category_ids=="number")P=Number(n.category_ids);else{for(_ in n.category_ids)n.category_ids[_]>0&&b.push(n.category_ids[_]);b.length>0&&(P=b[0])}if(P!==0){s.next=13;break}return V.ZP.error(t.props.intl.formatMessage({id:"content.category.required"})),s.abrupt("return");case 13:return d.category_id=P,d.category_ids=b,he=V.ZP.loading(t.props.intl.formatMessage({id:"setting.system.submitting"}),0),d.content=c,k()(d.flag)==="object"&&(d.flag=d.flag.join(",")),s.next=20,(0,C.uf6)(d);case 20:if(K=s.sent,he(),K.code===0){s.next=29;break}if(!(K.data&&K.data.id)){s.next=26;break}return ce.Z.confirm({title:K.msg,content:t.props.intl.formatMessage({id:"content.submit.confirm"}),cancelText:t.props.intl.formatMessage({id:"content.submit.cancel"}),okText:t.props.intl.formatMessage({id:"content.submit.ok-force"}),onOk:function(){n.force_save=!0,t.onSubmit(n)}}),s.abrupt("return");case 26:V.ZP.error(K.msg),s.next=34;break;case 29:(0,je.PQ)("latest_update",{id:K.data.id,timestamp:new Date().getTime()/1e3}),(0,je.kr)("unsaveArchive"),t.submitted=!0,V.ZP.success(K.msg),j.history.back();case 34:case"end":return s.stop()}},a)}));return function(a){return i.apply(this,arguments)}}()),p()(u()(t),"handleCleanExtraField",function(i){var a,n={};n[i]={value:""},(a=t.formRef)===null||a===void 0||(a=a.current)===null||a===void 0||a.setFieldsValue({extra:n});var o=t.state.archive;delete o.extra[i],t.setState({archive:o})}),p()(u()(t),"handleUploadExtraField",function(i,a){var n,o={};o[i]={value:a.logo},(n=t.formRef)===null||n===void 0||(n=n.current)===null||n===void 0||n.setFieldsValue({extra:o});var l=t.state.archive;l.extra[i]||(l.extra[i]={}),l.extra[i].value=a.logo,t.setState({archive:l})}),p()(u()(t),"handleCleanExtraFieldItem",function(i,a){var n,o,l=t.state.archive;(n=l.extra[i].value)===null||n===void 0||n.splice(a,1);var c={};c[i]={value:l.extra[i].value},(o=t.formRef)===null||o===void 0||(o=o.current)===null||o===void 0||o.setFieldsValue({extra:c}),t.setState({archive:l})}),p()(u()(t),"handleUploadExtraFieldItem",function(i,a){var n,o,l=t.state.archive;l.extra[i]||(l.extra[i]={value:[]}),(n=l.extra[i].value)!==null&&n!==void 0&&n.length||(l.extra[i].value=[]);var c=O()(a),g;try{for(c.s();!(g=c.n()).done;){var v=g.value,d=!1;for(var S in l.extra[i].value)if(l.extra[i].value[S]===v.logo){d=!0;break}d||l.extra[i].value.push(v.logo)}}catch(P){c.e(P)}finally{c.f()}var b={};b[i]={value:l.extra[i].value},(o=t.formRef)===null||o===void 0||(o=o.current)===null||o===void 0||o.setFieldsValue({extra:b}),t.setState({archive:l})}),p()(u()(t),"handleKeyDown",function(i){if(i.key==="s"&&(i.ctrlKey||i.metaKey)){var a,n,o=(a=t.formRef.current)===null||a===void 0||(n=a.getFieldsFormatValue)===null||n===void 0?void 0:n.call(a);t.onSubmit(o),i.preventDefault()}}),p()(u()(t),"aiGenerateArticle",function(){var i,a,n=((i=t.formRef.current)===null||i===void 0||(a=i.getFieldsFormatValue)===null||a===void 0?void 0:a.call(i))||{};t.setState({aiTitle:n.title,aiVisible:!0})}),p()(u()(t),"onHideAiGenerate",function(){t.setState({aiVisible:!1})}),p()(u()(t),"onFinishAiGenerate",function(){var i=y()(f()().mark(function a(n){var o,l,c;return f()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:t.onHideAiGenerate(),(o=t.formRef.current)===null||o===void 0||o.setFieldsValue({title:n.title}),c=n.content.trim(),t.setContent(c),(l=t.editorRef.current)===null||l===void 0||l.setInnerContent(c);case 5:case"end":return v.stop()}},a)}));return function(a){return i.apply(this,arguments)}}()),p()(u()(t),"onSearchArchives",function(i){(0,C.Lig)({title:i,pageSize:10}).then(function(a){var n=[];t.state.parentArchive.id?n.push(t.state.parentArchive):n.push({id:0,title:t.props.intl.formatMessage({id:"content.parent_id.empty"})}),t.setState({searchArchives:n.concat(a.data||[])})})}),t}return te()(fe,[{key:"componentWillUnmount",value:function(){var h=this.state.archive;if(!h.id&&!this.submitted){var Y,w;console.log("save-store");var i=(Y=this.formRef.current)===null||Y===void 0||(w=Y.getFieldsFormatValue)===null||w===void 0?void 0:w.call(Y);h.content=this.state.content,h=Object.assign(h,i),k()(h.flag)==="object"&&(h.flag=h.flag.join(",")),(0,je.PQ)("unsaveArchive",h)}window.removeEventListener("beforeunload",this.beforeunload)}},{key:"render",value:function(){var h=this,Y,w,i,a=this.state,n=a.archive,o=a.content,l=a.extraContent,c=a.module,g=a.fetched,v=a.keywordsVisible,d=a.searchedTags,S=a.aiTitle,b=a.aiVisible,P=a.contentSetting,_=a.archiveSearchVisible,he=a.relations,K=a.searchArchives,De=a.newKey;return(0,e.jsxs)(ue.Z,{title:n.id>0?this.props.intl.formatMessage({id:"content.archive.edit"}):this.props.intl.formatMessage({id:"content.archive.add"}),onTabChange:function(x){return h.onTabChange(x)},children:[(0,e.jsx)(ve.Z,{onKeyDown:this.handleKeyDown,children:g&&(0,e.jsx)(G.A,{initialValues:n,layout:"horizontal",formRef:this.formRef,onFinish:this.onSubmit,children:(0,e.jsxs)(Ae.Z,{gutter:20,children:[(0,e.jsxs)(ae.Z,{sm:18,xs:24,children:[(0,e.jsx)(m.Z,{name:"title",label:c.title_name||this.props.intl.formatMessage({id:"content.title.name"})}),(0,e.jsx)(Ue.Z.Group,{name:"flag",label:this.props.intl.formatMessage({id:"content.flag.name"}),valueEnum:{h:this.props.intl.formatMessage({id:"content.flag.h"}),c:this.props.intl.formatMessage({id:"content.flag.c"}),f:this.props.intl.formatMessage({id:"content.flag.f"}),a:this.props.intl.formatMessage({id:"content.flag.a"}),s:this.props.intl.formatMessage({id:"content.flag.s"}),b:this.props.intl.formatMessage({id:"content.flag.b"}),p:this.props.intl.formatMessage({id:"content.flag.p"}),j:this.props.intl.formatMessage({id:"content.flag.j"})}}),(0,e.jsx)(m.Z,{name:"keywords",label:this.props.intl.formatMessage({id:"content.keywords.name"}),fieldProps:{suffix:(0,e.jsxs)(ge.Z,{size:16,children:[(0,e.jsx)("span",{className:"link",onClick:this.handleExtractKeywords,children:(0,e.jsx)(j.FormattedMessage,{id:"content.keywords.extract"})}),(0,e.jsx)("span",{className:"link",onClick:this.handleChooseKeywords,children:(0,e.jsx)(j.FormattedMessage,{id:"content.keywords.select"})})]})}}),(0,e.jsx)(Be.Z,{name:"description",label:this.props.intl.formatMessage({id:"content.description.name"}),extra:(0,e.jsx)(ge.Z,{size:16,children:(0,e.jsx)("span",{className:"link extract-tag",onClick:this.handleExtractDescription,children:(0,e.jsx)(j.FormattedMessage,{id:"content.description.extract"})})})}),(0,e.jsx)(Ke.Z,{header:this.props.intl.formatMessage({id:"content.param.other"}),showArrow:!0,children:(0,e.jsxs)(Ae.Z,{gutter:20,children:[(0,e.jsx)(ae.Z,{sm:12,xs:24,children:(0,e.jsx)(m.Z,{label:this.props.intl.formatMessage({id:"content.origin-url.name"}),name:"origin_url",placeholder:this.props.intl.formatMessage({id:"content.field.default"}),extra:this.props.intl.formatMessage({id:"content.origin-url.description"})})}),(0,e.jsx)(ae.Z,{sm:12,xs:24,children:(0,e.jsx)(m.Z,{name:"seo_title",label:this.props.intl.formatMessage({id:"content.seo-title.name"}),placeholder:this.props.intl.formatMessage({id:"content.seo-title.placeholder"}),extra:this.props.intl.formatMessage({id:"content.seo-title.description"})})}),(0,e.jsx)(ae.Z,{sm:12,xs:24,children:(0,e.jsx)(m.Z,{name:"canonical_url",label:this.props.intl.formatMessage({id:"content.canonical-url.name"}),placeholder:this.props.intl.formatMessage({id:"content.canonical-url.placeholder"}),extra:this.props.intl.formatMessage({id:"content.canonical-url.description"})})}),(0,e.jsx)(ae.Z,{sm:12,xs:24,children:(0,e.jsx)(m.Z,{name:"fixed_link",label:this.props.intl.formatMessage({id:"content.fixed-link.name"}),placeholder:this.props.intl.formatMessage({id:"content.canonical-url.placeholder"}),extra:this.props.intl.formatMessage({id:"content.fixed-link.description"})})}),(0,e.jsx)(ae.Z,{sm:12,xs:24,children:(0,e.jsx)(xe.Z,{label:this.props.intl.formatMessage({id:"content.archive-template.name"}),showSearch:!0,name:"template",request:y()(f()().mark(function s(){var x,Z,E;return f()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,(0,C.h5q)({});case 2:x=L.sent,Z=[{path:"",remark:h.props.intl.formatMessage({id:"content.default-template"})}].concat(x.data||[]);for(E in Z)Z[E].remark?Z[E].remark=Z[E].path+"("+Z[E].remark+")":Z[E].remark=Z[E].path;return L.abrupt("return",Z);case 6:case"end":return L.stop()}},s)})),fieldProps:{fieldNames:{label:"remark",value:"path"}},extra:this.props.intl.formatMessage({id:"content.archive-template.description"})})}),(0,e.jsx)(ae.Z,{sm:12,xs:24,children:(0,e.jsx)(Te.Z,{label:this.props.intl.formatMessage({id:"content.price.name"}),name:"price",fieldProps:{precision:0,addonAfter:this.props.intl.formatMessage({id:"content.price.suffix"})},extra:this.props.intl.formatMessage({id:"content.papriceram.description"})})}),(0,e.jsx)(ae.Z,{sm:12,xs:24,children:(0,e.jsx)(Te.Z,{label:this.props.intl.formatMessage({id:"content.stock.name"}),name:"stock",fieldProps:{precision:0,addonAfter:this.props.intl.formatMessage({id:"content.stock.suffix"})}})}),(0,e.jsx)(ae.Z,{sm:12,xs:24,children:(0,e.jsx)(xe.Z,{name:"read_level",label:this.props.intl.formatMessage({id:"content.read-level.name"}),request:y()(f()().mark(function s(){var x;return f()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,C.jWl)({});case 2:return x=E.sent,E.abrupt("return",[{level:0,title:h.props.intl.formatMessage({id:"content.unlimit"}),id:0}].concat(x.data||[]));case 4:case"end":return E.stop()}},s)})),fieldProps:{fieldNames:{label:"title",value:"level"},optionItemRender:function(x){return(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:"L"+x.level+x.title}})}},extra:this.props.intl.formatMessage({id:"content.read-level.description"})})}),(0,e.jsx)(ae.Z,{sm:12,xs:24,children:(0,e.jsx)(m.Z,{name:"password",label:this.props.intl.formatMessage({id:"content.password.name"}),placeholder:this.props.intl.formatMessage({id:"content.password.placeholder"}),extra:this.props.intl.formatMessage({id:"content.password.description"})})})]})},"1"),c.fields&&(0,e.jsxs)(Ke.Z,{header:this.props.intl.formatMessage({id:"content.param.extra-fields"}),open:!0,showArrow:!0,children:[(0,e.jsx)(Ae.Z,{gutter:20,children:(Y=c.fields)===null||Y===void 0?void 0:Y.map(function(s,x){var Z,E,N,L,Ce,Pe;return s.type!=="editor"&&(0,e.jsx)(ae.Z,{sm:12,xs:24,children:s.type==="text"?(0,e.jsx)(m.Z,{name:["extra",s.field_name,"value"],label:s.name,required:!!s.required,placeholder:s.content&&h.props.intl.formatMessage({id:"content.param.default"})+s.content}):s.type==="number"?(0,e.jsx)(Te.Z,{name:["extra",s.field_name,"value"],label:s.name,required:!!s.required,placeholder:s.content&&h.props.intl.formatMessage({id:"content.param.default"})+s.content}):s.type==="textarea"?(0,e.jsx)(Be.Z,{name:["extra",s.field_name,"value"],label:s.name,required:!!s.required,placeholder:s.content&&h.props.intl.formatMessage({id:"content.param.default"})+s.content}):s.type==="editor"?"":s.type==="radio"?(0,e.jsx)(qe.Z.Group,{name:["extra",s.field_name,"value"],label:s.name,request:y()(f()().mark(function me(){var oe,de,T,I,U;return f()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:oe=s.content.split(`
`),de=[],T=O()(oe);try{for(T.s();!(I=T.n()).done;)U=I.value,de.push({label:U,value:U})}catch(Me){T.e(Me)}finally{T.f()}return q.abrupt("return",de);case 5:case"end":return q.stop()}},me)}))}):s.type==="checkbox"?(0,e.jsx)(Ue.Z.Group,{name:["extra",s.field_name,"value"],label:s.name,request:y()(f()().mark(function me(){var oe,de,T,I,U;return f()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:oe=s.content.split(`
`),de=[],T=O()(oe);try{for(T.s();!(I=T.n()).done;)U=I.value,de.push({label:U,value:U})}catch(Me){T.e(Me)}finally{T.f()}return q.abrupt("return",de);case 5:case"end":return q.stop()}},me)}))}):s.type==="select"?(0,e.jsx)(xe.Z,{name:["extra",s.field_name,"value"],label:s.name,request:y()(f()().mark(function me(){var oe,de,T,I,U;return f()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:oe=s.content.split(`
`),de=[],T=O()(oe);try{for(T.s();!(I=T.n()).done;)U=I.value,de.push({label:U,value:U})}catch(Me){T.e(Me)}finally{T.f()}return q.abrupt("return",de);case 5:case"end":return q.stop()}},me)}))}):s.type==="image"?(0,e.jsx)(m.Z,{name:["extra",s.field_name,"value"],label:s.name,children:(Z=n.extra[s.field_name])!==null&&Z!==void 0&&Z.value?(0,e.jsxs)("div",{className:"ant-upload-item",children:[(0,e.jsx)(Ie.Z,{preview:{src:(E=n.extra[s.field_name])===null||E===void 0?void 0:E.value},src:(N=n.extra[s.field_name])===null||N===void 0?void 0:N.value}),(0,e.jsx)("span",{className:"delete",onClick:h.handleCleanExtraField.bind(h,s.field_name),children:(0,e.jsx)(Ee.Z,{})})]}):(0,e.jsx)(Ze.Z,{onSelect:h.handleUploadExtraField.bind(h,s.field_name),open:!1,children:(0,e.jsx)("div",{className:"ant-upload-item",children:(0,e.jsxs)("div",{className:"add",children:[(0,e.jsx)(Fe.Z,{}),(0,e.jsx)("div",{style:{marginTop:8},children:(0,e.jsx)(j.FormattedMessage,{id:"setting.system.upload"})})]})})})}):s.type==="images"?(0,e.jsxs)(m.Z,{name:["extra",s.field_name,"value"],label:s.name,children:[(L=n.extra[s.field_name])!==null&&L!==void 0&&(L=L.value)!==null&&L!==void 0&&L.length?n.extra[s.field_name].value.map(function(me,oe){return(0,e.jsxs)("div",{className:"ant-upload-item",children:[(0,e.jsx)(Ie.Z,{preview:{src:me},src:me}),(0,e.jsx)("span",{className:"delete",onClick:h.handleCleanExtraFieldItem.bind(h,s.field_name,oe),children:(0,e.jsx)(Ee.Z,{})})]},oe)}):null,(0,e.jsx)(Ze.Z,{onSelect:h.handleUploadExtraFieldItem.bind(h,s.field_name),open:!1,multiple:!0,children:(0,e.jsx)("div",{className:"ant-upload-item",children:(0,e.jsxs)("div",{className:"add",children:[(0,e.jsx)(Fe.Z,{}),(0,e.jsx)("div",{style:{marginTop:8},children:(0,e.jsx)(j.FormattedMessage,{id:"setting.system.upload"})})]})})})]}):s.type==="file"?(0,e.jsx)(m.Z,{name:["extra",s.field_name,"value"],label:s.name,children:(Ce=n.extra[s.field_name])!==null&&Ce!==void 0&&Ce.value?(0,e.jsxs)("div",{className:"ant-upload-item ant-upload-file",children:[(0,e.jsx)("span",{children:(Pe=n.extra[s.field_name])===null||Pe===void 0?void 0:Pe.value}),(0,e.jsx)("span",{className:"delete",onClick:h.handleCleanExtraField.bind(h,s.field_name),children:(0,e.jsx)(Ee.Z,{})})]}):(0,e.jsx)(Ze.Z,{onSelect:h.handleUploadExtraField.bind(h,s.field_name),open:!1,children:(0,e.jsx)(le.ZP,{children:(0,e.jsx)(j.FormattedMessage,{id:"setting.system.upload"})})})}):""},x)})}),(w=c.fields)===null||w===void 0?void 0:w.map(function(s,x){return s.type==="editor"&&(0,e.jsx)(m.Z,{label:s.name,required:!!s.required,extra:s.content&&h.props.intl.formatMessage({id:"content.param.default"})+s.content,children:P.editor==="markdown"?(0,e.jsx)(Le.Z,{className:"mb-normal",setContent:h.setExtraContent.bind(h,s.field_name),content:l[s.field_name]||"",ref:null}):(0,e.jsx)(Ne.Z,{className:"mb-normal",setContent:h.setExtraContent.bind(h,s.field_name),content:l[s.field_name]||"",field:s.field_name,ref:null},s.field_name)},x)})]},"2"),P.editor==="markdown"?(0,e.jsx)(Le.Z,{className:"mb-normal",setContent:this.setContent,content:o,ref:this.editorRef}):(0,e.jsx)(Ne.Z,{className:"mb-normal",setContent:this.setContent,content:o,field:"content",ref:this.editorRef},"content")]}),(0,e.jsxs)(ae.Z,{sm:6,xs:24,children:[(0,e.jsx)("div",{className:"mb-normal",children:(0,e.jsxs)(Ae.Z,{gutter:[16,16],children:[(0,e.jsx)(ae.Z,{span:12,children:(0,e.jsx)(le.ZP,{block:!0,type:"primary",onClick:function(){var x,Z;h.onSubmit(((x=h.formRef.current)===null||x===void 0||(Z=x.getFieldsFormatValue)===null||Z===void 0?void 0:Z.call(x))||{})},children:(0,e.jsx)(j.FormattedMessage,{id:"content.submit.ok"})})}),(0,e.jsx)(ae.Z,{span:12,children:(0,e.jsx)(le.ZP,{block:!0,onClick:function(){var x,Z,E=((x=h.formRef.current)===null||x===void 0||(Z=x.getFieldsFormatValue)===null||Z===void 0?void 0:Z.call(x))||{};E.draft=!0,h.onSubmit(E)},children:(0,e.jsx)(j.FormattedMessage,{id:"content.submit.draft"})})}),(0,e.jsx)(ae.Z,{span:12,children:(0,e.jsx)(le.ZP,{block:!0,onClick:function(){h.aiGenerateArticle()},children:(0,e.jsx)(j.FormattedMessage,{id:"content.submit.aigenerate"})})}),(0,e.jsx)(ae.Z,{span:12,children:(0,e.jsx)(le.ZP,{block:!0,onClick:function(){j.history.back()},children:(0,e.jsx)(j.FormattedMessage,{id:"design.back"})})})]})}),(0,e.jsx)(ve.Z,{className:"aside-card",size:"small",title:this.props.intl.formatMessage({id:"content.category.name"}),children:(0,e.jsx)(xe.Z,{showSearch:!0,name:"category_ids",width:"lg",mode:P.multi_category===1?"multiple":"single",request:y()(f()().mark(function s(){var x,Z;return f()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,(0,C.CPB)({type:1});case 2:return x=N.sent,Z=(x.data||[]).map(function(L){return{spacer:L.spacer,label:L.title+(L.status===1?"":h.props.intl.formatMessage({id:"setting.nav.hide"})),value:L.id}}),Z.length===0&&ce.Z.error({title:h.props.intl.formatMessage({id:"content.category.error"}),onOk:function(){j.history.push("/archive/category")}}),N.abrupt("return",Z);case 6:case"end":return N.stop()}},s)})),fieldProps:{optionItemRender:function(x){return(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:x.spacer+x.label}})},onChange:this.onChangeSelectCategory},extra:(0,e.jsxs)("div",{children:[(0,e.jsx)(j.FormattedMessage,{id:"content.module.name"}),":"," ",c.name]})})}),(0,e.jsx)(ve.Z,{className:"aside-card",size:"small",title:this.props.intl.formatMessage({id:"content.images.name"}),children:(0,e.jsxs)(m.Z,{children:[(i=n.images)!==null&&i!==void 0&&i.length?n.images.map(function(s,x){return(0,e.jsxs)("div",{className:"ant-upload-item",children:[(0,e.jsx)(Ie.Z,{preview:{src:s},src:s}),(0,e.jsx)("span",{className:"delete",onClick:h.handleCleanLogo.bind(h,x),children:(0,e.jsx)(Ee.Z,{})})]},x)}):null,(0,e.jsx)(Ze.Z,{onSelect:this.handleSelectImages,open:!1,multiple:!0,children:(0,e.jsx)("div",{className:"ant-upload-item",children:(0,e.jsxs)("div",{className:"add",children:[(0,e.jsx)(Fe.Z,{}),(0,e.jsx)("div",{style:{marginTop:8},children:(0,e.jsx)(j.FormattedMessage,{id:"setting.system.upload"})})]})})})]})}),(0,e.jsx)(ve.Z,{className:"aside-card",size:"small",title:this.props.intl.formatMessage({id:"content.url-token.name"}),children:(0,e.jsx)(m.Z,{name:"url_token",placeholder:this.props.intl.formatMessage({id:"content.url-token.placeholder"}),extra:this.props.intl.formatMessage({id:"content.url-token.tips"})})}),(0,e.jsx)(ve.Z,{className:"aside-card",size:"small",title:this.props.intl.formatMessage({id:"content.create-time.name"}),children:(0,e.jsx)(et.Z,{name:"created_moment",placeholder:this.props.intl.formatMessage({id:"content.url-token.placeholder"}),extra:this.props.intl.formatMessage({id:"content.create-time.description"}),transform:function(x){return{created_time:x?We()(x).unix():0}}})}),(0,e.jsx)(ve.Z,{className:"aside-card",size:"small",title:this.props.intl.formatMessage({id:"content.tag.name"}),children:(0,e.jsx)(xe.Z,{mode:"tags",name:"tags",valueEnum:d,placeholder:this.props.intl.formatMessage({id:"content.tag.placeholder"}),fieldProps:{tokenSeparators:[",","\uFF0C"],onInputKeyDown:this.onChangeTagInput,onFocus:this.onChangeTagInput},extra:this.props.intl.formatMessage({id:"content.tag.placeholder"})})}),(0,e.jsx)(ve.Z,{className:"aside-card",size:"small",title:this.props.intl.formatMessage({id:"content.parent_id.name"}),children:(0,e.jsx)(xe.Z,{name:"parent_id",showSearch:!0,options:K.map(function(s){return{title:s.title,label:s.title,value:s.id,disabled:s.id===n.id}}),fieldProps:{onSearch:function(x){h.onSearchArchives(x)}}})}),(0,e.jsx)(ve.Z,{className:"aside-card",size:"small",title:this.props.intl.formatMessage({id:"content.relation.name"}),extra:(0,e.jsx)(tt.Z,{className:"link",onClick:this.handleShowArchiveSearchs,children:(0,e.jsx)(j.FormattedMessage,{id:"setting.action.add"})}),children:he.map(function(s,x){return(0,e.jsxs)("div",{className:"relation-item",children:[(0,e.jsx)("div",{className:"name",children:s.title}),(0,e.jsx)("div",{className:"close link",onClick:h.handleRemoveRelation.bind(h,x),children:(0,e.jsx)(_e.Z,{})})]},s.id)})})]})]})})},De),v&&(0,e.jsx)(Je,{open:v,onCancel:this.handleHideKeywords,onSubmit:this.handleSelectedKeywords}),b&&(0,e.jsx)($e,{open:b,title:S,editor:P.editor,onCancel:this.onHideAiGenerate,onSubmit:this.onFinishAiGenerate}),_&&(0,e.jsx)(He,{open:_,onCancel:this.handleHideArchiveSearchs,onSubmit:this.handleSelectedArchives})]})}}]),fe}(F.Component),rt=(0,j.injectIntl)(nt)},38308:function(){}}]);
