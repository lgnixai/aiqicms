(self.webpackChunkAnQiCMS=self.webpackChunkAnQiCMS||[]).push([[9478],{85606:function(A,Y,e){"use strict";var B=e(48305),r=e.n(B),m=e(75304),j=e(22683),c=e(96570),o=e(75271),D=e(52676),C=function(v){var M=(0,o.useState)(void 0),g=r()(M,2),H=g[0],y=g[1],Q=(0,o.useState)(""),x=r()(Q,2),z=x[0],V=x[1],U=function(){(0,m.roP)({type:"multi"}).then(function(f){var d=(f.data||[]).map(function(I){return{key:I.id,tab:I.name,is_main:I.is_main}});y(d);var S=(0,j.KJ)("sub-site-id");!S&&d.length>0&&(S=d[0].key+"");var t=d.find(function(I){return I.key===Number(S)}),O=!1;t&&(O=!0,t.is_main&&(O=!1)),(0,j.Xq)("is-sub-site",O),V(S)})};(0,o.useEffect)(function(){U()},[]);var J=function(f){var d;V(f),(0,j.Xq)("sub-site-id",f);var S=H.find(function(O){return O.key===Number(f)}),t=!0;S.is_main&&(t=!1),(0,j.Xq)("is-sub-site",t),(d=v.onTabChange)===null||d===void 0||d.call(v,f,t)};return(0,D.jsx)(c._z,{tabList:H,tabActiveKey:z,onTabChange:J,title:v.title,children:v.children})};Y.Z=C},39015:function(A,Y,e){"use strict";e.r(Y),e.d(Y,{default:function(){return oe}});var B=e(90228),r=e.n(B),m=e(335),j=e.n(m),c=e(87999),o=e.n(c),D=e(48305),C=e.n(D),k=e(85606),v=e(85138),M=e(18640),g=e(35937),H=e(76334),y=e(32064),Q=e(54203),x=e(34206),z=e(53745),V=e(91827),U=e(47634),J=e(16483),G=e.n(J),f=e(75271),d=e(96640),S=e(66857),t=e(52676),O=function(u){var N,h=(0,y.useIntl)(),_=function(){var w=o()(r()().mark(function b(R){var K;return r()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return K=Object.assign(u.editingComment,R),$.next=3,(0,v.b)(K);case 3:u.onSubmit();case 4:case"end":return $.stop()}},b)}));return function(R){return w.apply(this,arguments)}}();return(0,t.jsxs)(g.Y,{width:600,title:(N=u.editingComment)!==null&&N!==void 0&&N.id?h.formatMessage({id:"plugin.comment.edit"}):h.formatMessage({id:"plugin.comment.new"}),initialValues:u.editingComment,open:u.open,onOpenChange:function(b){b||u.onCancel(b)},onFinish:function(){var w=o()(r()().mark(function b(R){return r()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:_(R);case 1:case"end":return P.stop()}},b)}));return function(b){return w.apply(this,arguments)}}(),children:[(0,t.jsx)(d.Z,{name:"id",label:"ID",disabled:!0}),(0,t.jsx)(d.Z,{name:"item_title",label:h.formatMessage({id:"plugin.comment.item-title"}),disabled:!0}),(0,t.jsx)(d.Z,{fieldProps:{value:G()(u.editingComment.created_time*1e3).format("YYYY-MM-DD HH:mm:ss")},label:h.formatMessage({id:"plugin.comment.time"}),disabled:!0}),(0,t.jsx)(d.Z,{name:"ip",label:h.formatMessage({id:"plugin.comment.ip"})}),u.editingComment.parent_id>0&&u.editingComment.parent&&(0,t.jsx)(S.Z,{name:["parent","content"],label:h.formatMessage({id:"plugin.comment.parent"})}),u.editingComment.user_id>0&&(0,t.jsx)(d.Z,{name:"user_id",label:h.formatMessage({id:"plugin.comment.user-id"}),disabled:!0}),(0,t.jsx)(d.Z,{name:"user_name",label:h.formatMessage({id:"plugin.comment.user-name"})}),(0,t.jsx)(S.Z,{name:"content",label:h.formatMessage({id:"plugin.comment.content"})})]})},I=O,ue=function(){var u=(0,f.useRef)(),N=(0,f.useState)([]),h=C()(N,2),_=h[0],w=h[1],b=(0,f.useState)(!1),R=C()(b,2),K=R[0],P=R[1],$=(0,f.useState)({}),te=C()($,2),me=te[0],ce=te[1],fe=(0,f.useState)(!1),ne=C()(fe,2),ae=ne[0],q=ne[1],ve=(0,f.useState)(""),re=C()(ve,2),ge=re[0],he=re[1],l=(0,y.useIntl)(),pe=function(n){he(n)},se=function(){var i=o()(r()().mark(function n(s){return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:Q.Z.confirm({title:l.formatMessage({id:"plugin.comment.delete.confirm"}),onOk:function(){var F=o()(r()().mark(function L(){var Z,X,ee,W,ie,le;return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(Z=x.ZP.loading(l.formatMessage({id:"content.delete.deletting"}),0),s){a.next=3;break}return a.abrupt("return",!0);case 3:a.prev=3,W=j()(s),a.prev=5,W.s();case 7:if((ie=W.n()).done){a.next=13;break}return le=ie.value,a.next=11,(0,v.oI)({id:le});case 11:a.next=7;break;case 13:a.next=18;break;case 15:a.prev=15,a.t0=a.catch(5),W.e(a.t0);case 18:return a.prev=18,W.f(),a.finish(18);case 21:return Z(),x.ZP.success(l.formatMessage({id:"content.delete.success"})),w([]),(X=u.current)===null||X===void 0||(ee=X.reloadAndRest)===null||ee===void 0||ee.call(X),a.abrupt("return",!0);case 28:return a.prev=28,a.t1=a.catch(3),Z(),x.ZP.error(l.formatMessage({id:"content.delete.failure"})),a.abrupt("return",!0);case 33:case"end":return a.stop()}},L,null,[[3,28],[5,15,18,21]])}));function E(){return F.apply(this,arguments)}return E}()});case 1:case"end":return p.stop()}},n)}));return function(s){return i.apply(this,arguments)}}(),Ce=function(){var i=o()(r()().mark(function n(s){var T;return r()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:T=x.ZP.loading(l.formatMessage({id:"setting.system.submitting"}),0),(0,v.KM)({status:Number(s.status),ids:_}).then(function(E){var L,Z;x.ZP.success(E.msg),P(!1),w([]),(L=u.current)===null||L===void 0||(Z=L.reloadAndRest)===null||Z===void 0||Z.call(L)}).finally(function(){T()});case 2:case"end":return F.stop()}},n)}));return function(s){return i.apply(this,arguments)}}(),Me=function(){var i=o()(r()().mark(function n(s){return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:ce(s),q(!0);case 2:case"end":return p.stop()}},n)}));return function(s){return i.apply(this,arguments)}}(),be=[{title:l.formatMessage({id:"plugin.comment.time"}),width:160,dataIndex:"created_time",render:function(n,s){return G()(s.created_time*1e3).format("YYYY-MM-DD HH:mm")}},{title:l.formatMessage({id:"plugin.comment.item-title"}),width:200,dataIndex:"item_title",render:function(n){return(0,t.jsx)("div",{style:{wordBreak:"break-all"},children:n})}},{title:l.formatMessage({id:"plugin.comment.user-name"}),width:100,dataIndex:"user_name",render:function(n){return(0,t.jsx)("div",{style:{wordBreak:"break-all"},children:n})}},{title:l.formatMessage({id:"plugin.comment.content"}),dataIndex:"content",render:function(n){return(0,t.jsx)("div",{style:{wordBreak:"break-all"},children:n})}},{title:"IP",dataIndex:"ip",width:100},{title:l.formatMessage({id:"website.status"}),dataIndex:"status",width:60,valueEnum:{0:{text:l.formatMessage({id:"content.category.status.hide"}),status:"Default"},1:{text:l.formatMessage({id:"content.category.status.ok"}),status:"Success"}}},{title:l.formatMessage({id:"setting.action"}),width:150,dataIndex:"option",valueType:"option",render:function(n,s){return(0,t.jsxs)(z.Z,{size:20,children:[(0,t.jsx)("a",{onClick:function(){Me(s)},children:(0,t.jsx)(y.FormattedMessage,{id:"plugin.comment.view-edit"})},"check"),(0,t.jsx)("a",{className:"text-red",onClick:function(){se([s.id])},children:(0,t.jsx)(y.FormattedMessage,{id:"setting.system.delete"})},"delete")]})}}];return(0,t.jsx)(k.Z,{onTabChange:function(n){return pe(n)},children:(0,t.jsxs)(V.Z,{children:[(0,t.jsx)(M.Z,{headerTitle:l.formatMessage({id:"menu.plugin.comment"}),actionRef:u,rowKey:"id",search:!1,tableAlertOptionRender:function(n){var s=n.selectedRowKeys,T=n.onCleanSelected;return(0,t.jsxs)(z.Z,{children:[(0,t.jsx)(U.ZP,{size:"small",onClick:o()(r()().mark(function p(){return r()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,P(!0);case 2:case"end":return E.stop()}},p)})),children:(0,t.jsx)(y.FormattedMessage,{id:"plugin.comment.batch-update-status"})}),(0,t.jsx)(U.ZP,{size:"small",onClick:function(){se(s)},children:(0,t.jsx)(y.FormattedMessage,{id:"content.option.batch-delete"})}),(0,t.jsx)(U.ZP,{type:"link",size:"small",onClick:T,children:(0,t.jsx)(y.FormattedMessage,{id:"content.option.cancel-select"})})]})},request:function(n){return(0,v.YS)(n)},columnsState:{persistenceKey:"comment-table",persistenceType:"localStorage"},columns:be,rowSelection:{onChange:function(n){w(n)}},pagination:{showSizeChanger:!0}}),ae&&(0,t.jsx)(I,{open:ae,editingComment:me,onCancel:function(){q(!1)},onSubmit:o()(r()().mark(function i(){return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:q(!1),u.current&&u.current.reload();case 2:case"end":return s.stop()}},i)}))}),K&&(0,t.jsx)(g.Y,{width:480,title:l.formatMessage({id:"plugin.comment.new-status"}),open:K,onFinish:Ce,onOpenChange:function(n){return P(n)},children:(0,t.jsx)(H.Z.Group,{name:"status",valueEnum:{0:l.formatMessage({id:"content.category.status.hide"}),1:l.formatMessage({id:"content.category.status.ok"})}})})]},ge)})},oe=ue},335:function(A,Y,e){var B=e(31479);function r(m,j){var c=typeof Symbol!="undefined"&&m[Symbol.iterator]||m["@@iterator"];if(!c){if(Array.isArray(m)||(c=B(m))||j&&m&&typeof m.length=="number"){c&&(m=c);var o=0,D=function(){};return{s:D,n:function(){return o>=m.length?{done:!0}:{done:!1,value:m[o++]}},e:function(g){throw g},f:D}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var C=!0,k=!1,v;return{s:function(){c=c.call(m)},n:function(){var g=c.next();return C=g.done,g},e:function(g){k=!0,v=g},f:function(){try{!C&&c.return!=null&&c.return()}finally{if(k)throw v}}}}A.exports=r,A.exports.__esModule=!0,A.exports.default=A.exports}}]);
