"use strict";(self.webpackChunkAnQiCMS=self.webpackChunkAnQiCMS||[]).push([[2585],{19472:function(ie,b,r){r.r(b),r.d(b,{default:function(){return Q}});var G=r(90228),c=r.n(G),$=r(87999),d=r.n($),A=r(48305),w=r.n(A),h=r(75304),D=r(96570),B=r(74133),M=r(76334),f=r(96640),p=r(32064),v=r(34206),y=r(54203),U=r(91827),I=r(59124),P=r(48806),O=r(48782),Z=r(47634),V=r(77965),S=r(90112),x=r(75271),e=r(52676),k=!1,L=function(){var W=(0,x.useState)(null),F=w()(W,2),n=F[0],m=F[1],E=(0,x.useState)(!1),N=w()(E,2),H=N[0],J=N[1],K=(0,x.useState)(""),R=w()(K,2),X=R[0],Y=R[1],t=(0,p.useIntl)(),z=function(){k||(k=!0,(0,h.pOM)().then(function(a){Y(a.data)}).finally(function(){k=!1}))},q=function(){var i=d()(c()().mark(function a(){var l,o;return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,h.fcx)();case 2:l=u.sent,o=l.data||{},m(o),J(!0),z();case 7:case"end":return u.stop()}},a)}));return function(){return i.apply(this,arguments)}}();(0,x.useEffect)(function(){q()},[]);var j=function(a,l){n[a]=l,m(Object.assign({},n))},_=function(a){n.open=a.target.value,m(Object.assign({},n))},ee=function(a){n.type=a.target.value,m(Object.assign({},n))},ae=function(){var i=d()(c()().mark(function a(l){var o,s;return c()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:o=v.ZP.loading(t.formatMessage({id:"setting.system.submitting"}),0),s=Object.assign(n,l),s.width=Number(s.width),s.height=Number(s.height),(0,h.ijf)(s).then(function(C){v.ZP.success(C.msg),z()}).catch(function(C){console.log(C)}).finally(function(){o()});case 5:case"end":return g.stop()}},a)}));return function(l){return i.apply(this,arguments)}}(),T=function(a,l){var o=new FormData;o.append("file",l.file),o.append("name",a);var s=v.ZP.loading(t.formatMessage({id:"setting.system.submitting"}),0);(0,h.tPZ)(o).then(function(u){v.ZP.success(u.msg),n[a]=u.data,m(Object.assign({},n))}).finally(function(){s()})},te=function(a){a.stopPropagation(),y.Z.confirm({title:t.formatMessage({id:"plugin.material.category.delete.confirm"}),onOk:function(){var l=d()(c()().mark(function s(){return c()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:n.image_path="",m(Object.assign({},n));case 2:case"end":return g.stop()}},s)}));function o(){return l.apply(this,arguments)}return o}()})},ne=function(a){a.stopPropagation(),y.Z.confirm({title:t.formatMessage({id:"plugin.material.category.delete.confirm"}),onOk:function(){var l=d()(c()().mark(function s(){return c()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:n.color="",m(Object.assign({},n));case 2:case"end":return g.stop()}},s)}));function o(){return l.apply(this,arguments)}return o}()})},re=function(){y.Z.confirm({title:t.formatMessage({id:"plugin.watermark.generate.confirm"}),content:t.formatMessage({id:"plugin.watermark.generate.content"}),onOk:function(){var a=d()(c()().mark(function o(){return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:(0,h.b3c)({}).then(function(g){v.ZP.success(g.msg)});case 1:case"end":return u.stop()}},o)}));function l(){return a.apply(this,arguments)}return l}()})},se=function(a){n.color=a.toHex(),m(Object.assign({},n))};return(0,e.jsx)(D._z,{children:(0,e.jsx)(U.Z,{children:(0,e.jsxs)(I.Z,{gutter:16,children:[(0,e.jsx)(P.Z,{sm:12,xs:24,children:H&&(0,e.jsxs)(B.A,{title:t.formatMessage({id:"menu.plugin.watermark"}),layout:"vertical",initialValues:n,onFinish:ae,children:[(0,e.jsx)(M.Z.Group,{name:"open",label:t.formatMessage({id:"plugin.watermark.open"}),options:[{value:!1,label:t.formatMessage({id:"plugin.watermark.open.no"})},{value:!0,label:t.formatMessage({id:"plugin.watermark.open.yes"})}],fieldProps:{onChange:_},extra:t.formatMessage({id:"plugin.watermark.open.description"})}),(0,e.jsxs)("div",{style:{display:n.open?"block":"none"},children:[(0,e.jsx)(M.Z.Group,{name:"type",label:t.formatMessage({id:"plugin.watermark.type"}),options:[{value:0,label:t.formatMessage({id:"plugin.watermark.type.image"})},{value:1,label:t.formatMessage({id:"plugin.watermark.type.text"})}],fieldProps:{onChange:ee}}),n.type===0&&(0,e.jsxs)(f.Z,{label:t.formatMessage({id:"plugin.watermark.image"}),children:[(0,e.jsx)(O.Z,{name:"file",className:"logo-uploader",showUploadList:!1,accept:".jpg,.jpeg,.png,.gif,.webp,.bmp",customRequest:function(){var i=d()(c()().mark(function a(l){return c()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",T("image_path",l));case 1:case"end":return s.stop()}},a)}));return function(a){return i.apply(this,arguments)}}(),children:(0,e.jsx)(Z.ZP,{children:(0,e.jsx)(p.FormattedMessage,{id:"plugin.titleimage.bg-image.upload"})})}),n.image_path&&(0,e.jsxs)("div",{className:"upload-file",children:[(0,e.jsx)("span",{children:n.image_path}),(0,e.jsx)("a",{className:"delete",onClick:te,children:(0,e.jsx)(p.FormattedMessage,{id:"setting.system.delete"})})]})]}),n.type===1&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(f.Z,{name:"text",label:t.formatMessage({id:"plugin.watermark.text"}),fieldProps:{onBlur:function(a){return j("text",a.target.value)}}}),(0,e.jsx)(f.Z,{width:"sm",label:t.formatMessage({id:"plugin.titleimage.color"}),extra:t.formatMessage({id:"plugin.titleimage.color.default"}),children:(0,e.jsx)(V.Z,{showText:!0,value:n.color,onChange:function(a){se(a)}})}),(0,e.jsxs)(f.Z,{label:t.formatMessage({id:"plugin.titleimage.font"}),children:[(0,e.jsx)(O.Z,{name:"file",className:"logo-uploader",showUploadList:!1,accept:".ttf",customRequest:function(){var i=d()(c()().mark(function a(l){return c()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",T("font_path",l));case 1:case"end":return s.stop()}},a)}));return function(a){return i.apply(this,arguments)}}(),children:(0,e.jsx)(Z.ZP,{children:(0,e.jsx)(p.FormattedMessage,{id:"plugin.titleimage.font.upload"})})}),n.font_path&&(0,e.jsxs)("div",{className:"upload-file",children:[(0,e.jsx)("span",{children:n.font_path}),(0,e.jsx)("a",{className:"delete",onClick:ne,children:(0,e.jsx)(p.FormattedMessage,{id:"setting.system.delete"})})]})]})]}),(0,e.jsx)(M.Z.Group,{name:"position",label:t.formatMessage({id:"plugin.watermark.position"}),options:[{value:5,label:t.formatMessage({id:"plugin.watermark.position.center"})},{value:1,label:t.formatMessage({id:"plugin.watermark.position.left-top"})},{value:3,label:t.formatMessage({id:"plugin.watermark.position.right-top"})},{value:7,label:t.formatMessage({id:"plugin.watermark.position.left-bottom"})},{value:9,label:t.formatMessage({id:"plugin.watermark.position.right-bottom"})}],fieldProps:{onChange:function(a){j("position",a.target.value)}}}),(0,e.jsx)(f.Z,{label:t.formatMessage({id:"plugin.watermark.size"}),children:(0,e.jsx)(S.Z,{min:5,max:50,defaultValue:n.size,onChange:function(a){return j("size",a)}})}),(0,e.jsx)(f.Z,{label:t.formatMessage({id:"plugin.watermark.opacity"}),children:(0,e.jsx)(S.Z,{min:10,max:100,defaultValue:n.opacity,onChange:function(a){return j("opacity",a)}})}),(0,e.jsx)(f.Z,{name:"min_size",label:t.formatMessage({id:"plugin.watermark.min-size"}),fieldProps:{addonAfter:t.formatMessage({id:"plugin.watermark.min-size.suffix"}),onBlur:function(a){return j("text",a.target.value)}},extra:t.formatMessage({id:"plugin.watermark.min-size.description"})})]}),(0,e.jsx)("p",{children:(0,e.jsx)("br",{})})]})}),(0,e.jsxs)(P.Z,{sm:12,xs:24,children:[(0,e.jsx)("img",{className:"preview",src:X}),(0,e.jsx)("div",{className:"mt-normal text-center",children:(0,e.jsx)(Z.ZP,{onClick:function(){return re()},children:(0,e.jsx)(p.FormattedMessage,{id:"plugin.watermark.batch-add"})})})]})]})})})},Q=L}}]);
