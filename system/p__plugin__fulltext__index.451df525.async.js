"use strict";(self.webpackChunkAnQiCMS=self.webpackChunkAnQiCMS||[]).push([[931],{56534:function(F,A,e){var c=e(18201),u=e(66342),U=e(59831),f=e(37697),K=e(75271),g=e(73428),R=e(31945),v=e(52676),Z=["options","fieldProps","proFieldProps","valueEnum"],p=K.forwardRef(function(_,h){var M=_.options,D=_.fieldProps,b=_.proFieldProps,L=_.valueEnum,T=(0,u.Z)(_,Z);return(0,v.jsx)(R.Z,(0,c.Z)({ref:h,valueType:"checkbox",valueEnum:(0,U.h)(L,void 0),fieldProps:(0,c.Z)({options:M},D),lightProps:(0,c.Z)({labelFormatter:function(){return(0,v.jsx)(R.Z,(0,c.Z)({ref:h,valueType:"checkbox",mode:"read",valueEnum:(0,U.h)(L,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,c.Z)({options:M},D),proFieldProps:b},T))}},T.lightProps),proFieldProps:b},T))}),C=K.forwardRef(function(_,h){var M=_.fieldProps,D=_.children;return(0,v.jsx)(f.Z,(0,c.Z)((0,c.Z)({ref:h},M),{},{children:D}))}),E=(0,g.G)(C,{valuePropName:"checked"}),m=E;m.Group=p,A.Z=m},85606:function(F,A,e){var c=e(48305),u=e.n(c),U=e(75304),f=e(22683),K=e(96570),g=e(75271),R=e(52676),v=function(p){var C=(0,g.useState)(void 0),E=u()(C,2),m=E[0],_=E[1],h=(0,g.useState)(""),M=u()(h,2),D=M[0],b=M[1],L=function(){(0,U.roP)({type:"multi"}).then(function(n){var s=(n.data||[]).map(function(j){return{key:j.id,tab:j.name,is_main:j.is_main}});_(s);var l=(0,f.KJ)("sub-site-id");!l&&s.length>0&&(l=s[0].key+"");var x=s.find(function(j){return j.key===Number(l)}),W=!1;x&&(W=!0,x.is_main&&(W=!1)),(0,f.Xq)("is-sub-site",W),b(l)})};(0,g.useEffect)(function(){L()},[]);var T=function(n){var s;b(n),(0,f.Xq)("sub-site-id",n);var l=m.find(function(W){return W.key===Number(n)}),x=!0;l.is_main&&(x=!1),(0,f.Xq)("is-sub-site",x),(s=p.onTabChange)===null||s===void 0||s.call(p,n,x)};return(0,R.jsx)(K._z,{tabList:m,tabActiveKey:D,onTabChange:T,title:p.title,children:p.children})};A.Z=v},36819:function(F,A,e){e.r(A);var c=e(90228),u=e.n(c),U=e(87999),f=e.n(U),K=e(48305),g=e.n(K),R=e(85606),v=e(75304),Z=e(74133),p=e(76334),C=e(96640),E=e(56534),m=e(32064),_=e(34206),h=e(54203),M=e(91827),D=e(18874),b=e(47634),L=e(53745),T=e(67852),P=e(75271),n=e(52676),s=!1,l=null,x=function(){var j=(0,P.useState)([]),G=g()(j,2),w=G[0],q=G[1],ee=(0,P.useState)(""),N=g()(ee,2),ne=N[0],te=N[1],ae=(0,P.useState)(!1),$=g()(ae,2),X=$[0],z=$[1],se=(0,P.useState)(null),J=g()(se,2),O=J[0],Q=J[1],le=(0,P.useState)(""),V=g()(le,2),H=V[0],Y=V[1],t=(0,m.useIntl)(),B=function(){var o=f()(u()().mark(function a(){return u()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:(0,v.TV1)().then(function(r){r.data?(Q(r.data),r.data.status===1?s=!0:(s=!1,clearInterval(l))):(s&&(s=!1,clearInterval(l)),Q(null))});case 1:case"end":return i.stop()}},a)}));return function(){return o.apply(this,arguments)}}(),k=function(){var o=f()(u()().mark(function a(){var d,i,r,I;return u()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,(0,v.hUj)();case 2:d=S.sent,i=d.data||[],r=[];for(I in i)r.push({label:i[I].name,value:i[I].id});q(r);case 7:case"end":return S.stop()}},a)}));return function(){return o.apply(this,arguments)}}(),_e=function(a){s=!1,clearInterval(l),k().then(function(){te(a)}),l=setInterval(function(){B()},1e3)};(0,P.useEffect)(function(){return k(),B(),l=setInterval(function(){B()},1e3),function(){s=!1,clearInterval(l)}},[]);var re=function(){var o=f()(u()().mark(function a(d){var i;return u()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:i=_.ZP.loading(t.formatMessage({id:"setting.system.submitting"}),0),(0,v.Sd7)(d).then(function(y){_.ZP.success(y.msg),s=!1,clearInterval(l),l=setInterval(function(){B()},1e3)}).catch(function(y){console.log(y)}).finally(function(){i()});case 2:case"end":return I.stop()}},a)}));return function(d){return o.apply(this,arguments)}}(),ie=function(){s||h.Z.confirm({title:t.formatMessage({id:"plugin.fulltext.rebuild.confirm"}),onOk:function(){s=!0;var d=_.ZP.loading(t.formatMessage({id:"setting.system.submitting"}),0);(0,v.l5J)({}).then(function(i){_.ZP.info(i.msg),l=setInterval(function(){B()},1e3)}).finally(function(){d()})}})};return(0,n.jsxs)(R.Z,{onTabChange:function(a){return _e(a)},children:[(0,n.jsxs)(M.Z,{children:[(0,n.jsx)(D.Z,{style:{marginBottom:20},description:(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:(0,n.jsx)(m.FormattedMessage,{id:"plugin.fulltext.tips"})}),O!==null&&O.status===-1&&(0,n.jsx)("p",{style:{color:"#f30"},children:O.msg}),X&&(0,n.jsx)(b.ZP,{onClick:function(){return ie()},children:(0,n.jsx)(m.FormattedMessage,{id:"plugin.fulltext.rebuild"})},"clean")]})}),(0,n.jsxs)(Z.A,{request:f()(u()().mark(function o(){var a,d;return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,v.Wjp)();case 2:return a=r.sent,d=a.data||{},Y(d.engine||"default"),z(d.open||!1),r.abrupt("return",d);case 7:case"end":return r.stop()}},o)})),onFinish:re,title:t.formatMessage({id:"menu.plugin.fulltext"}),children:[(0,n.jsx)(p.Z.Group,{name:"open",label:t.formatMessage({id:"plugin.fulltext.open.name"}),options:[{label:t.formatMessage({id:"plugin.fulltext.open.false"}),value:!1},{label:t.formatMessage({id:"plugin.fulltext.open.true"}),value:!0}],fieldProps:{onChange:function(a){z(a.target.value)}}}),X&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Z.Group,{name:"engine",label:t.formatMessage({id:"plugin.fulltext.engine"}),options:[{label:t.formatMessage({id:"plugin.fulltext.wukong"}),value:"default"},{label:t.formatMessage({id:"plugin.fulltext.elasticsearch"}),value:"elasticsearch"},{label:t.formatMessage({id:"plugin.fulltext.zincSearch"}),value:"zincsearch"},{label:t.formatMessage({id:"plugin.fulltext.meilisearch"}),value:"meilisearch"}],fieldProps:{onChange:function(a){Y(a.target.value)}}}),H!=="default"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(C.Z,{name:"engine_url",label:t.formatMessage({id:"plugin.fulltext.engine-url"}),width:"lg"}),H!=="meilisearch"&&(0,n.jsx)(C.Z,{name:"engine_user",label:t.formatMessage({id:"plugin.fulltext.engine-user"}),width:"lg"}),(0,n.jsx)(C.Z,{name:"engine_pass",label:t.formatMessage({id:"plugin.fulltext.engine-password"}),width:"lg"})]}),(0,n.jsx)(p.Z.Group,{name:"use_content",label:t.formatMessage({id:"plugin.fulltext.use_content.name"}),options:[{label:t.formatMessage({id:"plugin.fulltext.use_content.false"}),value:!1},{label:t.formatMessage({id:"plugin.fulltext.use_content.true"}),value:!0}]}),(0,n.jsx)(E.Z.Group,{name:"modules",label:t.formatMessage({id:"plugin.fulltext.modules.name"}),options:w}),(0,n.jsx)(E.Z.Group,{label:t.formatMessage({id:"plugin.fulltext.search.name"}),children:(0,n.jsxs)(L.Z,{children:[(0,n.jsx)(E.Z,{name:"use_archive",disabled:!0,initialValue:!0,children:(0,n.jsx)(m.FormattedMessage,{id:"plugin.fulltext.search.archive"})}),(0,n.jsx)(E.Z,{name:"use_category",children:(0,n.jsx)(m.FormattedMessage,{id:"plugin.fulltext.search.category"})}),(0,n.jsx)(E.Z,{name:"use_tag",children:(0,n.jsx)(m.FormattedMessage,{id:"plugin.fulltext.search.tag"})})]})})]})]})]},ne),O!==null&&O.status===1&&(0,n.jsxs)(h.Z,{title:t.formatMessage({id:"plugin.fulltext.indexing"}),open:!0,footer:null,children:[(0,n.jsx)("div",{className:"task-progress",children:(0,n.jsx)(T.Z,{percent:O.total>0?Number((O.current/O.total*100).toFixed()):1})}),(0,n.jsx)("div",{className:"task-message",children:O.msg})]})]})};A.default=x}}]);
